/**
 * Warning! This code has been generated automatically.
 */
import React from "react"
import { ViewButton } from "@tolokoban/ui"
import CodeViewer from "@/components/demo/CodeViewer"
import Demo from "./main.demo"

const FOCUS = {"Detail #1":"function init(context: TgdContext, assets: Assets) {\n\tconst clear = new TgdPainterClear(context, {\n\t\tcolor: [0.3, 0.3, 0.3, 1],\n\t\tdepth: 1,\n\t})\n\tconst texture = new TgdTexture2D(context, {\n\t\tparams: {\n\t\t\tmagFilter: \"NEAREST\",\n\t\t\tminFilter: \"NEAREST\",\n\t\t\twrapR: \"CLAMP_TO_EDGE\",\n\t\t\twrapS: \"CLAMP_TO_EDGE\",\n\t\t\twrapT: \"CLAMP_TO_EDGE\",\n\t\t},\n\t\tload: assets.image.sprites,\n\t})\n\tconst cell = (col: number, row: number) => ({\n\t\tx: col / 8,\n\t\ty: row / 10,\n\t\twidth: 1 / 8,\n\t\theight: 1 / 10,\n\t})\n\tconst atlas: TgdPainterSpritesAtlas = []\n\tfor (let row = 0; row < 10; row++) {\n\t\tfor (let col = 0; col < 8; col++) {\n\t\t\tatlas.push(cell(col, row))\n\t\t}\n\t}\n\tconst spritesPainter1 = new TgdPainterSprites(context, {\n\t\ttexture,\n\t\tatlas,\n\t\tatlasUnit: 5,\n\t})\n\tconst spritesPainter2 = new TgdPainterSprites(context, {\n\t\ttexture,\n\t\tatlas,\n\t\tatlasUnit: 5,\n\t})\n\tconst sprites: TgdSprite[] = []\n\tfor (let x = -7; x < 8; x++) {\n\t\tfor (let y = -3; y < 4; y += 2) {\n\t\t\tfor (let z = 0; z < 1; z += 0.1) {\n\t\t\t\tconst sprite1 = spritesPainter1.spriteCreate()\n\t\t\t\tsprite1.x = x\n\t\t\t\tsprite1.y = y\n\t\t\t\tsprite1.z = -z * 100\n\t\t\t\tif (tgdCalcRandom() < 0.5) sprite1.scaleX = -1\n\t\t\t\tsprite1.index = Math.floor(tgdCalcRandom(0, 40))\n\t\t\t\tsprites.push(sprite1)\n\t\t\t\tconst sprite2 = spritesPainter2.spriteCreate()\n\t\t\t\tsprite2.x = x\n\t\t\t\tsprite2.y = y\n\t\t\t\tsprite2.z = -z * 100 - 100\n\t\t\t\tif (tgdCalcRandom() < 0.5) sprite2.scaleX = -1\n\t\t\t\tsprite2.index = Math.floor(tgdCalcRandom(0, 72))\n\t\t\t\tsprites.push(sprite2)\n\t\t\t}\n\t\t}\n\t}\n\tconst STEPS: number[] = [3, 2, 1, 0, 7, 6, 5, 4, 9, 10, 11, 8, 11, 12, 10, 15]\n\tfor (let i = 0; i < 16; i++) {\n\t\tSTEPS.push(STEPS[i] + 16)\n\t}\n\tSTEPS.push(32, 34, 35, 36, 33, 37, 39, 38)\n\tfor (let i = 0; i < 32; i++) {\n\t\tSTEPS.push(STEPS[i] + 40)\n\t}\n\tconst interval = new TgdTimeInterval({\n\t\tintervalInSeconds: 0.2,\n\t\taction(time: number) {\n\t\t\tfor (const sprite of sprites) {\n\t\t\t\tconst nextStep = STEPS[sprite.index]\n\t\t\t\tif (typeof nextStep === \"number\") {\n\t\t\t\t\tsprite.index = nextStep\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t})\n\tcontext.add(\n\t\tclear,\n\t\tnew TgdPainterState(context, {\n\t\t\tdepth: webglPresetDepth.less,\n\t\t\tchildren: [spritesPainter1, spritesPainter2],\n\t\t}),\n\t\tnew TgdPainterLogic((time, delay) => {\n\t\t\tinterval.update(time, delay)\n\t\t\tfor (const sprite of sprites) {\n\t\t\t\tsprite.angle = tgdCalcDegToRad(30 * Math.sin(time))\n\t\t\t}\n\t\t\tconst t = tgdCalcModulo(time * 0.05, 0, 1)\n\t\t\tconst z = tgdCalcMix(0, -100, t)\n\t\t\tcontext.camera.transfo.setPosition(0, 0, z)\n\t\t}),\n\t)\n\tcontext.play()\n}"}
const FULL = "import {\n\ttype TgdContext,\n\tTgdControllerCameraOrbit,\n\tTgdPainterClear,\n\tTgdPainterLogic,\n\tTgdPainterSprites,\n\tTgdPainterSpritesAtlas,\n\tTgdPainterState,\n\tTgdSprite,\n\tTgdTexture2D,\n\tTgdTimeInterval,\n\ttgdCalcDegToRad,\n\ttgdCalcMix,\n\ttgdCalcModulo,\n\ttgdCalcRandom,\n\twebglPresetDepth,\n} from \"@tolokoban/tgd\"\n\nimport View, { type Assets } from \"@/components/demo/Tgd\"\n\nimport SpritesURL from \"./sprites.webp\"\n\nfunction init(context: TgdContext, assets: Assets) {\n\tconst clear = new TgdPainterClear(context, {\n\t\tcolor: [0.3, 0.3, 0.3, 1],\n\t\tdepth: 1,\n\t})\n\tconst texture = new TgdTexture2D(context, {\n\t\tparams: {\n\t\t\tmagFilter: \"NEAREST\",\n\t\t\tminFilter: \"NEAREST\",\n\t\t\twrapR: \"CLAMP_TO_EDGE\",\n\t\t\twrapS: \"CLAMP_TO_EDGE\",\n\t\t\twrapT: \"CLAMP_TO_EDGE\",\n\t\t},\n\t\tload: assets.image.sprites,\n\t})\n\tconst cell = (col: number, row: number) => ({\n\t\tx: col / 8,\n\t\ty: row / 10,\n\t\twidth: 1 / 8,\n\t\theight: 1 / 10,\n\t})\n\tconst atlas: TgdPainterSpritesAtlas = []\n\tfor (let row = 0; row < 10; row++) {\n\t\tfor (let col = 0; col < 8; col++) {\n\t\t\tatlas.push(cell(col, row))\n\t\t}\n\t}\n\tconst spritesPainter1 = new TgdPainterSprites(context, {\n\t\ttexture,\n\t\tatlas,\n\t\tatlasUnit: 5,\n\t})\n\tconst spritesPainter2 = new TgdPainterSprites(context, {\n\t\ttexture,\n\t\tatlas,\n\t\tatlasUnit: 5,\n\t})\n\tconst sprites: TgdSprite[] = []\n\tfor (let x = -7; x < 8; x++) {\n\t\tfor (let y = -3; y < 4; y += 2) {\n\t\t\tfor (let z = 0; z < 1; z += 0.1) {\n\t\t\t\tconst sprite1 = spritesPainter1.spriteCreate()\n\t\t\t\tsprite1.x = x\n\t\t\t\tsprite1.y = y\n\t\t\t\tsprite1.z = -z * 100\n\t\t\t\tif (tgdCalcRandom() < 0.5) sprite1.scaleX = -1\n\t\t\t\tsprite1.index = Math.floor(tgdCalcRandom(0, 40))\n\t\t\t\tsprites.push(sprite1)\n\t\t\t\tconst sprite2 = spritesPainter2.spriteCreate()\n\t\t\t\tsprite2.x = x\n\t\t\t\tsprite2.y = y\n\t\t\t\tsprite2.z = -z * 100 - 100\n\t\t\t\tif (tgdCalcRandom() < 0.5) sprite2.scaleX = -1\n\t\t\t\tsprite2.index = Math.floor(tgdCalcRandom(0, 72))\n\t\t\t\tsprites.push(sprite2)\n\t\t\t}\n\t\t}\n\t}\n\tconst STEPS: number[] = [3, 2, 1, 0, 7, 6, 5, 4, 9, 10, 11, 8, 11, 12, 10, 15]\n\tfor (let i = 0; i < 16; i++) {\n\t\tSTEPS.push(STEPS[i] + 16)\n\t}\n\tSTEPS.push(32, 34, 35, 36, 33, 37, 39, 38)\n\tfor (let i = 0; i < 32; i++) {\n\t\tSTEPS.push(STEPS[i] + 40)\n\t}\n\tconst interval = new TgdTimeInterval({\n\t\tintervalInSeconds: 0.2,\n\t\taction(time: number) {\n\t\t\tfor (const sprite of sprites) {\n\t\t\t\tconst nextStep = STEPS[sprite.index]\n\t\t\t\tif (typeof nextStep === \"number\") {\n\t\t\t\t\tsprite.index = nextStep\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t})\n\tcontext.add(\n\t\tclear,\n\t\tnew TgdPainterState(context, {\n\t\t\tdepth: webglPresetDepth.less,\n\t\t\tchildren: [spritesPainter1, spritesPainter2],\n\t\t}),\n\t\tnew TgdPainterLogic((time, delay) => {\n\t\t\tinterval.update(time, delay)\n\t\t\tfor (const sprite of sprites) {\n\t\t\t\tsprite.angle = tgdCalcDegToRad(30 * Math.sin(time))\n\t\t\t}\n\t\t\tconst t = tgdCalcModulo(time * 0.05, 0, 1)\n\t\t\tconst z = tgdCalcMix(0, -100, t)\n\t\t\tcontext.camera.transfo.setPosition(0, 0, z)\n\t\t}),\n\t)\n\tcontext.play()\n}\n\nexport default function Demo() {\n\treturn (\n\t\t<View\n\t\t\tonReady={init}\n\t\t\tassets={{\n\t\t\t\timage: { sprites: SpritesURL },\n\t\t\t}}\n\t\t\tcontroller={{\n\t\t\t\tinertiaOrbit: 1000,\n\t\t\t\tinertiaZoom: 1000,\n\t\t\t\tgeo: {\n\t\t\t\t\tminLat: tgdCalcDegToRad(-30),\n\t\t\t\t\tminLng: tgdCalcDegToRad(-30),\n\t\t\t\t\tmaxLat: tgdCalcDegToRad(30),\n\t\t\t\t\tmaxLng: tgdCalcDegToRad(30),\n\t\t\t\t},\n\t\t\t}}\n\t\t/>\n\t)\n}\n"

export default function DemoContainer() {
    const [full, setFull] = React.useState(false)
    return <>
        <div className="half-left"><Demo /></div>
        <div className="half-right">
            <div>
                <ViewButton variant="elevated" onClick={() => setFull(!full)}>
                    {full ? "Show code details" : "Show full code"}
                </ViewButton>
            </div>
            <CodeViewer language="tsx" value={full ? FULL : FOCUS} />
        </div>
    </>
}