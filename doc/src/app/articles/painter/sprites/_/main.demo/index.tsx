/**
 * Warning! This code has been generated automatically.
 */
import React from "react"
import { ViewButton } from "@tolokoban/ui"
import CodeViewer from "@/components/demo/CodeViewer"
import Demo from "./main.demo"

const FOCUS = {"Detail #1":"function init(context: TgdContext, assets: Assets) {\n    const clear = new TgdPainterClear(context, {\n        color: [0.3, 0.3, 0.3, 1],\n        depth: 1,\n    });\n    const texture = new TgdTexture2D(context, {\n        params: {\n            magFilter: \"NEAREST\",\n            minFilter: \"NEAREST\",\n            wrapR: \"CLAMP_TO_EDGE\",\n            wrapS: \"CLAMP_TO_EDGE\",\n            wrapT: \"CLAMP_TO_EDGE\",\n        },\n        load: assets.image.sprites,\n    });\n    const cell = (col: number, row: number) => ({\n        x: col / 8,\n        y: row / 10,\n        width: 1 / 8,\n        height: 1 / 10,\n    });\n    const atlas: TgdPainterSpritesAtlas = [];\n    for (let row = 0; row < 10; row++) {\n        for (let col = 0; col < 8; col++) {\n            atlas.push(cell(col, row));\n        }\n    }\n    const spritesPainter1 = new TgdPainterSprites(context, {\n        texture,\n        atlas,\n        atlasUnit: 5,\n    });\n    const spritesPainter2 = new TgdPainterSprites(context, {\n        texture,\n        atlas,\n        atlasUnit: 5,\n    });\n    const sprites: TgdSprite[] = [];\n    for (let x = -7; x < 8; x++) {\n        for (let y = -3; y < 4; y += 2) {\n            for (let z = 0; z < 1; z += 0.1) {\n                const sprite1 = spritesPainter1.spriteCreate({});\n                sprite1.x = x;\n                sprite1.y = y;\n                sprite1.z = -z * 100;\n                if (tgdCalcRandom() < 0.5) sprite1.scaleX = -1;\n                sprite1.index = Math.floor(tgdCalcRandom(0, 40));\n                sprites.push(sprite1);\n                const sprite2 = spritesPainter2.spriteCreate({});\n                sprite2.x = x;\n                sprite2.y = y;\n                sprite2.z = -z * 100 - 100;\n                if (tgdCalcRandom() < 0.5) sprite2.scaleX = -1;\n                sprite2.index = Math.floor(tgdCalcRandom(0, 72));\n                sprites.push(sprite2);\n            }\n        }\n    }\n    const STEPS: number[] = [\n        3,\n        2,\n        1,\n        0,\n        7,\n        6,\n        5,\n        4,\n        9,\n        10,\n        11,\n        8,\n        11,\n        12,\n        10,\n        15,\n    ];\n    for (let i = 0; i < 16; i++) {\n        STEPS.push(STEPS[i] + 16);\n    }\n    STEPS.push(32, 34, 35, 36, 33, 37, 39, 38);\n    for (let i = 0; i < 32; i++) {\n        STEPS.push(STEPS[i] + 40);\n    }\n    const interval = new TgdTimeInterval({\n        intervalInSeconds: 0.2,\n        action(time: number) {\n            for (const sprite of sprites) {\n                const nextStep = STEPS[sprite.index];\n                if (typeof nextStep === \"number\") {\n                    sprite.index = nextStep;\n                }\n            }\n        },\n    });\n    context.add(\n        clear,\n        new TgdPainterState(context, {\n            depth: webglPresetDepth.less,\n            children: [spritesPainter1, spritesPainter2],\n        }),\n        new TgdPainterLogic((time, delay) => {\n            interval.update(time, delay);\n            for (const sprite of sprites) {\n                sprite.angle = tgdCalcDegToRad(30 * Math.sin(time));\n            }\n            const t = tgdCalcModulo(time * 0.05, 0, 1);\n            const z = tgdCalcMix(0, -100, t);\n            context.camera.transfo.setPosition(0, 0, z);\n        }),\n    );\n    context.play();\n}"}
const FULL = "import {\n    tgdCalcDegToRad,\n    tgdCalcMix,\n    tgdCalcModulo,\n    tgdCalcRandom,\n    type TgdContext,\n    TgdControllerCameraOrbit,\n    TgdPainterClear,\n    TgdPainterLogic,\n    TgdPainterSprites,\n    TgdPainterSpritesAtlas,\n    TgdPainterState,\n    TgdSprite,\n    TgdTexture2D,\n    TgdTimeInterval,\n    webglPresetDepth,\n} from \"@tolokoban/tgd\";\n\nimport View, { type Assets } from \"@/components/demo/Tgd\";\n\nimport SpritesURL from \"./sprites.webp\";\n\nfunction init(context: TgdContext, assets: Assets) {\n    const clear = new TgdPainterClear(context, {\n        color: [0.3, 0.3, 0.3, 1],\n        depth: 1,\n    });\n    const texture = new TgdTexture2D(context, {\n        params: {\n            magFilter: \"NEAREST\",\n            minFilter: \"NEAREST\",\n            wrapR: \"CLAMP_TO_EDGE\",\n            wrapS: \"CLAMP_TO_EDGE\",\n            wrapT: \"CLAMP_TO_EDGE\",\n        },\n        load: assets.image.sprites,\n    });\n    const cell = (col: number, row: number) => ({\n        x: col / 8,\n        y: row / 10,\n        width: 1 / 8,\n        height: 1 / 10,\n    });\n    const atlas: TgdPainterSpritesAtlas = [];\n    for (let row = 0; row < 10; row++) {\n        for (let col = 0; col < 8; col++) {\n            atlas.push(cell(col, row));\n        }\n    }\n    const spritesPainter1 = new TgdPainterSprites(context, {\n        texture,\n        atlas,\n        atlasUnit: 5,\n    });\n    const spritesPainter2 = new TgdPainterSprites(context, {\n        texture,\n        atlas,\n        atlasUnit: 5,\n    });\n    const sprites: TgdSprite[] = [];\n    for (let x = -7; x < 8; x++) {\n        for (let y = -3; y < 4; y += 2) {\n            for (let z = 0; z < 1; z += 0.1) {\n                const sprite1 = spritesPainter1.spriteCreate({});\n                sprite1.x = x;\n                sprite1.y = y;\n                sprite1.z = -z * 100;\n                if (tgdCalcRandom() < 0.5) sprite1.scaleX = -1;\n                sprite1.index = Math.floor(tgdCalcRandom(0, 40));\n                sprites.push(sprite1);\n                const sprite2 = spritesPainter2.spriteCreate({});\n                sprite2.x = x;\n                sprite2.y = y;\n                sprite2.z = -z * 100 - 100;\n                if (tgdCalcRandom() < 0.5) sprite2.scaleX = -1;\n                sprite2.index = Math.floor(tgdCalcRandom(0, 72));\n                sprites.push(sprite2);\n            }\n        }\n    }\n    const STEPS: number[] = [\n        3,\n        2,\n        1,\n        0,\n        7,\n        6,\n        5,\n        4,\n        9,\n        10,\n        11,\n        8,\n        11,\n        12,\n        10,\n        15,\n    ];\n    for (let i = 0; i < 16; i++) {\n        STEPS.push(STEPS[i] + 16);\n    }\n    STEPS.push(32, 34, 35, 36, 33, 37, 39, 38);\n    for (let i = 0; i < 32; i++) {\n        STEPS.push(STEPS[i] + 40);\n    }\n    const interval = new TgdTimeInterval({\n        intervalInSeconds: 0.2,\n        action(time: number) {\n            for (const sprite of sprites) {\n                const nextStep = STEPS[sprite.index];\n                if (typeof nextStep === \"number\") {\n                    sprite.index = nextStep;\n                }\n            }\n        },\n    });\n    context.add(\n        clear,\n        new TgdPainterState(context, {\n            depth: webglPresetDepth.less,\n            children: [spritesPainter1, spritesPainter2],\n        }),\n        new TgdPainterLogic((time, delay) => {\n            interval.update(time, delay);\n            for (const sprite of sprites) {\n                sprite.angle = tgdCalcDegToRad(30 * Math.sin(time));\n            }\n            const t = tgdCalcModulo(time * 0.05, 0, 1);\n            const z = tgdCalcMix(0, -100, t);\n            context.camera.transfo.setPosition(0, 0, z);\n        }),\n    );\n    context.play();\n}\n\nexport default function Demo() {\n    return (\n        <View\n            onReady={init}\n            assets={{\n                image: { sprites: SpritesURL },\n            }}\n            controller={{\n                inertiaOrbit: 1000,\n                inertiaZoom: 1000,\n                geo: {\n                    minLat: tgdCalcDegToRad(-30),\n                    minLng: tgdCalcDegToRad(-30),\n                    maxLat: tgdCalcDegToRad(30),\n                    maxLng: tgdCalcDegToRad(30),\n                },\n            }}\n        />\n    );\n}\n"

export default function DemoContainer() {
    const [full, setFull] = React.useState(false)
    return <>
        <div className="half-left"><Demo /></div>
        <div className="half-right">
            <div>
                <ViewButton variant="elevated" onClick={() => setFull(!full)}>
                    {full ? "Show code details" : "Show full code"}
                </ViewButton>
            </div>
            <CodeViewer language="tsx" value={full ? FULL : FOCUS} />
        </div>
    </>
}