!function(){var a=mat4.create(),t=mat4.create(),n=mat4.create(),e=mat4.create(),r=mat4.create(),o=[0,0,0],m=[1,1,1];window.utils={xformMatrix:function(i,x,s,y){x=x||o,s=s||o,y=y||m,mat4.fromTranslation(a,x),mat4.fromXRotation(t,s[0]),mat4.fromYRotation(n,s[1]),mat4.fromZRotation(e,s[2]),mat4.fromScaling(r,y),mat4.multiply(i,t,r),mat4.multiply(i,n,i),mat4.multiply(i,e,i),mat4.multiply(i,a,i)},loadCubemapImages:function(a,t){var n=6,e=new Image,r=new Image,o=new Image,m=new Image,i=new Image,x=new Image;function s(){0===--n&&t(e,r,o,m,i,x)}e.onload=s,r.onload=s,o.onload=s,m.onload=s,i.onload=s,x.onload=s,e.src=a.negX,r.src=a.posX,o.src=a.negY,m.src=a.posY,i.src=a.negZ,x.src=a.posZ},createBox:function(a){var t,n,e,r=(a=a||{}).dimensions||[1,1,1],o=a.position||[-r[0]/2,-r[1]/2,-r[2]/2],m=o[0],i=o[1],x=o[2],s=r[0],y=r[1],z=r[2],I={x:m,y:i,z:x+z},c={x:m+s,y:i,z:x+z},h={x:m,y:i+y,z:x+z},l={x:m+s,y:i+y,z:x+z},u={x:m,y:i,z:x},M={x:m+s,y:i,z:x},p={x:m,y:i+y,z:x},N={x:m+s,y:i+y,z:x},g=new Float32Array([I.x,I.y,I.z,c.x,c.y,c.z,h.x,h.y,h.z,h.x,h.y,h.z,c.x,c.y,c.z,l.x,l.y,l.z,c.x,c.y,c.z,M.x,M.y,M.z,l.x,l.y,l.z,l.x,l.y,l.z,M.x,M.y,M.z,N.x,N.y,N.z,c.x,M.y,M.z,u.x,u.y,u.z,N.x,N.y,N.z,N.x,N.y,N.z,u.x,u.y,u.z,p.x,p.y,p.z,u.x,u.y,u.z,I.x,I.y,I.z,p.x,p.y,p.z,p.x,p.y,p.z,I.x,I.y,I.z,h.x,h.y,h.z,h.x,h.y,h.z,l.x,l.y,l.z,p.x,p.y,p.z,p.x,p.y,p.z,l.x,l.y,l.z,N.x,N.y,N.z,u.x,u.y,u.z,M.x,M.y,M.z,I.x,I.y,I.z,I.x,I.y,I.z,M.x,M.y,M.z,c.x,c.y,c.z]),f=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1]),d=new Float32Array(g.length);for(t=0,n=g.length/3;t<n;t++)d[e=3*t]=1===parseInt(t/6,10)?1:3===parseInt(t/6,10)?-1:0,d[e+1]=4===parseInt(t/6,10)?1:5===parseInt(t/6,10)?-1:0,d[e+2]=0===parseInt(t/6,10)?1:2===parseInt(t/6,10)?-1:0;return{positions:g,normals:d,uvs:f}},createSphere:function(a){var t,n,e,r,o,m,i,x,s,y,z,I,c,h,l,u,M,p,N,g,f=(a=a||{}).long_bands||32,d=a.lat_bands||32,w=a.radius||1,v=Math.PI/d,T=2*Math.PI/f,F=f*d*4,b=f*d*6,A=new Float32Array(3*F),E=new Float32Array(3*F),Y=new Float32Array(2*F),_=new Uint16Array(b),V=0,P=0;for(M=0;M<d;M++)for(t=M*v,i=Math.cos(t),x=Math.cos(t+v),p=0;p<f;p++)n=p*T,e=Math.sin(t)*Math.cos(n),r=Math.sin(t)*Math.cos(n+T),o=Math.sin(t+v)*Math.cos(n),m=Math.sin(t+v)*Math.cos(n+T),s=Math.sin(t)*Math.sin(n),y=Math.sin(t)*Math.sin(n+T),z=Math.sin(t+v)*Math.sin(n),I=Math.sin(t+v)*Math.sin(n+T),c=1-p/f,h=1-(p+1)/f,l=1-M/d,u=1-(M+1)/d,g=2*V,A[N=3*V]=e*w,A[N+1]=i*w,A[N+2]=s*w,A[N+3]=r*w,A[N+4]=i*w,A[N+5]=y*w,A[N+6]=o*w,A[N+7]=x*w,A[N+8]=z*w,A[N+9]=m*w,A[N+10]=x*w,A[N+11]=I*w,E[N]=e,E[N+1]=i,E[N+2]=s,E[N+3]=r,E[N+4]=i,E[N+5]=y,E[N+6]=o,E[N+7]=x,E[N+8]=z,E[N+9]=m,E[N+10]=x,E[N+11]=I,Y[g]=c,Y[g+1]=l,Y[g+2]=h,Y[g+3]=l,Y[g+4]=c,Y[g+5]=u,Y[g+6]=h,Y[g+7]=u,_[P]=V,_[P+1]=V+1,_[P+2]=V+2,_[P+3]=V+2,_[P+4]=V+1,_[P+5]=V+3,V+=4,P+=6;return{positions:A,normals:E,uvs:Y,indices:_}},computeBoundingBox:function(a,t){var n=(t=t||{}).geo||!1,e={min:vec3.create(),max:vec3.create()};vec3.set(e.min,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),vec3.set(e.max,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(var r=0,o=a.length;r<o;r+=3)e.min[0]=Math.min(a[r],e.min[0]),e.max[0]=Math.max(a[r],e.max[0]),e.min[1]=Math.min(a[r],e.min[1]),e.max[1]=Math.max(a[r],e.max[1]),e.min[2]=Math.min(a[r],e.min[2]),e.max[2]=Math.max(a[r],e.max[2]);if(n){var m=vec3.create();vec3.subtract(m,e.max,e.min),e.geo=utils.createBox({position:e.min,width:m[0],height:m[1],depth:m[2]})}return e}}}();