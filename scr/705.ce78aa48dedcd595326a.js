"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[705],{4592:(n,e,t)=>{t.r(e),t.d(e,{default:()=>m});var o=t(4848),a=t(8453),s=t(6540),r=t(7402),i=t(9074),c=t(9199),l=t(7289);const d=t.p+"img/wood.e07ebec2ba296ac08985.webp";function h(n){n.camera.transfo.setPosition(0,-5,0).distance=30,new c.pwt(n);const e=()=>new c.buV({transfo:{position:[0,-1,0]},children:[new c.buV({transfo:{position:[0,-.5,-.5]},children:[new c.g6h(n,{geometry:new c.ZWB,material:new c.$Hl({color:new c.HTX(n).loadBitmap(d,{generateMipmap:!0})})})]})]});let t=e();const o=[t];for(let n=0;n<31;n++){const n=e();o.push(n),n.add(t),t=n}n.add(new c.o57(n,{color:[.2,.1,0,1],depth:1}),new c.Ipk(n,{depth:c.Eg5.less,children:[t]}),new c.ZJl(((n,e)=>{for(const e of o){e.transfo.orientation.reset();const t=.95;e.transfo.setScale(t,t,t),e.transfo.orbitAroundX(Math.abs(Math.sin(n))*Math.PI*2/o.length),e.transfo.orbitAroundY(Math.sin(1.1287*n)*Math.PI*3*(1+Math.cos(.37243*n))/o.length)}t.transfo.orbitAroundY(.5*n)}))),n.play()}function u(){return(0,o.jsx)(l.A,{onReady:h})}const x={"Detail #1":"    ctx.camera.transfo.setPosition(0, -5, 0).distance = 30\n    new TgdControllerCameraOrbit(ctx)\n    const createBox = () =>\n        new TgdPainterNode({\n            transfo: {\n                position: [0, -1, 0],\n            },\n            children: [\n                new TgdPainterNode({\n                    transfo: {\n                        position: [0, -0.5, -0.5],\n                    },\n                    children: [\n                        new TgdPainterMesh(ctx, {\n                            geometry: new TgdGeometryBox(),\n                            material: new TgdMaterialDiffuse({\n                                color: new TgdTexture2D(ctx).loadBitmap(\n                                    WoodURL,\n                                    { generateMipmap: true }\n                                ),\n                            }),\n                        }),\n                    ],\n                }),\n            ],\n        })\n    let root = createBox()\n    const boxes: TgdPainterNode[] = [root]\n    for (let i = 0; i < 31; i++) {\n        const box = createBox()\n        boxes.push(box)\n        box.add(root)\n        root = box\n    }\n    ctx.add(\n        new TgdPainterClear(ctx, { color: [0.2, 0.1, 0, 1], depth: 1 }),\n        new TgdPainterState(ctx, {\n            depth: webglPresetDepth.less,\n            children: [root],\n        }),\n        new TgdPainterLogic((time, delay) => {\n            for (const box of boxes) {\n                box.transfo.orientation.reset()\n                const s = 0.95\n                box.transfo.setScale(s, s, s)\n                box.transfo.orbitAroundX(\n                    (Math.abs(Math.sin(time)) * Math.PI * 2) / boxes.length\n                )\n                box.transfo.orbitAroundY(\n                    (Math.sin(time * 1.1287) *\n                        Math.PI *\n                        3 *\n                        (1 + Math.cos(time * 0.37243))) /\n                        boxes.length\n                )\n            }\n            root.transfo.orbitAroundY(time * 0.5)\n        })\n    )\n    ctx.play()"},g='import {\n    TgdContext,\n    TgdControllerCameraOrbit,\n    TgdGeometryBox,\n    TgdMaterialDiffuse,\n    TgdMaterialNormals,\n    TgdPainterClear,\n    TgdPainterLogic,\n    TgdPainterMesh,\n    TgdPainterNode,\n    TgdPainterState,\n    TgdTexture2D,\n    webglPresetDepth,\n} from "@tolokoban/tgd"\nimport View from "@/components/demo/Tgd"\nimport WoodURL from "./wood.webp"\n\nfunction init(ctx: TgdContext) {\n    ctx.camera.transfo.setPosition(0, -5, 0).distance = 30\n    new TgdControllerCameraOrbit(ctx)\n    const createBox = () =>\n        new TgdPainterNode({\n            transfo: {\n                position: [0, -1, 0],\n            },\n            children: [\n                new TgdPainterNode({\n                    transfo: {\n                        position: [0, -0.5, -0.5],\n                    },\n                    children: [\n                        new TgdPainterMesh(ctx, {\n                            geometry: new TgdGeometryBox(),\n                            material: new TgdMaterialDiffuse({\n                                color: new TgdTexture2D(ctx).loadBitmap(\n                                    WoodURL,\n                                    { generateMipmap: true }\n                                ),\n                            }),\n                        }),\n                    ],\n                }),\n            ],\n        })\n    let root = createBox()\n    const boxes: TgdPainterNode[] = [root]\n    for (let i = 0; i < 31; i++) {\n        const box = createBox()\n        boxes.push(box)\n        box.add(root)\n        root = box\n    }\n    ctx.add(\n        new TgdPainterClear(ctx, { color: [0.2, 0.1, 0, 1], depth: 1 }),\n        new TgdPainterState(ctx, {\n            depth: webglPresetDepth.less,\n            children: [root],\n        }),\n        new TgdPainterLogic((time, delay) => {\n            for (const box of boxes) {\n                box.transfo.orientation.reset()\n                const s = 0.95\n                box.transfo.setScale(s, s, s)\n                box.transfo.orbitAroundX(\n                    (Math.abs(Math.sin(time)) * Math.PI * 2) / boxes.length\n                )\n                box.transfo.orbitAroundY(\n                    (Math.sin(time * 1.1287) *\n                        Math.PI *\n                        3 *\n                        (1 + Math.cos(time * 0.37243))) /\n                        boxes.length\n                )\n            }\n            root.transfo.orbitAroundY(time * 0.5)\n        })\n    )\n    ctx.play()\n}\n\nexport default function Demo() {\n    return <View onReady={init} />\n}\n';function f(){const[n,e]=s.useState(!1);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"half-left",children:(0,o.jsx)(u,{})}),(0,o.jsxs)("div",{className:"half-right",children:[(0,o.jsx)("div",{children:(0,o.jsx)(r.yQN,{variant:"elevated",onClick:()=>e(!n),children:n?"Show code details":"Show full code"})}),(0,o.jsx)(i.A,{language:"tsx",value:n?g:x})]})]})}function b(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",...(0,a.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h1,{children:(0,o.jsx)(e.a,{href:"docs/classes/TgdPainterNode.html",children:"TgdPainterNode"})}),"\n",(0,o.jsxs)(e.p,{children:["All objects implementing ",(0,o.jsx)(e.code,{children:"TgdInterfaceTransformable"})," have a ",(0,o.jsx)(e.code,{children:"transfo"})," attribute\nthat controls its position/orientation/scale in the world coordinate system. If\nyou need an object's transformation to be defined in another object coordinate\nsystem, you just have to wrap it in a ",(0,o.jsx)(e.code,{children:"TgdPainterNode"}),"."]}),"\n",(0,o.jsxs)(e.p,{children:["As long as a ",(0,o.jsx)(e.code,{children:"Transformable"})," is hold by the ",(0,o.jsx)(e.code,{children:"painter"})," attribute of a ",(0,o.jsx)(e.code,{children:"TgdPainterNode"}),",\nit will be controlled by the node.\nThat means, you should not use its ",(0,o.jsx)(e.code,{children:"transfo"})," attribute because it will be\noverwritten by the node."]}),"\n",(0,o.jsx)(e.h2,{children:"Example"}),"\n",(0,o.jsx)(f,{})]})}function m(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(b,{...n})}):b(n)}},7289:(n,e,t)=>{t.d(e,{A:()=>l});var o=t(4848),a=t(6540),s=t(9199),r=t(7402),i=t(3686);const c={Tgd:"hgIjhDQIuBCJEQ4ZgLXp",relative:"efOyHCihw9wfMB6AaAqw",overlay:"ywC8N0Uxbvm2Ug2DwPkE",loading:"PBWSRsbiwEqGpeL0hEfm",screen:"BErChOLWGtciKhh3IFud",canvas:"fT7FcYouYlPbElIAEXRP",gizmo:"uAPfWt_Dhe7RaRrnmIu0"};function l({className:n,options:e,onReady:t,gizmo:l=!1,width:d="640px",height:h="480px",noBorder:u=!1,assets:x,children:g}){const[f,b]=a.useState(!0),[m,p]=a.useState(!1),w=a.useRef(null),T=a.useRef(null),j=a.useRef(null),y=a.useRef(null),[P,v]=a.useState(!0);let M="auto";d.endsWith("px")&&h.endsWith("px")&&(d.substring(d.length-2),h.substring(h.length-2));const N=n=>{if(!n)return;if(T.current)return;T.current=n;const o=new s.tfp(n,e);w.current=o,v(!0),async function({glb:n,data:e,text:t,image:o}={}){console.log("ðŸš€ [Tgd] glb, data, text, image = ",n,e,t,o);const a={glb:{},data:{},text:{},image:{}},r=[];return o&&Object.keys(o).forEach((n=>{r.push((async()=>{const e=o[n];console.log("Loading image:",e);const t=await(0,s.V_9)(e);t&&(a.image[n]=t)}))})),n&&Object.keys(n).forEach((e=>{r.push((async()=>{const t=n[e];console.log("Loading GLB:",t);const o=await(0,s.TCe)(t);o&&(a.glb[e]=o)}))})),e&&Object.keys(e).forEach((n=>{r.push((async()=>{const t=e[n],o=await(0,s.vSU)(t);o&&(a.data[n]=o)}))})),t&&Object.keys(t).forEach((n=>{r.push((async()=>{const e=t[n],o=await(0,s.jWq)(e);o&&(a.text[n]=o)}))})),await Promise.all(r.map((n=>n()))),a}(x).then((n=>{console.log("Ready!"),t(o,n),o.paint(),v(!1)})).catch((n=>{console.error("Unable to initialize the scene!",n),v(!1)}));const a=j.current;a&&a.attachContext(o)},C=n=>{const e=new s.GbF({canvas:n});j.current=e,e.eventTipClick.addListener((({to:n})=>{const e=w.current;console.log("ðŸš€ [tgd] to, context =",n,e),e&&e.animSchedule({duration:.2,easingFunction:s.Wcc,action:(0,s.vRM)(e.camera,{orientation:n})})}));const t=w.current;t&&e.attachContext(t)};return a.useEffect((()=>{const n=T.current,e=w.current;if(!n||!e)return;const t=new ResizeObserver((()=>e.paint()));return t.observe(n),n.requestFullscreen||(n.requestFullscreen=n.webkitRequestFullscreen),p(Boolean(n.requestFullscreen)),()=>t.unobserve(n)}),[w.current,T.current]),u?(0,o.jsxs)("div",{ref:y,className:c.screen,style:{width:f?d:h,height:f?h:d},children:[(0,o.jsx)("canvas",{className:c.canvas,ref:N}),l&&(0,o.jsx)("canvas",{className:c.gizmo,ref:C})]}):(0,o.jsxs)("div",{className:r.Sxu.classNames.join(n,c.Tgd),children:[(0,o.jsxs)(r.sWC,{display:"flex",justifyContent:"space-between",children:[(0,o.jsx)(r.yQN,{variant:"elevated",onClick:()=>b(!f),enabled:!P,children:f?"Switch to Portrait":"Switch to Landscape"}),m&&(0,o.jsx)(r.yQN,{variant:"elevated",onClick:()=>{const n=y.current;n&&n.requestFullscreen()},enabled:!P,children:"Fullscreen"})]}),(0,o.jsxs)("div",{className:c.relative,children:[(0,o.jsxs)("div",{ref:y,className:c.screen,style:{width:f?d:h,height:f?h:d},children:[(0,o.jsx)("canvas",{className:c.canvas,ref:N}),l&&(0,o.jsx)("canvas",{className:c.gizmo,ref:C})]}),(0,o.jsx)("div",{className:r.Sxu.classNames.join(c.overlay,P&&c.loading),children:(0,o.jsx)(i.A,{})}),g]})]})}},8453:(n,e,t)=>{t.d(e,{R:()=>s});var o=t(6540);const a=o.createContext({});function s(n){const e=o.useContext(a);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}}}]);