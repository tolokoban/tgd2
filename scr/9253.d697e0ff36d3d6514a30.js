"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[9253],{4859:(e,n,t)=>{e.exports=t.p+"img/dino.a892a1760dcaac9618a1.webp"},6936:(e,n,t)=>{t.r(n),t.d(n,{default:()=>b});var A=t(4848),r=t(8453),a=t(6540),o=t(7781),i=t(9074),s=t(2138),c=t(7289);class l extends s.TgdMaterial{constructor(){super({uniforms:{texDiffuse:"sampler2D",uniTime:"float"},varyings:{varUV:"vec2"},fragmentShaderCode:["vec4 color1 = texture(texDiffuse, varUV * 1.0);","float k = 0.7071067811865476;","float ang = uniTime * .777;","vec4 color2 = vec4(",["0.5 + k * sin(ang - 2.0943951023931953),","0.5 + k * sin(ang),","0.5 + k * sin(ang + 2.0943951023931953),","1.0"],");","vec2 p = 2.0 * (varUV - vec2(.5));","vec2 polar = vec2(",["length(p),","atan(p.y, p.x)"],");","float alpha = 0.1 + 0.3 * (cos(uniTime * 1.451) * sin(uniTime) + 1.0);","polar.y -= uniTime * 1.421 * (1.0 + pow(polar.x, .5));","polar.x += 0.25 * sin(0.75 * uniTime + polar.y * 3.0) * cos(uniTime * 1.751);","float beta = 1.0 - smoothstep(0.0, 0.1 + 0.1 * abs(sin(uniTime * 1.1474) * cos(uniTime) * 1.452), abs(fract(polar.x * 0.90) - 0.5));","return mix(color1, color2, max(alpha, beta));"],vertexShaderCode:["varUV = TEXCOORD_0;"],setUniforms:(e,n)=>{const{texture:t}=this;t&&t.activate(0,e,"texDiffuse"),e.uniform1f("uniTime",.001*n)}}),this.texture=void 0}}const d="data:model/gltf-binary;base64,Z2xURgIAAADABgAAXAMAAEpTT057ImFzc2V0Ijp7ImdlbmVyYXRvciI6Iktocm9ub3MgZ2xURiBCbGVuZGVyIEkvTyB2NC4zLjQ3IiwidmVyc2lvbiI6IjIuMCJ9LCJzY2VuZSI6MCwic2NlbmVzIjpbeyJuYW1lIjoiU2NlbmUiLCJub2RlcyI6WzBdfV0sIm5vZGVzIjpbeyJtZXNoIjowLCJuYW1lIjoiQ3ViZSJ9XSwibWVzaGVzIjpbeyJuYW1lIjoiQ3ViZSIsInByaW1pdGl2ZXMiOlt7ImF0dHJpYnV0ZXMiOnsiUE9TSVRJT04iOjAsIk5PUk1BTCI6MSwiVEVYQ09PUkRfMCI6Mn0sImluZGljZXMiOjN9XX1dLCJhY2Nlc3NvcnMiOlt7ImJ1ZmZlclZpZXciOjAsImNvbXBvbmVudFR5cGUiOjUxMjYsImNvdW50IjoyNCwibWF4IjpbMSwxLDFdLCJtaW4iOlstMSwtMSwtMV0sInR5cGUiOiJWRUMzIn0seyJidWZmZXJWaWV3IjoxLCJjb21wb25lbnRUeXBlIjo1MTI2LCJjb3VudCI6MjQsInR5cGUiOiJWRUMzIn0seyJidWZmZXJWaWV3IjoyLCJjb21wb25lbnRUeXBlIjo1MTI2LCJjb3VudCI6MjQsInR5cGUiOiJWRUMyIn0seyJidWZmZXJWaWV3IjozLCJjb21wb25lbnRUeXBlIjo1MTIzLCJjb3VudCI6MzYsInR5cGUiOiJTQ0FMQVIifV0sImJ1ZmZlclZpZXdzIjpbeyJidWZmZXIiOjAsImJ5dGVMZW5ndGgiOjI4OCwiYnl0ZU9mZnNldCI6MCwidGFyZ2V0IjozNDk2Mn0seyJidWZmZXIiOjAsImJ5dGVMZW5ndGgiOjI4OCwiYnl0ZU9mZnNldCI6Mjg4LCJ0YXJnZXQiOjM0OTYyfSx7ImJ1ZmZlciI6MCwiYnl0ZUxlbmd0aCI6MTkyLCJieXRlT2Zmc2V0Ijo1NzYsInRhcmdldCI6MzQ5NjJ9LHsiYnVmZmVyIjowLCJieXRlTGVuZ3RoIjo3MiwiYnl0ZU9mZnNldCI6NzY4LCJ0YXJnZXQiOjM0OTYzfV0sImJ1ZmZlcnMiOlt7ImJ5dGVMZW5ndGgiOjg0MH1dfUgDAABCSU4AAACAPwAAgD8AAIA/AACAPwAAgD8AAIA/AACAPwAAgD8AAIA/AACAPwAAgD8AAIC/AACAPwAAgD8AAIC/AACAPwAAgD8AAIC/AACAPwAAgL8AAIA/AACAPwAAgL8AAIA/AACAPwAAgL8AAIA/AACAPwAAgL8AAIC/AACAPwAAgL8AAIC/AACAPwAAgL8AAIC/AACAvwAAgD8AAIA/AACAvwAAgD8AAIA/AACAvwAAgD8AAIA/AACAvwAAgD8AAIC/AACAvwAAgD8AAIC/AACAvwAAgD8AAIC/AACAvwAAgL8AAIA/AACAvwAAgL8AAIA/AACAvwAAgL8AAIA/AACAvwAAgL8AAIC/AACAvwAAgL8AAIC/AACAvwAAgL8AAIC/AAAAAAAAAAAAAIA/AAAAAAAAgD8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgD8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgL8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgL8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgD8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgD8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgL8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgL8AAAAAAACAvwAAAAAAAAAAuth/P7nYfz+22H8/uth/P7XYfz+52H8/uNh/P7nYfz+22H8/ACQdOgASHTq42H8/ACAdOrjYfz+42H8/uth/P7jYfz8AKB06uth/PwAcHToAHB06udh/PwAYHToAHB06uth/PwAoHToAFh06uth/P7bYfz+52H8/ACAdOrbYfz8AIh06ACQdOrrYfz8AKB06ACYdOgAcHTq62H8/ACgdOgAgHTq52H8/ACgdOgAQHToAIB06ABwdOgAgHToAKB06AAAMABIAAAASAAYACgAHABMACgATABYAFwAUAA4AFwAOABEADwADAAkADwAJABUABQACAAgABQAIAAsAEAANAAEAEAABAAQA";var u=t(4859);function g(e,n){e.camera=new s.TgdCameraPerspective({transfo:{distance:0},far:100,near:.01,fovy:.25*Math.PI,zoom:.333}),new s.TgdControllerCameraOrbit(e,{speedPanning:0,inertiaOrbit:1e3});const t=new s.TgdPainterFramebuffer(e,{textureColor0:new s.TgdTexture2D(e)}),A=new s.TgdPainterFramebuffer(e,{textureColor0:new s.TgdTexture2D(e)}),r=new l;r.texture=new s.TgdTexture2D(e).loadBitmap(n.image.background);const a=new s.TgdPainterState(e,{depth:s.webglPresetDepth.less,children:[new s.TgdPainterClear(e,{color:new s.TgdVec4,depth:1}),new s.TgdPainterMeshGltf(e,{asset:n.glb.mesh,material:()=>r})]});t.add(a);const o=new s.TgdPainterFilter(e,{filters:[new s.TgdFilterHueRotation({hueShiftInDegrees:90})],texture:t.textureColor0});A.add(o);const i=new s.TgdPainterFilter(e,{texture:t.textureColor0,filters:[new s.TgdFilterZoom({zoom:1.1})],flipY:!0});t.onExit=()=>{o.texture=t.textureColor0},A.onExit=()=>{r.texture=A.textureColor0,i.texture=A.textureColor0},e.add(t,A,i,new s.TgdPainterLogic((n,t)=>{const{camera:A}=e;A.transfo.orbitAroundY(t)})),e.play()}function f(){return(0,A.jsx)(c.A,{onReady:g,assets:{glb:{mesh:d},image:{background:u}}})}const m={"Detail #1":"    context.camera = new TgdCameraPerspective({\n        transfo: { distance: 0 },\n        far: 100,\n        near: 0.01,\n        fovy: Math.PI * 0.25,\n        zoom: 0.333,\n    })\n    new TgdControllerCameraOrbit(context, {\n        speedPanning: 0,\n        inertiaOrbit: 1000,\n    })\n    const framebufferRender = new TgdPainterFramebuffer(context, {\n        textureColor0: new TgdTexture2D(context),\n    })\n    const framebufferCopy = new TgdPainterFramebuffer(context, {\n        textureColor0: new TgdTexture2D(context),\n    })\n    const material = new Material()\n    material.texture = new TgdTexture2D(context).loadBitmap(\n        assets.image.background\n    )\n    const painter = new TgdPainterState(context, {\n        depth: webglPresetDepth.less,\n        // cull: webglPresetCull.front,\n        children: [\n            new TgdPainterClear(context, {\n                color: new TgdVec4(),\n                depth: 1,\n            }),\n            new TgdPainterMeshGltf(context, {\n                asset: assets.glb.mesh,\n                material: () => material,\n            }),\n        ],\n    })\n    framebufferRender.add(painter)\n    const copy = new TgdPainterFilter(context, {\n        filters: [\n            new TgdFilterHueRotation({\n                hueShiftInDegrees: 90,\n            }),\n        ],\n        texture: framebufferRender.textureColor0,\n    })\n    framebufferCopy.add(copy)\n    const screen = new TgdPainterFilter(context, {\n        texture: framebufferRender.textureColor0,\n        filters: [new TgdFilterZoom({ zoom: 1.1 })],\n        flipY: true,\n    })\n    framebufferRender.onExit = () => {\n        copy.texture = framebufferRender.textureColor0\n    }\n    framebufferCopy.onExit = () => {\n        material.texture = framebufferCopy.textureColor0\n        screen.texture = framebufferCopy.textureColor0\n    }\n    context.add(\n        framebufferRender,\n        framebufferCopy,\n        screen,\n        new TgdPainterLogic((time, delay) => {\n            const { camera } = context\n            camera.transfo.orbitAroundY(delay)\n        })\n    )\n    context.play()"},C='import {\n    TgdCameraPerspective,\n    TgdContext,\n    TgdControllerCameraOrbit,\n    TgdFilterHueRotation,\n    TgdFilterZoom,\n    TgdPainterClear,\n    TgdPainterFilter,\n    TgdPainterFramebuffer,\n    TgdPainterLogic,\n    TgdPainterMeshGltf,\n    TgdPainterState,\n    TgdTexture2D,\n    TgdVec4,\n    webglPresetDepth,\n} from "@tolokoban/tgd"\nimport View, { Assets } from "@/components/demo/Tgd"\nimport { Material } from "./material"\n\nimport CubeURL from "@/assets/mesh/cube.glb"\nimport BackgroundURL from "@/assets/image/dino.webp"\n\nfunction init(context: TgdContext, assets: Assets) {\n    context.camera = new TgdCameraPerspective({\n        transfo: { distance: 0 },\n        far: 100,\n        near: 0.01,\n        fovy: Math.PI * 0.25,\n        zoom: 0.333,\n    })\n    new TgdControllerCameraOrbit(context, {\n        speedPanning: 0,\n        inertiaOrbit: 1000,\n    })\n    const framebufferRender = new TgdPainterFramebuffer(context, {\n        textureColor0: new TgdTexture2D(context),\n    })\n    const framebufferCopy = new TgdPainterFramebuffer(context, {\n        textureColor0: new TgdTexture2D(context),\n    })\n    const material = new Material()\n    material.texture = new TgdTexture2D(context).loadBitmap(\n        assets.image.background\n    )\n    const painter = new TgdPainterState(context, {\n        depth: webglPresetDepth.less,\n        // cull: webglPresetCull.front,\n        children: [\n            new TgdPainterClear(context, {\n                color: new TgdVec4(),\n                depth: 1,\n            }),\n            new TgdPainterMeshGltf(context, {\n                asset: assets.glb.mesh,\n                material: () => material,\n            }),\n        ],\n    })\n    framebufferRender.add(painter)\n    const copy = new TgdPainterFilter(context, {\n        filters: [\n            new TgdFilterHueRotation({\n                hueShiftInDegrees: 90,\n            }),\n        ],\n        texture: framebufferRender.textureColor0,\n    })\n    framebufferCopy.add(copy)\n    const screen = new TgdPainterFilter(context, {\n        texture: framebufferRender.textureColor0,\n        filters: [new TgdFilterZoom({ zoom: 1.1 })],\n        flipY: true,\n    })\n    framebufferRender.onExit = () => {\n        copy.texture = framebufferRender.textureColor0\n    }\n    framebufferCopy.onExit = () => {\n        material.texture = framebufferCopy.textureColor0\n        screen.texture = framebufferCopy.textureColor0\n    }\n    context.add(\n        framebufferRender,\n        framebufferCopy,\n        screen,\n        new TgdPainterLogic((time, delay) => {\n            const { camera } = context\n            camera.transfo.orbitAroundY(delay)\n        })\n    )\n    context.play()\n}\n\nexport default function Demo() {\n    return (\n        <View\n            onReady={init}\n            assets={{\n                glb: {\n                    mesh: CubeURL,\n                },\n                image: {\n                    background: BackgroundURL,\n                },\n            }}\n        />\n    )\n}\n';function x(){const[e,n]=a.useState(!1);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("div",{className:"half-left",children:(0,A.jsx)(f,{})}),(0,A.jsxs)("div",{className:"half-right",children:[(0,A.jsx)("div",{children:(0,A.jsx)(o.yQN,{variant:"elevated",onClick:()=>n(!e),children:e?"Show code details":"Show full code"})}),(0,A.jsx)(i.A,{language:"tsx",value:e?C:m})]})]})}function w(e){const n={a:"a",h1:"h1",...(0,r.R)(),...e.components};return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(n.h1,{children:[(0,A.jsx)(n.a,{href:"docs/classes/TgdPainterFramebuffer.html",children:"TgdPainterFramebuffer"})," - Example 2"]}),"\n",(0,A.jsx)(x,{})]})}function b(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,A.jsx)(n,{...e,children:(0,A.jsx)(w,{...e})}):w(e)}},7289:(e,n,t)=>{t.d(n,{A:()=>c});var A=t(4848),r=t(6540),a=t(2138),o=t(7781),i=t(3686);const s={Tgd:"hgIjhDQIuBCJEQ4ZgLXp",relative:"efOyHCihw9wfMB6AaAqw",overlay:"ywC8N0Uxbvm2Ug2DwPkE",loading:"PBWSRsbiwEqGpeL0hEfm",screen:"BErChOLWGtciKhh3IFud",canvas:"fT7FcYouYlPbElIAEXRP",gizmo:"uAPfWt_Dhe7RaRrnmIu0",actions:"Ia9jfUO3OevcIh2fV6R6",enabled:"dZYZScZBbWV2Pm3ftXcG",error:"J6dIEMXVMCzdFWF9UHio"};function c({className:e,options:n,onReady:t,gizmo:c=!1,width:l="640px",height:d="480px",noBorder:u=!1,assets:g,children:f}){const[m,C]=r.useState(null),[x,w]=r.useState(!0),[b,h]=r.useState(!1),I=r.useRef(null),T=r.useRef(null),p=r.useRef(null),j=r.useRef(null),[v,P]=r.useState(!0);let y="auto";l.endsWith("px")&&d.endsWith("px")&&(l.substring(l.length-2),d.substring(d.length-2));const R=e=>{if(!e)return;if(T.current)return;T.current=e;const A=new a.TgdContext(e,n),r=A.gl.getParameter(A.gl.DEPTH_BITS);console.log("Depht buffer bits:",r),I.current=A,P(!0),async function({glb:e,data:n,text:t,image:A}={}){console.log("ðŸš€ [Tgd] glb, data, text, image = ",e,n,t,A);const r={glb:{},data:{},text:{},image:{}},o=[];return A&&Object.keys(A).forEach(e=>{o.push(async()=>{const n=A[e];console.log("Loading image:",n);const t=await(0,a.tgdLoadImage)(n);t&&(r.image[e]=t)})}),e&&Object.keys(e).forEach(n=>{o.push(async()=>{const t=e[n];console.log("Loading GLB:",t);const A=await(0,a.tgdLoadGlb)(t);A&&(r.glb[n]=A)})}),n&&Object.keys(n).forEach(e=>{o.push(async()=>{const t=n[e],A=await(0,a.tgdLoadArrayBuffer)(t);A&&(r.data[e]=A)})}),t&&Object.keys(t).forEach(e=>{o.push(async()=>{const n=t[e],A=await(0,a.tgdLoadText)(n);A&&(r.text[e]=A)})}),await Promise.all(o.map(e=>e())),r}(g).then(e=>{try{t(A,e),A.paint()}catch(e){C(e instanceof Error?e.message:JSON.stringify(e))}P(!1)}).catch(e=>{console.error("Unable to initialize the scene!",e),P(!1)});const o=p.current;o&&o.attachContext(A)},Z=e=>{const n=new a.TgdCanvasGizmo({canvas:e});p.current=n,n.eventTipClick.addListener(({to:e})=>{const n=I.current;n&&n.animSchedule({duration:.2,easingFunction:a.tgdEasingFunctionInOutCubic,action:(0,a.tgdActionCreateCameraInterpolation)(n.camera,{orientation:e})})});const t=I.current;t&&n.attachContext(t)};return r.useEffect(()=>{const e=T.current,n=I.current;if(!e||!n)return;const t=new ResizeObserver(()=>n.paint());return t.observe(e),e.requestFullscreen||(e.requestFullscreen=e.webkitRequestFullscreen),h(Boolean(e.requestFullscreen)),()=>t.unobserve(e)},[I.current,T.current]),u?(0,A.jsxs)("div",{ref:j,className:s.screen,style:{width:x?l:d,height:x?d:l},children:[(0,A.jsx)("canvas",{className:s.canvas,ref:R}),c&&(0,A.jsx)("canvas",{className:s.gizmo,ref:Z}),m&&(0,A.jsx)("div",{className:s.error,children:m})]}):(0,A.jsxs)("div",{className:o.Sxu.classNames.join(e,s.Tgd),children:[(0,A.jsxs)("div",{className:o.Sxu.classNames.join(s.actions,!v&&s.enabled),children:[(0,A.jsx)("div",{children:(0,A.jsx)(o.I64,{onClick:()=>w(!x)})}),(0,A.jsx)("div",{children:(0,A.jsx)(o.kRc,{onClick:()=>{const e=I.current;e&&e.takeSnapshot().then(e=>{const n=document.createElement("a");document.body.appendChild(n),n.style.display="none",n.href=e.src,n.download="snapshot.png",n.click(),window.setTimeout(()=>document.body.removeChild(n),3e4)})}})}),b&&(0,A.jsx)("div",{children:(0,A.jsx)(o.L9n,{onClick:()=>{const e=j.current;e&&e.requestFullscreen()}})})]}),(0,A.jsxs)("div",{className:s.relative,children:[(0,A.jsxs)("div",{ref:j,className:s.screen,style:{width:x?l:d,height:x?d:l},children:[(0,A.jsx)("canvas",{className:s.canvas,ref:R}),c&&(0,A.jsx)("canvas",{className:s.gizmo,ref:Z}),m&&(0,A.jsx)("div",{className:s.error,children:m})]}),(0,A.jsx)("div",{className:o.Sxu.classNames.join(s.overlay,v&&s.loading),children:(0,A.jsx)(i.A,{})}),f]})]})}},8453:(e,n,t)=>{t.d(n,{R:()=>a});var A=t(6540);const r=A.createContext({});function a(e){const n=A.useContext(r);return A.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}}}]);