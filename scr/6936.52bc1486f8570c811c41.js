"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[6936],{6936:(e,n,t)=>{t.r(n),t.d(n,{default:()=>h});var A=t(4848),r=t(8453),a=t(6540),o=t(5968),i=t(2212),s=t(4461),c=t(6989);class l extends s.rBx{constructor(){super(),this.vertexShaderCode=["varUV = TEXCOORD_0;"],this.texture=void 0,this.fragmentShaderCode=["vec4 color1 = texture(texDiffuse, varUV * 1.0);","float k = 0.7071067811865476;","float ang = uniTime * .777;","vec4 color2 = vec4(",["0.5 + k * sin(ang - 2.0943951023931953),","0.5 + k * sin(ang),","0.5 + k * sin(ang + 2.0943951023931953),","1.0"],");","vec2 p = 2.0 * (varUV - vec2(.5));","vec2 polar = vec2(",["length(p),","atan(p.y, p.x)"],");","float alpha = 0.1 + 0.3 * (cos(uniTime * 1.451) * sin(uniTime) + 1.0);","polar.y -= uniTime * 1.421 * (1.0 + pow(polar.x, .5));","polar.x += 0.25 * sin(0.75 * uniTime + polar.y * 3.0) * cos(uniTime * 1.751);","float beta = 1.0 - smoothstep(0.0, 0.1 + 0.1 * abs(sin(uniTime * 1.1474) * cos(uniTime) * 1.452), abs(fract(polar.x * 0.90) - 0.5));","return mix(color1, color2, max(alpha, beta));"],this.varyings.varUV="vec2",this.uniforms.texDiffuse="sampler2D",this.uniforms.uniTime="float"}setUniforms(e,n){const{texture:t}=this;t&&t.activate(0,e,"texDiffuse"),e.uniform1f("uniTime",.001*n)}}const d="data:model/gltf-binary;base64,Z2xURgIAAADABgAAXAMAAEpTT057ImFzc2V0Ijp7ImdlbmVyYXRvciI6Iktocm9ub3MgZ2xURiBCbGVuZGVyIEkvTyB2NC4zLjQ3IiwidmVyc2lvbiI6IjIuMCJ9LCJzY2VuZSI6MCwic2NlbmVzIjpbeyJuYW1lIjoiU2NlbmUiLCJub2RlcyI6WzBdfV0sIm5vZGVzIjpbeyJtZXNoIjowLCJuYW1lIjoiQ3ViZSJ9XSwibWVzaGVzIjpbeyJuYW1lIjoiQ3ViZSIsInByaW1pdGl2ZXMiOlt7ImF0dHJpYnV0ZXMiOnsiUE9TSVRJT04iOjAsIk5PUk1BTCI6MSwiVEVYQ09PUkRfMCI6Mn0sImluZGljZXMiOjN9XX1dLCJhY2Nlc3NvcnMiOlt7ImJ1ZmZlclZpZXciOjAsImNvbXBvbmVudFR5cGUiOjUxMjYsImNvdW50IjoyNCwibWF4IjpbMSwxLDFdLCJtaW4iOlstMSwtMSwtMV0sInR5cGUiOiJWRUMzIn0seyJidWZmZXJWaWV3IjoxLCJjb21wb25lbnRUeXBlIjo1MTI2LCJjb3VudCI6MjQsInR5cGUiOiJWRUMzIn0seyJidWZmZXJWaWV3IjoyLCJjb21wb25lbnRUeXBlIjo1MTI2LCJjb3VudCI6MjQsInR5cGUiOiJWRUMyIn0seyJidWZmZXJWaWV3IjozLCJjb21wb25lbnRUeXBlIjo1MTIzLCJjb3VudCI6MzYsInR5cGUiOiJTQ0FMQVIifV0sImJ1ZmZlclZpZXdzIjpbeyJidWZmZXIiOjAsImJ5dGVMZW5ndGgiOjI4OCwiYnl0ZU9mZnNldCI6MCwidGFyZ2V0IjozNDk2Mn0seyJidWZmZXIiOjAsImJ5dGVMZW5ndGgiOjI4OCwiYnl0ZU9mZnNldCI6Mjg4LCJ0YXJnZXQiOjM0OTYyfSx7ImJ1ZmZlciI6MCwiYnl0ZUxlbmd0aCI6MTkyLCJieXRlT2Zmc2V0Ijo1NzYsInRhcmdldCI6MzQ5NjJ9LHsiYnVmZmVyIjowLCJieXRlTGVuZ3RoIjo3MiwiYnl0ZU9mZnNldCI6NzY4LCJ0YXJnZXQiOjM0OTYzfV0sImJ1ZmZlcnMiOlt7ImJ5dGVMZW5ndGgiOjg0MH1dfUgDAABCSU4AAACAPwAAgD8AAIA/AACAPwAAgD8AAIA/AACAPwAAgD8AAIA/AACAPwAAgD8AAIC/AACAPwAAgD8AAIC/AACAPwAAgD8AAIC/AACAPwAAgL8AAIA/AACAPwAAgL8AAIA/AACAPwAAgL8AAIA/AACAPwAAgL8AAIC/AACAPwAAgL8AAIC/AACAPwAAgL8AAIC/AACAvwAAgD8AAIA/AACAvwAAgD8AAIA/AACAvwAAgD8AAIA/AACAvwAAgD8AAIC/AACAvwAAgD8AAIC/AACAvwAAgD8AAIC/AACAvwAAgL8AAIA/AACAvwAAgL8AAIA/AACAvwAAgL8AAIA/AACAvwAAgL8AAIC/AACAvwAAgL8AAIC/AACAvwAAgL8AAIC/AAAAAAAAAAAAAIA/AAAAAAAAgD8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgD8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgL8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgL8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgD8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgD8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgL8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgL8AAAAAAACAvwAAAAAAAAAAuth/P7nYfz+22H8/uth/P7XYfz+52H8/uNh/P7nYfz+22H8/ACQdOgASHTq42H8/ACAdOrjYfz+42H8/uth/P7jYfz8AKB06uth/PwAcHToAHB06udh/PwAYHToAHB06uth/PwAoHToAFh06uth/P7bYfz+52H8/ACAdOrbYfz8AIh06ACQdOrrYfz8AKB06ACYdOgAcHTq62H8/ACgdOgAgHTq52H8/ACgdOgAQHToAIB06ABwdOgAgHToAKB06AAAMABIAAAASAAYACgAHABMACgATABYAFwAUAA4AFwAOABEADwADAAkADwAJABUABQACAAgABQAIAAsAEAANAAEAEAABAAQA";var u=t(4859);function f(e,n){e.camera=new s.xNY({transfo:{distance:0},far:100,near:.01,fovy:.25*Math.PI,zoom:.333}),new s.pwt(e,{speedPanning:0,inertiaOrbit:1e3});const t=new s.K7(e,{textureColor0:new s.HTX(e)}),A=new s.K7(e,{textureColor0:new s.HTX(e)}),r=new l;r.texture=new s.HTX(e).loadBitmap(n.image.background);const a=new s.Ipk(e,{depth:s.Eg5.less,children:[new s.o57(e,{color:new s.oao,depth:1}),new s.dRj(e,{asset:n.glb.mesh,materialFactory:()=>r})]});t.add(a);const o=new s.D$w(e,{filters:[new s.ChJ({hueShiftInDegrees:90})],texture:t.textureColor0});A.add(o);const i=new s.D$w(e,{texture:t.textureColor0,filters:[new s.HBr({zoom:1.1})],flipY:!0});t.onExit=()=>{o.texture=t.textureColor0},A.onExit=()=>{r.texture=A.textureColor0,i.texture=A.textureColor0},e.add(t,A,i,new s.ZJl(((n,t)=>{const{camera:A}=e;A.transfo.orbitAroundY(t)}))),e.play()}function m(){return(0,A.jsx)(c.A,{onReady:f,assets:{glb:{mesh:d},image:{background:u}}})}const g={"Detail #1":"    context.camera = new TgdCameraPerspective({\n        transfo: { distance: 0 },\n        far: 100,\n        near: 0.01,\n        fovy: Math.PI * 0.25,\n        zoom: 0.333,\n    })\n    new TgdControllerCameraOrbit(context, {\n        speedPanning: 0,\n        inertiaOrbit: 1000,\n    })\n    const framebufferRender = new TgdPainterFramebuffer(context, {\n        textureColor0: new TgdTexture2D(context),\n    })\n    const framebufferCopy = new TgdPainterFramebuffer(context, {\n        textureColor0: new TgdTexture2D(context),\n    })\n    const material = new Material()\n    material.texture = new TgdTexture2D(context).loadBitmap(\n        assets.image.background\n    )\n    const painter = new TgdPainterState(context, {\n        depth: webglPresetDepth.less,\n        // cull: webglPresetCull.front,\n        children: [\n            new TgdPainterClear(context, {\n                color: new TgdVec4(),\n                depth: 1,\n            }),\n            new TgdPainterMeshGltf(context, {\n                asset: assets.glb.mesh,\n                materialFactory: () => material,\n            }),\n        ],\n    })\n    framebufferRender.add(painter)\n    const copy = new TgdPainterFilter(context, {\n        filters: [\n            new TgdFilterHueRotation({\n                hueShiftInDegrees: 90,\n            }),\n        ],\n        texture: framebufferRender.textureColor0,\n    })\n    framebufferCopy.add(copy)\n    const screen = new TgdPainterFilter(context, {\n        texture: framebufferRender.textureColor0,\n        filters: [new TgdFilterZoom({ zoom: 1.1 })],\n        flipY: true,\n    })\n    framebufferRender.onExit = () => {\n        copy.texture = framebufferRender.textureColor0\n    }\n    framebufferCopy.onExit = () => {\n        material.texture = framebufferCopy.textureColor0\n        screen.texture = framebufferCopy.textureColor0\n    }\n    context.add(\n        framebufferRender,\n        framebufferCopy,\n        screen,\n        new TgdPainterLogic((time, delay) => {\n            const { camera } = context\n            camera.transfo.orbitAroundY(delay)\n        })\n    )\n    context.play()"},C='import {\n    TgdCameraPerspective,\n    TgdContext,\n    TgdControllerCameraOrbit,\n    TgdFilterHueRotation,\n    TgdFilterZoom,\n    TgdPainterClear,\n    TgdPainterFilter,\n    TgdPainterFramebuffer,\n    TgdPainterLogic,\n    TgdPainterMeshGltf,\n    TgdPainterState,\n    TgdTexture2D,\n    TgdVec4,\n    webglPresetDepth,\n} from "@tolokoban/tgd"\nimport View, { Assets } from "@/components/demo/Tgd"\nimport { Material } from "./material"\n\nimport CubeURL from "@/assets/mesh/cube.glb"\nimport BackgroundURL from "@/assets/image/dino.webp"\n\nfunction init(context: TgdContext, assets: Assets) {\n    context.camera = new TgdCameraPerspective({\n        transfo: { distance: 0 },\n        far: 100,\n        near: 0.01,\n        fovy: Math.PI * 0.25,\n        zoom: 0.333,\n    })\n    new TgdControllerCameraOrbit(context, {\n        speedPanning: 0,\n        inertiaOrbit: 1000,\n    })\n    const framebufferRender = new TgdPainterFramebuffer(context, {\n        textureColor0: new TgdTexture2D(context),\n    })\n    const framebufferCopy = new TgdPainterFramebuffer(context, {\n        textureColor0: new TgdTexture2D(context),\n    })\n    const material = new Material()\n    material.texture = new TgdTexture2D(context).loadBitmap(\n        assets.image.background\n    )\n    const painter = new TgdPainterState(context, {\n        depth: webglPresetDepth.less,\n        // cull: webglPresetCull.front,\n        children: [\n            new TgdPainterClear(context, {\n                color: new TgdVec4(),\n                depth: 1,\n            }),\n            new TgdPainterMeshGltf(context, {\n                asset: assets.glb.mesh,\n                materialFactory: () => material,\n            }),\n        ],\n    })\n    framebufferRender.add(painter)\n    const copy = new TgdPainterFilter(context, {\n        filters: [\n            new TgdFilterHueRotation({\n                hueShiftInDegrees: 90,\n            }),\n        ],\n        texture: framebufferRender.textureColor0,\n    })\n    framebufferCopy.add(copy)\n    const screen = new TgdPainterFilter(context, {\n        texture: framebufferRender.textureColor0,\n        filters: [new TgdFilterZoom({ zoom: 1.1 })],\n        flipY: true,\n    })\n    framebufferRender.onExit = () => {\n        copy.texture = framebufferRender.textureColor0\n    }\n    framebufferCopy.onExit = () => {\n        material.texture = framebufferCopy.textureColor0\n        screen.texture = framebufferCopy.textureColor0\n    }\n    context.add(\n        framebufferRender,\n        framebufferCopy,\n        screen,\n        new TgdPainterLogic((time, delay) => {\n            const { camera } = context\n            camera.transfo.orbitAroundY(delay)\n        })\n    )\n    context.play()\n}\n\nexport default function Demo() {\n    return (\n        <View\n            onReady={init}\n            assets={{\n                glb: {\n                    mesh: CubeURL,\n                },\n                image: {\n                    background: BackgroundURL,\n                },\n            }}\n        />\n    )\n}\n';function x(){const[e,n]=a.useState(!1);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("div",{className:"half-left",children:(0,A.jsx)(m,{})}),(0,A.jsxs)("div",{className:"half-right",children:[(0,A.jsx)("div",{children:(0,A.jsx)(o.yQN,{variant:"elevated",onClick:()=>n(!e),children:e?"Show code details":"Show full code"})}),(0,A.jsx)(i.A,{language:"tsx",value:e?C:g})]})]})}function w(e){const n={a:"a",h1:"h1",...(0,r.R)(),...e.components};return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(n.h1,{children:[(0,A.jsx)(n.a,{href:"docs/classes/TgdPainterFramebuffer.html",children:"TgdPainterFramebuffer"})," - Example 2"]}),"\n",(0,A.jsx)(x,{})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,A.jsx)(n,{...e,children:(0,A.jsx)(w,{...e})}):w(e)}},3469:(e,n,t)=>{t.d(n,{A:()=>i});var A=t(1601),r=t.n(A),a=t(6314),o=t.n(a)()(r());o.push([e.id,".hgIjhDQIuBCJEQ4ZgLXp {\n    display: inline-block;\n    margin: 1em;\n}\n\n.hgIjhDQIuBCJEQ4ZgLXp canvas {\n    box-shadow: 0 0.25em 0.5em #fff1;\n    max-width: 100vw;\n    max-height: 100vh;\n}\n\n.efOyHCihw9wfMB6AaAqw {\n    position: relative;\n}\n\n.ywC8N0Uxbvm2Ug2DwPkE {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    background-color: var(--theme-color-primary-1);\n    opacity: 0;\n    transition: opacity 0.3s;\n}\n\n.ywC8N0Uxbvm2Ug2DwPkE.PBWSRsbiwEqGpeL0hEfm {\n    opacity: 1;\n}\n\n.BErChOLWGtciKhh3IFud {\n    position: relative;    \n}\n\n.BErChOLWGtciKhh3IFud > canvas.fT7FcYouYlPbElIAEXRP {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n}\n\n.BErChOLWGtciKhh3IFud > canvas.uAPfWt_Dhe7RaRrnmIu0 {\n    position: absolute;\n    right: 0;\n    top: 0;\n    width: 128px;\n    height: 128px;\n    box-shadow: none;\n    border: none;\n}",""]),o.locals={Tgd:"hgIjhDQIuBCJEQ4ZgLXp",relative:"efOyHCihw9wfMB6AaAqw",overlay:"ywC8N0Uxbvm2Ug2DwPkE",loading:"PBWSRsbiwEqGpeL0hEfm",screen:"BErChOLWGtciKhh3IFud",canvas:"fT7FcYouYlPbElIAEXRP",gizmo:"uAPfWt_Dhe7RaRrnmIu0"};const i=o},6989:(e,n,t)=>{t.d(n,{A:()=>T});var A=t(4848),r=t(6540),a=t(4461),o=t(5968),i=t(5670),s=t(5072),c=t.n(s),l=t(7825),d=t.n(l),u=t(7659),f=t.n(u),m=t(5056),g=t.n(m),C=t(540),x=t.n(C),w=t(1113),h=t.n(w),b=t(3469),p={};p.styleTagTransform=h(),p.setAttributes=g(),p.insert=f().bind(null,"head"),p.domAPI=d(),p.insertStyleElement=x(),c()(b.A,p);const I=b.A&&b.A.locals?b.A.locals:void 0;function T({className:e,options:n,onReady:t,gizmo:s=!1,width:c="640px",height:l="480px",noBorder:d=!1,assets:u,children:f}){const[m,g]=r.useState(!0),[C,x]=r.useState(!1),w=r.useRef(null),h=r.useRef(null),b=r.useRef(null),p=r.useRef(null),[T,v]=r.useState(!0);let y="auto";c.endsWith("px")&&l.endsWith("px")&&(c.substring(c.length-2),l.substring(l.length-2));const j=e=>{if(!e)return;if(h.current)return;h.current=e;const A=new a.tfp(e,n);w.current=A,v(!0),async function({glb:e,data:n,text:t,image:A}={}){console.log("🚀 [Tgd] glb, data, text, image = ",e,n,t,A);const r={glb:{},data:{},text:{},image:{}},o=[];return A&&Object.keys(A).forEach((e=>{o.push((async()=>{const n=A[e];console.log("Loading image:",n);const t=await(0,a.V_9)(n);t&&(r.image[e]=t)}))})),e&&Object.keys(e).forEach((n=>{o.push((async()=>{const t=e[n];console.log("Loading GLB:",t);const A=await(0,a.TCe)(t);A&&(r.glb[n]=A)}))})),n&&Object.keys(n).forEach((e=>{o.push((async()=>{const t=n[e],A=await(0,a.vSU)(t);A&&(r.data[e]=A)}))})),t&&Object.keys(t).forEach((e=>{o.push((async()=>{const n=t[e],A=await(0,a.jWq)(n);A&&(r.text[e]=A)}))})),await Promise.all(o.map((e=>e()))),r}(u).then((e=>{console.log("Ready!"),t(A,e),A.paint(),v(!1)})).catch((e=>{console.error("Unable to initialize the scene!",e),v(!1)}));const r=b.current;r&&r.attachContext(A)},P=e=>{const n=new a.GbF({canvas:e});b.current=n,n.eventTipClick.addListener((({to:e})=>{const n=w.current;console.log("🚀 [tgd] to, context =",e,n),n&&n.animSchedule({duration:.2,easingFunction:a.Wcc,action:(0,a.vRM)(n.camera,{orientation:e})})}));const t=w.current;t&&n.attachContext(t)};return r.useEffect((()=>{const e=h.current,n=w.current;if(!e||!n)return;const t=new ResizeObserver((()=>n.paint()));return t.observe(e),e.requestFullscreen||(e.requestFullscreen=e.webkitRequestFullscreen),x(Boolean(e.requestFullscreen)),()=>t.unobserve(e)}),[w.current,h.current]),d?(0,A.jsxs)("div",{ref:p,className:I.screen,style:{width:m?c:l,height:m?l:c},children:[(0,A.jsx)("canvas",{className:I.canvas,ref:j}),s&&(0,A.jsx)("canvas",{className:I.gizmo,ref:P})]}):(0,A.jsxs)("div",{className:o.Sxu.classNames.join(e,I.Tgd),children:[(0,A.jsxs)(o.sWC,{display:"flex",justifyContent:"space-between",children:[(0,A.jsx)(o.yQN,{variant:"elevated",onClick:()=>g(!m),enabled:!T,children:m?"Switch to Portrait":"Switch to Landscape"}),C&&(0,A.jsx)(o.yQN,{variant:"elevated",onClick:()=>{const e=p.current;e&&e.requestFullscreen()},enabled:!T,children:"Fullscreen"})]}),(0,A.jsxs)("div",{className:I.relative,children:[(0,A.jsxs)("div",{ref:p,className:I.screen,style:{width:m?c:l,height:m?l:c},children:[(0,A.jsx)("canvas",{className:I.canvas,ref:j}),s&&(0,A.jsx)("canvas",{className:I.gizmo,ref:P})]}),(0,A.jsx)("div",{className:o.Sxu.classNames.join(I.overlay,T&&I.loading),children:(0,A.jsx)(i.A,{})}),f]})]})}},4859:(e,n,t)=>{e.exports=t.p+"img/dino.a892a1760dcaac9618a1.webp"},8453:(e,n,t)=>{t.d(n,{R:()=>a});var A=t(6540);const r=A.createContext({});function a(e){const n=A.useContext(r);return A.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}}}]);