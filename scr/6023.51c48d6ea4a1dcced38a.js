"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[6023],{1839:e=>{e.exports="data:model/gltf-binary;base64,Z2xURgIAAADABgAAXAMAAEpTT057ImFzc2V0Ijp7ImdlbmVyYXRvciI6Iktocm9ub3MgZ2xURiBCbGVuZGVyIEkvTyB2NC4zLjQ3IiwidmVyc2lvbiI6IjIuMCJ9LCJzY2VuZSI6MCwic2NlbmVzIjpbeyJuYW1lIjoiU2NlbmUiLCJub2RlcyI6WzBdfV0sIm5vZGVzIjpbeyJtZXNoIjowLCJuYW1lIjoiQ3ViZSJ9XSwibWVzaGVzIjpbeyJuYW1lIjoiQ3ViZSIsInByaW1pdGl2ZXMiOlt7ImF0dHJpYnV0ZXMiOnsiUE9TSVRJT04iOjAsIk5PUk1BTCI6MSwiVEVYQ09PUkRfMCI6Mn0sImluZGljZXMiOjN9XX1dLCJhY2Nlc3NvcnMiOlt7ImJ1ZmZlclZpZXciOjAsImNvbXBvbmVudFR5cGUiOjUxMjYsImNvdW50IjoyNCwibWF4IjpbMSwxLDFdLCJtaW4iOlstMSwtMSwtMV0sInR5cGUiOiJWRUMzIn0seyJidWZmZXJWaWV3IjoxLCJjb21wb25lbnRUeXBlIjo1MTI2LCJjb3VudCI6MjQsInR5cGUiOiJWRUMzIn0seyJidWZmZXJWaWV3IjoyLCJjb21wb25lbnRUeXBlIjo1MTI2LCJjb3VudCI6MjQsInR5cGUiOiJWRUMyIn0seyJidWZmZXJWaWV3IjozLCJjb21wb25lbnRUeXBlIjo1MTIzLCJjb3VudCI6MzYsInR5cGUiOiJTQ0FMQVIifV0sImJ1ZmZlclZpZXdzIjpbeyJidWZmZXIiOjAsImJ5dGVMZW5ndGgiOjI4OCwiYnl0ZU9mZnNldCI6MCwidGFyZ2V0IjozNDk2Mn0seyJidWZmZXIiOjAsImJ5dGVMZW5ndGgiOjI4OCwiYnl0ZU9mZnNldCI6Mjg4LCJ0YXJnZXQiOjM0OTYyfSx7ImJ1ZmZlciI6MCwiYnl0ZUxlbmd0aCI6MTkyLCJieXRlT2Zmc2V0Ijo1NzYsInRhcmdldCI6MzQ5NjJ9LHsiYnVmZmVyIjowLCJieXRlTGVuZ3RoIjo3MiwiYnl0ZU9mZnNldCI6NzY4LCJ0YXJnZXQiOjM0OTYzfV0sImJ1ZmZlcnMiOlt7ImJ5dGVMZW5ndGgiOjg0MH1dfUgDAABCSU4AAACAPwAAgD8AAIA/AACAPwAAgD8AAIA/AACAPwAAgD8AAIA/AACAPwAAgD8AAIC/AACAPwAAgD8AAIC/AACAPwAAgD8AAIC/AACAPwAAgL8AAIA/AACAPwAAgL8AAIA/AACAPwAAgL8AAIA/AACAPwAAgL8AAIC/AACAPwAAgL8AAIC/AACAPwAAgL8AAIC/AACAvwAAgD8AAIA/AACAvwAAgD8AAIA/AACAvwAAgD8AAIA/AACAvwAAgD8AAIC/AACAvwAAgD8AAIC/AACAvwAAgD8AAIC/AACAvwAAgL8AAIA/AACAvwAAgL8AAIA/AACAvwAAgL8AAIA/AACAvwAAgL8AAIC/AACAvwAAgL8AAIC/AACAvwAAgL8AAIC/AAAAAAAAAAAAAIA/AAAAAAAAgD8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgD8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgL8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgL8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgD8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgD8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgL8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgL8AAAAAAACAvwAAAAAAAAAAuth/P7nYfz+22H8/uth/P7XYfz+52H8/uNh/P7nYfz+22H8/ACQdOgASHTq42H8/ACAdOrjYfz+42H8/uth/P7jYfz8AKB06uth/PwAcHToAHB06udh/PwAYHToAHB06uth/PwAoHToAFh06uth/P7bYfz+52H8/ACAdOrbYfz8AIh06ACQdOrrYfz8AKB06ACYdOgAcHTq62H8/ACgdOgAgHTq52H8/ACgdOgAQHToAIB06ABwdOgAgHToAKB06AAAMABIAAAASAAYACgAHABMACgATABYAFwAUAA4AFwAOABEADwADAAkADwAJABUABQACAAgABQAIAAsAEAANAAEAEAABAAQA"},2197:(e,n,t)=>{function a(e){return!!e&&!Array.isArray(e)&&"object"==typeof e}function s(e){return"number"==typeof e}function r(e,n,t=null){try{return i(e,n),!0}catch(n){return t&&(console.error("[Invalid type]",t),console.error(e),console.debug(n)),!1}}function i(e,n,t="data"){if("function"==typeof n)return i(e,n(),t);if("unknown"===n)return;if("null"===n){if(null!==e)throw console.log("ðŸš€ [index] data = ",e,typeof e),Error(`Expected ${t} to be a null and not a ${l(e)}!`);return}if("string"==typeof n){if(typeof e!==n)throw Error(`Expected ${t} to be a ${n} and not a ${l(e)}!`);return}if(Array.isArray(n)){const[r]=n;switch(r){case"array":return void function(e,n,t){if(!Array.isArray(e))throw Error(`Expected ${n} to be an array and not a ${l(e)}!`);const[,a,r]=t;if(r){const t=e.length;if(s(r)){if(t!==r)throw Error(`Expected ${n}'s length to be ${r} and not ${t}!`)}else{const{min:e,max:a}=r;if(s(e)&&t<e)throw Error(`Expected ${n}'s MIN length to be ${e} and not ${t}!`);if(s(a)&&t>a)throw Error(`Expected ${n}'s MAX length to be ${a} and not ${t}!`)}}for(let t=0;t<e.length;t+=1)i(e[t],a,`${n}[${t}]`)}(e,t,n);case"map":return void function(e,n,t){if(!a(e))throw Error(`Expected ${n} to be an object and not a ${l(e)}!`);const[,s]=t;for(const t of Object.keys(e))"string"==typeof t&&i(e[t],s,`${n}[${t}]`)}(e,t,n);case"?":return void function(e,n,t){if(void 0===e)return;const[,a]=t;i(e,a,n)}(e,t,n);case"|":return void function(e,n,t){const[,...a]=t;if(0===a.length)throw Error(`No type has been defined for this alternative: ${JSON.stringify(t)}!`);const s=[];for(const t of a)try{return void i(e,t,n)}catch(e){e instanceof Error&&s.push(e)}throw new Error(`All alternatives failed!${s.map((e=>`\n${e.message}`))}`)}(e,t,n);case"tuple":return void o(e,t,n);case"tuple...":return void function(e,n,[,...t]){const a=t.length-1;o(e,n,["tuple",...t.slice(0,a)]);const s=t[a];for(let t=a;t<e.length;t++)i(e[t],s,`${n}[${t}]`)}(e,t,n);case"partial":return void function(e,n,[,t]){!function(e,n="data"){if(!a(e))throw Error(`${n} was expected to be an object but we got ${typeof e}!`)}(e,n);for(const a of Object.keys(t)){if("string"!=typeof a)continue;const s=e[a];void 0!==s&&i(s,t[a],`${n}.${a}`)}}(e,t,n);case"literal":return void function(e,n,t){const[,...a]=t;for(const n of a)if(e===n)return;throw Error(`Expected ${n} to be a literal (${a.map((e=>`"${e}"`)).join(" | ")}) and not a ${l(e)}!`)}(e,t,n);case"custom":return void function(e,n,[,t]){if(!t(e))throw Error(`Expected ${t.name}(${n}) to return true!`)}(e,t,n);default:throw Error(`Don't know how to create a type guard for this kind of type: ${JSON.stringify(n)}`)}}if("object"!=typeof e)throw Error(`Expected ${t} to be an object and not a ${l(e)}!`);const r=e;for(const e of Object.keys(n))"string"==typeof e&&i(r[e],n[e],`${t}.${e}`)}function o(e,n,[,...t]){if(function(e,n="data"){if(!Array.isArray(e))throw Error(`${n} was expected to be an Array but we got ${typeof e}!`)}(e),t.length>e.length)throw Error(`Expected ${n}'s length to be at least ${t.length} and not ${e.length}!`);for(let a=0;a<t.length;a++){const s=t[a];i(e[a],s,`${n}[${a}]`)}}function c(e,n){return function(e,n,t){return r(e,n)?e:r(t,n)?t:t(e)}(e,"number",n)}function l(e){var n;return null===e?"null":"function"==typeof e?`function ${null!==(n=e.name)&&void 0!==n?n:""}()`:typeof e}t.d(n,{Et:()=>s,GB:()=>c,Xj:()=>r,j:()=>i})},7289:(e,n,t)=>{t.d(n,{A:()=>l});var a=t(4848),s=t(6540),r=t(1151),i=t(7402),o=t(3686);const c={Tgd:"hgIjhDQIuBCJEQ4ZgLXp",relative:"efOyHCihw9wfMB6AaAqw",overlay:"ywC8N0Uxbvm2Ug2DwPkE",loading:"PBWSRsbiwEqGpeL0hEfm",screen:"BErChOLWGtciKhh3IFud",canvas:"fT7FcYouYlPbElIAEXRP",gizmo:"uAPfWt_Dhe7RaRrnmIu0",actions:"Ia9jfUO3OevcIh2fV6R6",enabled:"dZYZScZBbWV2Pm3ftXcG"};function l({className:e,options:n,onReady:t,gizmo:l=!1,width:A="640px",height:d="480px",noBorder:u=!1,assets:h,children:m}){const[f,x]=s.useState(!0),[g,j]=s.useState(!1),p=s.useRef(null),b=s.useRef(null),y=s.useRef(null),w=s.useRef(null),[v,C]=s.useState(!0);let N="auto";A.endsWith("px")&&d.endsWith("px")&&(A.substring(A.length-2),d.substring(d.length-2));const I=e=>{if(!e)return;if(b.current)return;b.current=e;const a=new r.TgdContext(e,n),s=a.gl.getParameter(a.gl.DEPTH_BITS);console.log("Depht buffer bits:",s),p.current=a,C(!0),async function({glb:e,data:n,text:t,image:a}={}){console.log("ðŸš€ [Tgd] glb, data, text, image = ",e,n,t,a);const s={glb:{},data:{},text:{},image:{}},i=[];return a&&Object.keys(a).forEach((e=>{i.push((async()=>{const n=a[e];console.log("Loading image:",n);const t=await(0,r.tgdLoadImage)(n);t&&(s.image[e]=t)}))})),e&&Object.keys(e).forEach((n=>{i.push((async()=>{const t=e[n];console.log("Loading GLB:",t);const a=await(0,r.tgdLoadGlb)(t);a&&(s.glb[n]=a)}))})),n&&Object.keys(n).forEach((e=>{i.push((async()=>{const t=n[e],a=await(0,r.tgdLoadArrayBuffer)(t);a&&(s.data[e]=a)}))})),t&&Object.keys(t).forEach((e=>{i.push((async()=>{const n=t[e],a=await(0,r.tgdLoadText)(n);a&&(s.text[e]=a)}))})),await Promise.all(i.map((e=>e()))),s}(h).then((e=>{console.log("Ready!"),t(a,e),a.paint(),C(!1)})).catch((e=>{console.error("Unable to initialize the scene!",e),C(!1)}));const i=y.current;i&&i.attachContext(a)},T=e=>{const n=new r.TgdCanvasGizmo({canvas:e});y.current=n,n.eventTipClick.addListener((({to:e})=>{const n=p.current;n&&n.animSchedule({duration:.2,easingFunction:r.tgdEasingFunctionInOutCubic,action:(0,r.tgdActionCreateCameraInterpolation)(n.camera,{orientation:e})})}));const t=p.current;t&&n.attachContext(t)};return s.useEffect((()=>{const e=b.current,n=p.current;if(!e||!n)return;const t=new ResizeObserver((()=>n.paint()));return t.observe(e),e.requestFullscreen||(e.requestFullscreen=e.webkitRequestFullscreen),j(Boolean(e.requestFullscreen)),()=>t.unobserve(e)}),[p.current,b.current]),u?(0,a.jsxs)("div",{ref:w,className:c.screen,style:{width:f?A:d,height:f?d:A},children:[(0,a.jsx)("canvas",{className:c.canvas,ref:I}),l&&(0,a.jsx)("canvas",{className:c.gizmo,ref:T})]}):(0,a.jsxs)("div",{className:i.Sxu.classNames.join(e,c.Tgd),children:[(0,a.jsxs)("div",{className:i.Sxu.classNames.join(c.actions,!v&&c.enabled),children:[(0,a.jsx)("div",{children:(0,a.jsx)(i.I64,{onClick:()=>x(!f)})}),(0,a.jsx)("div",{children:(0,a.jsx)(i.kRc,{onClick:()=>{const e=p.current;e&&e.takeSnapshot().then((e=>{const n=document.createElement("a");document.body.appendChild(n),n.style.display="none",n.href=e.src,n.download="snapshot.png",n.click(),window.setTimeout((()=>document.body.removeChild(n)),3e4)}))}})}),g&&(0,a.jsx)("div",{children:(0,a.jsx)(i.L9n,{onClick:()=>{const e=w.current;e&&e.requestFullscreen()}})})]}),(0,a.jsxs)("div",{className:c.relative,children:[(0,a.jsxs)("div",{ref:w,className:c.screen,style:{width:f?A:d,height:f?d:A},children:[(0,a.jsx)("canvas",{className:c.canvas,ref:I}),l&&(0,a.jsx)("canvas",{className:c.gizmo,ref:T})]}),(0,a.jsx)("div",{className:i.Sxu.classNames.join(c.overlay,v&&c.loading),children:(0,a.jsx)(o.A,{})}),m]})]})}},9396:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Ve});var a=t(4848),s=t(6540),r=t(7402);const i={gltfTree:"XPMLtzXBRVSrxv_Xe50A"};var o=t(2197);function c(e){return(0,o.Xj)(e,{camera:"number"})}const l={node:"NDcVYWtiNdLrATykGHx3"},A={expander:"V3aob0pLE9HcHxN5iVyj",handle:"PbWyyuXizmAAIbcs5urg"},d=r.Sxu.classNames;function u(e){const[n,t]=s.useState(!1),i={...(0,r.$qi)(e),...e.style},o=e.icon;return(0,a.jsxs)("details",{className:d.join(e.className,A.expander),style:i,onToggle:a=>{a.preventDefault(),a.stopPropagation(),t(!n),e.onClick?.()},onClick:e.children?void 0:n=>{n.preventDefault(),n.stopPropagation(),e.onClick?.()},name:e.name,children:[(0,a.jsxs)("summary",{children:[(0,a.jsx)("div",{className:A.handle,children:e.children?n?(0,a.jsx)(r.vpi,{size:"1em"}):(0,a.jsx)(r.DF0,{size:"1em"}):(0,a.jsx)(r.Sg,{size:"1em"})}),o&&(0,a.jsx)(o,{color:"primary-7"}),(0,a.jsx)("span",{children:e.title})]}),(0,a.jsx)("div",{children:e.children})]})}const h=r.Sxu.classNames;function m(e){const n={...(0,r.$qi)(e)},t=e.data.json.nodes?.[e.index];if(!t)return null;const s=t.name??`#${e.index}`,i=function(e){return c(e)?r.PEB:(n=e,(0,o.Xj)(n,{mesh:"number"})?r.Td5:function(e){return(0,o.Xj)(e,{extensions:{KHR_lights_punctual:{light:"number"}}})}(e)?r.H3I:Array.isArray(e.children)?r.MRx:r.dlJ);var n}(t);return(0,a.jsx)(u,{className:h.join(e.className,l.node),name:e.name,style:n,title:s,onClick:()=>{e.onAction?.({type:"node",index:e.index})},icon:i,children:Array.isArray(t.children)&&t.children.map((n=>(0,a.jsx)(m,{data:e.data,index:n,onAction:e.onAction},`#${n}`)))})}function f(e){const{nodes:n}=e.data.json;return n?(0,a.jsx)(u,{title:"Nodes",icon:r.MRx,children:n.map(((n,t)=>(0,a.jsx)(m,{data:e.data,index:t,onAction:e.onAction},`#${t}`)))}):(0,a.jsx)("p",{children:"No nodes."})}r.Sxu.classNames;const x={images:"o4_1rbAB9XmGcjjHG22H"},g=r.Sxu.classNames;function j({className:e,data:n,onAction:t}){return(0,a.jsx)(u,{className:g.join(e,x.images),icon:r.dwH,title:"Images",children:(n.json.images??[]).map(((e,n)=>(0,a.jsx)(u,{title:e.name??`#${n}`,onClick:()=>t?.({type:"image",index:n}),children:(0,a.jsxs)("ul",{children:[e.name&&(0,a.jsxs)("li",{children:["Name: ",(0,a.jsx)("b",{children:e.name})]}),e.mimeType&&(0,a.jsxs)("li",{children:["Mime type: ",(0,a.jsx)("b",{children:e.mimeType})]}),e.bufferView&&(0,a.jsxs)("li",{children:["Buffer view: ",(0,a.jsx)("b",{children:e.bufferView})]}),e.uri&&(0,a.jsxs)("li",{children:["URI: ",(0,a.jsx)("b",{children:e.uri})]})]})},n)))})}const p={lights:"G3CJ6oAzpvDypk53NREK"},b=r.Sxu.classNames;function y({className:e,data:n,onAction:t}){return(0,a.jsx)(u,{className:b.join(e,p.images),title:"Lights",icon:r.H3I})}function w({data:e,scene:n,title:t,index:s,onAction:i}){return(0,a.jsx)(u,{title:t,icon:r.GtP,onClick:()=>{i?.({index:s,type:"scene"})},children:(n.nodes??[]).map(((n,t)=>(0,a.jsx)(m,{data:e,index:t,onAction:i},`node#${t}`)))})}function v(e){const{scenes:n}=e.data.json;return n?(0,a.jsx)(u,{title:"Scenes",icon:r.GtP,children:n.map(((n,t)=>(0,a.jsx)(w,{data:e.data,scene:n,title:n.name??`Scene #${t}`,index:t,onAction:e.onAction},`Scene#${t}`)))}):(0,a.jsx)("p",{children:"No scenes."})}r.Sxu.classNames,r.Sxu.classNames;const C=r.Sxu.classNames;function N(e){const n={...(0,r.$qi)(e)};return(0,a.jsxs)("div",{className:C.join(e.className,i.gltfTree),style:n,children:[(0,a.jsx)(r.yQN,{variant:"text",color:"secondary-5",fullwidth:!0,onClick:(t={type:"verbatim"},()=>e.onAction(t)),children:"Show verbatim content"}),(0,a.jsx)(v,{data:e.data,onAction:e.onAction}),(0,a.jsx)(f,{data:e.data,onAction:e.onAction}),(0,a.jsx)(j,{data:e.data,onAction:e.onAction}),(0,a.jsx)(y,{data:e.data,onAction:e.onAction}),(0,a.jsx)("hr",{}),(0,a.jsx)("a",{href:"https://registry.khronos.org/glTF/specs/2.0/glTF-2.0.html",children:"GLTF 2.0 Specification"})]});var t}var I=t(1151),T=t(1839);const S={action:"TivnAbABYZdpWW9GZs6n"},M={verbatin:"EOCnuXPaVAQQjOaVzDWk"},$={json:"xo2OgnX2_m3zlxXV2j9k"},k=r.Sxu.classNames;function O(e){const n={...(0,r.$qi)(e)},{value:t}=e;return(0,a.jsxs)("div",{className:k.join(e.className,$.json),style:n,children:[(0,a.jsx)("pre",{children:JSON.stringify(t,E,2)}),(0,a.jsx)(r.yQN,{variant:"outlined",onClick:()=>console.log(t),children:"Write to console"})]})}function E(e,n){return n instanceof Uint8Array?`<<< Uint8Array( ${n.length} ) >>>`:n instanceof Int8Array?`<<< Int8Array( ${n.length} ) >>>`:n instanceof Uint8ClampedArray?`<<< Uint8ClampedArray( ${n.length} ) >>>`:n instanceof Uint16Array?`<<< Uint16Array( ${n.length} ) >>>`:n instanceof Int16Array?`<<< Int16Array( ${n.length} ) >>>`:n instanceof Uint32Array?`<<< Uint32Array( ${n.length} ) >>>`:n instanceof Int32Array?`<<< Int32Array( ${n.length} ) >>>`:n instanceof Float16Array?`<<< Float16Array( ${n.length} ) >>>`:n instanceof Float32Array?`<<< Float32Array( ${n.length} ) >>>`:n}const L=r.Sxu.classNames;function V(e){return(0,a.jsx)(r.sWC,{className:L.join(e.className,M.verbatin),overflow:"auto",fullsize:!0,color:"neutral-1",padding:"S",children:(0,a.jsx)(O,{value:e.data})})}var Z=t(9074);const P={actionNodeTransfo:"YXMiTxYNCxTJZifDB0En"},W=r.Sxu.classNames;function B(e){const n={...(0,r.$qi)(e)},t=["const transfo = new TgdTransfo({"];var s;return J(e.node.translation)&&t.push(`  position: [${e.node.translation.join(", ")}],`),s=e.node.rotation,(0,o.Xj)(s,["array","number",{min:4,max:4}])&&t.push(`  orientation: [${e.node.rotation.join(", ")}],`),J(e.node.scale)&&t.push(`  position: [${e.node.scale.join(", ")}],`),t.push("})"),(0,a.jsx)("div",{className:W.join(e.className,P.actionNodeTransfo),style:n,children:(0,a.jsx)(Z.A,{language:"ts",value:t.join("\n")})})}function J(e){return(0,o.Xj)(e,["array","number",{min:3,max:3}])}const z={Error:"H0UnrqUJgmcVuhNY9Flo"},R=r.Sxu.classNames;function G({className:e,children:n}){return(0,a.jsx)("div",{className:R.join(e,z.Error),children:n})}const U={actionNodeCamera:"H9dDNSbXjsX6jN3Bf3xh"},D=r.Sxu.classNames;function X(e){const n={...(0,r.$qi)(e)},t=e.data.json.cameras?.[e.node.camera??-1];if(!t)return(0,a.jsx)(G,{children:"No camera found!"});const s=function(e,n){const t=[];return(0,I.isTgdFormatGltfCameraPerspective)(n)&&(t.push("const camera = new TgdCameraPerspective({",`  fovy: ${n.perspective.yfov},  // around ${Math.round((0,I.tgdCalcRadToDeg)(n.perspective.yfov))}Â°`,`  near: ${(0,o.GB)(n.perspective.znear,.001)}`,`  far: ${n.perspective.zfar??"Infinity"}`,"  transfo: {","    distrance: 0,"),e.translation&&t.push(`    position: [${e.translation.join(", ")}],`),e.rotation&&t.push(`    orientation: [${e.rotation.join(", ")}],`),e.scale&&t.push(`    scale: [${e.scale.join(", ")}],`),t.push("  }","})")),t.join("\n")}(e.node,t);return(0,a.jsx)("div",{className:D.join(e.className,U.actionNodeCamera),style:n,children:(0,a.jsx)(Z.A,{language:"ts",value:s})})}const H={actionNode:"FHDDVaFyhGXfoGBta3yQ"},Y={actionNodeRender:"WlQP8S7OoKQ5p9KJGWab"};var F=t(7289);function Q({data:e,node:n}){const t=function(e,n){return s.useCallback((t=>{const a=q(e,n);t.camera.transfo.position=a.center,t.camera.transfo.distance=2*a.radius,t.camera.far=5*a.radius,t.camera.near=1,new I.TgdControllerCameraOrbit(t,{inertiaOrbit:1e3,speedZoom:.25*a.radius});const s=new I.TgdPainterClear(t,{color:[.2,.2,.2,1],depth:1}),{painter:r}=(0,I.tgdMakeMeshGlbPainter)({data:e,node:n,context:t});r.debug("nodePainter");const i=new I.TgdPainterState(t,{depth:I.webglPresetDepth.lessOrEqual,children:[r]});t.add(s,i),t.paint()}),[e,n])}(e,n);return(0,a.jsx)("div",{className:Y.actionNodeRender,children:(0,a.jsx)(F.A,{onReady:t,width:"100%",height:"100%",gizmo:!0,noBorder:!0},JSON.stringify(n))})}function q(e,n){const t=[];(0,o.Et)(n.mesh)&&t.push(K(function(e,n){const t=e.getMesh(n);if(!t)return[{center:new I.TgdVec3,radius:1}];const a=[];for(const n of t.primitives){const t=e.getAccessorByAttributeName(n,"POSITION");if(_(t.min)&&_(t.max)){const[e,n,s]=t.min,[r,i,o]=t.max;a.push({center:I.TgdVec3.newFromMix(t.min,t.max),radius:Math.max(Math.abs(r-e),Math.abs(i-n),Math.abs(o-s))})}}return a}(e,n.mesh)));for(const a of n.children??[]){const n=e.getNode(a);t.push(q(e,n))}return function(e,n){const[t,a,s]=e.center,r=new I.TgdVec4(t,a,s,1),i={};n.translation&&(i.position=n.translation),n.rotation&&(i.orientation=n.rotation),n.scale&&(i.scale=n.scale);const o=new I.TgdTransfo(i);r.applyMatrix(o.matrix);const[c,l,A]=o.scale,d=Math.max(c,l,A);return{center:new I.TgdVec3(r.x,r.y,r.z),radius:e.radius*d}}(K(t),n)}function _(e){return(0,o.Xj)(e,["array","number",{min:3,max:3}])}function K(e){if(0===e.length)return{center:new I.TgdVec3,radius:1};let n=0,t=0,a=0;for(const{center:s}of e){const[e,r,i]=s;n+=e,t+=r,a+=i}const s=e.length;n/=s,t/=s,a/=s;const r=new I.TgdVec3(n,t,a);let i=0;for(const{center:n,radius:t}of e)i=Math.max(i,t+I.TgdVec3.distance(r,new I.TgdVec3(n)));return{center:r,radius:i}}r.Sxu.classNames;const ee={actionNodeMesh:"p9Kbtkuegy0iOh66GNDX"},ne={value:"n8pRiWUyv_1Af5HOwG4n"},te=r.Sxu.classNames;function ae(e){const n={...(0,r.$qi)(e)},{value:t,label:s,lookup:i=!1}=e;return(0,o.Et)(t)&&i?(0,a.jsxs)("div",{className:te.join(e.className,ne.value),style:n,children:[s&&(0,a.jsxs)("label",{children:[s,":"]}),(0,a.jsxs)("div",{children:["gl.",(0,a.jsx)("b",{children:(0,I.webglLookup)(t)})]})]}):(0,a.jsxs)("div",{className:te.join(e.className,ne.value),style:n,children:[s&&(0,a.jsxs)("label",{children:[s,":"]}),(0,a.jsx)(se,{value:t})]})}function se({value:e}){return void 0===e?(0,a.jsx)("em",{children:"undefined"}):null===e?(0,a.jsx)("em",{children:"null"}):(0,a.jsx)("b",{children:JSON.stringify(e)})}const re={accessor:"NNZXZp9wvxpD6763MYUF"},ie={data:"ae9NgxUT0l3kQ0p7fMhd",grid:"hL8SKLHUfwy3P4rI8vII",row:"bZX5lLCGfnCnr1Nzua0X"},oe=r.Sxu.classNames;function ce({className:e,buffer:n,type:t,componentType:s,onClose:i}){const o=function(e,n){switch(n){case WebGL2RenderingContext.FLOAT:return new Float32Array(e);case WebGL2RenderingContext.HALF_FLOAT:return new Float16Array(e);case WebGL2RenderingContext.HIGH_FLOAT:return new Float64Array(e);case WebGL2RenderingContext.UNSIGNED_BYTE:return new Uint8Array(e);case WebGL2RenderingContext.UNSIGNED_SHORT:return new Uint16Array(e);case WebGL2RenderingContext.UNSIGNED_INT:return new Uint32Array(e);default:throw new Error(`Don't know how to interpret ${(0,I.webglLookup)(n)}!`)}}(n,s),c=le(function(e){switch(e.toLowerCase()){case"float":case"scalar":default:return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4}}(t)),l=le(Math.ceil(o.length/c.length));return(0,a.jsxs)(r.UkC,{className:oe.join(e,ie.data),template:"*1",children:[(0,a.jsxs)(r.sWC,{color:"primary-5",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"M",padding:"S",children:[(0,a.jsxs)("div",{children:["Attributes: ",(0,a.jsx)("b",{children:l.length})]}),(0,a.jsx)("div",{children:t}),(0,a.jsxs)("div",{children:["gl.",(0,I.webglLookup)(s)]}),(0,a.jsx)(r.gzW,{onClick:i})]}),(0,a.jsx)(r.sWC,{overflow:"auto",color:"neutral-1",padding:"S",children:(0,a.jsx)("div",{className:ie.grid,style:{"--custom-columns":c.length},children:l.slice(0,100).map((e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:ie.row,children:e},`${e}`),c.map((n=>(0,a.jsx)("div",{children:o[n+e*c.length]},`${e}/${n}`)))]})))})})]})}function le(e){const n=new Array(e);for(let t=0;t<e;t++)n[t]=t;return n}const Ae=r.Sxu.classNames;function de(e){const n=s.useRef(null),[t,i]=s.useState(!1);s.useEffect((()=>{const e=n.current;e&&(t?e.showModal():e.close())}),[t]);const c={...(0,r.$qi)(e)},{data:l,index:A}=e,d=l.getAccessor(A);return(0,a.jsxs)(u,{className:Ae.join(e.className,re.accessor),style:c,title:`Accessor #${A}`,children:[(0,a.jsx)(ae,{label:"name",value:d.name}),(0,a.jsx)(ae,{label:"type",value:d.type}),(0,a.jsx)(ae,{label:"componentType",value:d.componentType,lookup:!0}),(0,a.jsx)(ae,{label:"count",value:d.count}),(0,a.jsx)(ae,{label:"bufferView",value:d.bufferView}),(0,a.jsx)(ae,{label:"byteOffset",value:d.byteOffset}),(0,a.jsx)(ae,{label:"normalized",value:d.normalized}),(0,a.jsx)(ae,{label:"min",value:d.min}),(0,a.jsx)(ae,{label:"max",value:d.max}),(0,o.Et)(d.bufferView)&&(0,a.jsx)(r.yQN,{variant:"outlined",onClick:()=>i(!0),children:"Show data"}),(0,a.jsx)("dialog",{ref:n,children:t&&(0,a.jsx)(r.sWC,{children:(0,a.jsx)(ce,{buffer:l.getBufferViewData(d),type:d.type,componentType:d.componentType,onClose:()=>i(!1)})})})]})}const ue=r.Sxu.classNames;function he({className:e,data:n,meshIndex:t}){const s=n.getMesh(t);return s?(0,a.jsx)("div",{className:ue.join(e,ee.actionNodeMesh),children:(0,a.jsx)("ul",{children:s.primitives.map(((e,t)=>(0,a.jsxs)("li",{children:[(0,a.jsxs)("b",{children:["Primitive ",t]}),(0,a.jsx)(u,{title:"Attributes",children:Object.keys(e.attributes).map((t=>{const s=e.attributes[t];return(0,a.jsx)(u,{title:t,children:(0,o.Et)(s)?(0,a.jsx)(de,{data:n,index:s}):(0,a.jsx)(O,{value:s})},t)}))}),(0,a.jsxs)(u,{title:"Indices",children:[e.indices&&((0,o.Et)(e.indices)?(0,a.jsx)(de,{data:n,index:e.indices}):(0,a.jsx)(O,{value:e.indices})),!e.indices&&(0,a.jsx)("div",{children:"No indices..."})]}),(e.material??-1)>-1&&(0,a.jsx)(u,{title:(0,a.jsxs)("div",{children:["Material"," ",(0,a.jsx)("b",{children:n.getMaterial(e.material??-1)?.name??"Material"})]}),children:(0,o.Et)(e.material)&&(0,a.jsx)(O,{value:n.getMaterial(e.material)})}),(0,a.jsx)(u,{title:"Verbatim",children:(0,a.jsx)(O,{value:s})})]},t)))})}):(0,a.jsxs)(G,{children:["No mesh found with index #",t,"!"]})}const me=r.Sxu.classNames;function fe(e){const n={...(0,r.$qi)(e)},t=e.data.json.nodes?.[e.index];return t?(0,a.jsxs)(r.UkC,{orientation:"column",template:"-1",className:me.join(e.className,H.actionNode),fullsize:!0,children:[(0,a.jsx)(r.sWC,{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"M",color:"primary-5",padding:"S",children:(0,a.jsxs)("div",{children:["Node #",e.index,":"," ",(0,a.jsx)("b",{children:t.name??(0,a.jsx)("em",{children:"anonymous"})})]})}),(0,a.jsx)(r.sWC,{style:n,children:(0,a.jsxs)(r.WET,{fullsize:!0,children:[(0,a.jsx)(r.Zdo,{label:"3D View",children:!c(t)&&(0,a.jsx)(Q,{data:e.data,node:t})},"render"),(0,a.jsx)(r.Zdo,{label:"Camera",children:c(t)&&(0,a.jsx)(X,{data:e.data,node:t})},"camera"),(0,a.jsx)(r.Zdo,{label:"Transformation",children:(0,a.jsx)(B,{node:t})},"transfo"),(0,a.jsx)(r.Zdo,{label:"Mesh",children:(0,o.Et)(t.mesh)&&(0,a.jsx)(he,{data:e.data,meshIndex:t.mesh})},"mesh"),(0,a.jsx)(r.Zdo,{label:"Verbatim",children:(0,a.jsx)("pre",{children:JSON.stringify(t,null,"  ")})},"verbatim")]})})]}):null}const xe={fileSize:"MKULJkv5mj0S_xY8htf8",bytes:"F7WZfPxY1S7i0Hjtucc7",Kb:"D9DRrGtnrbf1nOgNQWyG",Mb:"h0ieIogaTKV3gw0BUni6"},ge=r.Sxu.classNames;function je(e){const n={...(0,r.$qi)(e)},[t,s]=(i=e.value)<1024?[i,"bytes"]:i<1048576?[i/1024,"Kb"]:[i/1048576,"Mb"];var i;return(0,a.jsxs)("div",{className:ge.join(e.className,xe.fileSize,xe[s]),style:n,children:[Math.round(t)," ",s]})}const pe=t.p+"img/checkboard-light.a7a1229bc8b42ce5b9d3.jpg",be=t.p+"img/checkboard-dark.9d3dacc5286db0915472.jpg",ye={actionImage:"C9I4sL1N2ssiuRkPggbA",dimensions:"v6mssTjMLNc8Ogj4uBSq",link:"lHntNRydftoMSCTh5gwv",mimeType:"Z3MostVbq5he_JIIndWa"},we=r.Sxu.classNames;function ve({data:e,index:n}){const[t,i]=s.useState("light"),[o,c]=s.useState(null),[l,A]=s.useState(null),[d,u]=s.useState(void 0),h=function(e,n){return s.useMemo((()=>{if(!n)return 0;const t=e.getBufferView(n.bufferView??-1);return t?t.byteLength:0}),[e,n])}(e,d),[m,f]=s.useState(null),x=s.useCallback(((t,a)=>{f(null);const s=new I.TgdPainterClear(t,{color:[0,0,0,0]});t.add(s),t.paint(),u(e.getImage(n));const r=e.getImageAsHTMLElement(n);if(!r)return;c(r),A([r.width,r.height]);const i=new I.TgdTexture2D(t).loadBitmap(r),o=new I.TgdPainterBackground(t,{mode:"contain",texture:i});t.add(o),t.paint()}),[e,n]);return(0,a.jsxs)("div",{className:we.join(ye.actionImage),style:{backgroundImage:`url(${"dark"===t?be:pe})`},children:[m?(0,a.jsx)(G,{children:m}):(0,a.jsx)(F.A,{options:{alpha:!0},onReady:x,noBorder:!0,width:"100%",height:"100%"},JSON.stringify(e.getImage(n))),(0,a.jsxs)("header",{children:[(0,a.jsx)("div",{className:ye.dimensions,children:l?.join(" Ã— ")}),h>0&&(0,a.jsx)(je,{value:h}),d&&(0,a.jsx)("div",{className:ye.mimeType,children:d.mimeType}),(0,a.jsxs)(r.si8,{value:t,onChange:i,children:[(0,a.jsx)("div",{children:"Light"},"light"),(0,a.jsx)("div",{children:"Dark"},"dark")]}),(0,a.jsx)("div",{className:ye.link,children:o&&(0,a.jsx)("a",{href:o.src,target:"_blank",children:"Open in new tab"})})]})]})}const Ce={actionScene:"IUOTuyuq_tmmW8h_lBpp"},Ne=r.Sxu.classNames;function Ie({data:e,index:n}){const t=e.json.scenes?.[n],r=function(e,n){return s.useCallback((t=>{if(!n)return void console.error("No Scene!");console.log("ðŸš€ [ActionScene] context =",t);const a=new I.TgdPainterNode({children:(n.nodes??[]).filter((n=>{const t=e.getNode(n);return(0,o.Et)(t.mesh)||Array.isArray(t.children)&&t.children.length>0})).map((n=>(0,I.tgdMakeMeshGlbPainter)({data:e,node:n,context:t}).painter)),name:n.name??"Scene"});a.debug();const s=Me((n.nodes??[]).map((n=>Te(e,e.getNode(n)))));t.camera.transfo.position=s.center,t.camera.transfo.distance=2*s.radius,t.camera.far=10*s.radius,new I.TgdControllerCameraOrbit(t,{inertiaOrbit:1e3,speedZoom:.25*s.radius});const r=new I.TgdPainterClear(t,{color:[.2,.2,.2,1],depth:1}),i=new I.TgdPainterState(t,{depth:I.webglPresetDepth.lessOrEqual,children:[a]});t.add(r,i),t.paint()}),[e,n])}(e,t);return t?(0,a.jsx)("div",{className:Ne.join(Ce.actionScene),children:(0,a.jsx)(F.A,{onReady:r,width:"100%",height:"100%",gizmo:!0,noBorder:!0},JSON.stringify(t))}):(0,a.jsx)("p",{children:"No scene..."})}function Te(e,n){const t=[];(0,o.Et)(n.mesh)&&t.push(Me(function(e,n){const t=e.getMesh(n);if(!t)return[{center:new I.TgdVec3,radius:1}];const a=[];for(const n of t.primitives){const t=e.getAccessorByAttributeName(n,"POSITION");if(Se(t.min)&&Se(t.max)){const[e,n,s]=t.min,[r,i,o]=t.max;a.push({center:I.TgdVec3.newFromMix(t.min,t.max),radius:Math.max(Math.abs(r-e),Math.abs(i-n),Math.abs(o-s))})}}return a}(e,n.mesh)));for(const a of n.children??[]){const n=e.getNode(a);t.push(Te(e,n))}return function(e,n){const[t,a,s]=e.center,r=new I.TgdVec4(t,a,s,1),i={};n.translation&&(i.position=n.translation),n.rotation&&(i.orientation=n.rotation),n.scale&&(i.scale=n.scale);const o=new I.TgdTransfo(i);r.applyMatrix(o.matrix);const[c,l,A]=o.scale,d=Math.max(c,l,A);return{center:new I.TgdVec3(r.x,r.y,r.z),radius:e.radius*d}}(Me(t),n)}function Se(e){return(0,o.Xj)(e,["array","number",{min:3,max:3}])}function Me(e){if(0===e.length)return{center:new I.TgdVec3,radius:1};let n=0,t=0,a=0;for(const{center:s}of e){const[e,r,i]=s;n+=e,t+=r,a+=i}const s=e.length;n/=s,t/=s,a/=s;const r=new I.TgdVec3(n,t,a);let i=0;for(const{center:n,radius:t}of e)i=Math.max(i,t+I.TgdVec3.distance(r,new I.TgdVec3(n)));return{center:r,radius:i}}const $e=r.Sxu.classNames;function ke(e){const n={...(0,r.$qi)(e)};switch(e.action.type){case"scene":return(0,a.jsx)(Ie,{data:e.data,index:e.action.index});case"verbatim":return(0,a.jsx)(V,{data:e.data});case"node":return(0,a.jsx)(fe,{data:e.data,index:e.action.index});case"image":return(0,a.jsx)(ve,{data:e.data,index:e.action.index});default:return(0,a.jsxs)("div",{className:$e.join(e.className,S.action),style:n,children:["Don't know what to do with this action:"," ",(0,a.jsx)("pre",{children:JSON.stringify(e.action,null,"  ")}),"."]})}}const Oe={viewgltf:"jgtK2RMH89K4DKGqzXgk"},Ee=r.Sxu.classNames;function Le(e){const[n,t]=s.useState({type:"verbatim"}),[i,o]=function(){const[e,n]=s.useState(null),t=s.useCallback((e=>{(0,I.tgdLoadArrayBuffer)(e).then((e=>{e&&I.TgdDataGlb.parse(e).then(n)})).catch(console.error)}),[n]);return s.useEffect((()=>{t(T)}),[]),[e,t]}();return s.useState(null),(0,a.jsxs)(r.UkC,{className:Ee.join(e.className,Oe.viewgltf),template:"*1",orientation:"row",fullsize:!0,gap:"8px",children:[(0,a.jsxs)(r.UkC,{template:"*1",orientation:"column",children:[(0,a.jsxs)(r.sWC,{color:"primary-5",display:"flex",justifyContent:"space-between",alignItems:"center",padding:["S","M"],minWidth:"300px",gap:"M",children:[(0,a.jsx)("div",{children:"GLB Viewer"}),i&&(0,a.jsxs)("em",{children:[Math.floor(i.fileSize/1024)," Kb"]}),(0,a.jsx)(r.e3B,{accept:"glb",onLoad:function(e){const[n]=e;n&&o(n)},children:(0,a.jsx)(r.Thu,{})})]}),(0,a.jsxs)(r.sWC,{overflow:"auto",minHeight:"auto",color:"neutral-5",padding:"S",children:[!i&&(0,a.jsx)("div",{children:"Loading..."}),i&&(0,a.jsx)(N,{data:i,onAction:t})]})]}),i&&(0,a.jsx)(r.sWC,{position:"relative",overflow:"auto",fullsize:!0,children:(0,a.jsx)(ke,{action:n,data:i})})]})}function Ve(){return(0,a.jsx)(Le,{})}}}]);