"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[65],{1240:(e,n,t)=>{t.r(n),t.d(n,{default:()=>_});var r=t(4848),o=t(8453),s=t(8766),i=t(8254),a=t(6540),c=t(5072),l=t.n(c),d=t(7825),h=t.n(d),u=t(7659),f=t.n(u),m=t(5056),v=t.n(m),p=t(540),b=t.n(p),x=t(1113),g=t.n(x),w=t(9697),y={};y.styleTagTransform=g(),y.setAttributes=v(),y.insert=f().bind(null,"head"),y.domAPI=h(),y.insertStyleElement=b(),l()(w.A,y);const A=w.A&&w.A.locals?w.A.locals:void 0;function j({className:e,options:n,onReady:t,width:o="640px",height:c="480px",noBorder:l=!1}){const d=a.useRef(null),h=a.useRef(null),u=e=>{if(!e)return;h.current=e;const r=new i.tf(e,n);d.current=r,r.paint(),t&&t(r)};return a.useEffect((()=>{const e=h.current,n=d.current;if(!e||!n)return;const t=new ResizeObserver((()=>n.paint()));return t.observe(e),()=>t.unobserve(e)}),[d.current,h.current]),l?(0,r.jsx)("canvas",{className:e,style:{width:o,height:c},ref:u}):(0,r.jsxs)("div",{className:s.Sxu.classNames.join(e,A.Scene),children:[(0,r.jsx)(s.sWC,{display:"flex",justifyContent:"flex-end",children:(0,r.jsx)(s.yQN,{variant:"text",onClick:()=>{const e=h.current;e&&e.requestFullscreen()},children:"Afficher en plein Ã©cran"})}),(0,r.jsx)("canvas",{style:{width:o,height:c},ref:u})]})}const k=t.p+"bin/shield.b395cf0165ad25f85bac.glb",N=t.p+"img/background.81de42e9b532227029ac.png";var R=t(9470),C={};C.styleTagTransform=g(),C.setAttributes=v(),C.insert=f().bind(null,"head"),C.domAPI=h(),C.insertStyleElement=b(),l()(R.A,C);const E=R.A&&R.A.locals?R.A.locals:void 0;var M=function(e,n,t,r){return new(t||(t=Promise))((function(o,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,a)}c((r=r.apply(e,n||[])).next())}))};const S=s.Sxu.classNames;function D(e){const n=Object.assign({},(0,s.$qi)(e));return(0,r.jsx)("div",{className:S.join(e.className,E.shield),style:n,children:(0,r.jsx)(j,{onReady:I})})}function I(e){return M(this,void 0,void 0,(function*(){const n=yield(0,i.TC)(k);if(!n)throw Error(`Unable to load GLB file: ${k}`);const t=yield(0,i.V_)(N);if(!t)throw Error(`Unable to load image file: ${N}`);const r=4096,o=r,{canvas:s,ctx:a}=(0,i.bj)(r,o),c=e.textures2D.create({image:s});a.clearRect(0,0,r,o);let l=0;window.setInterval((()=>{if(l>59)return a.clearRect(0,0,r,o),void(l=0);l++,a.fillStyle="#fff";const n=Math.random()*r,t=Math.random()*o,i=50+400*Math.random();a.beginPath(),a.ellipse(n,t,i,i,0,0,2*Math.PI),a.fill(),c.loadImage(s),e.paint()}),500),e.camera.distance=2.5;const d=new i.dR(e,{asset:n,materialFactory:({color:e})=>{if(!e)throw Error("No abedo provided!");return new L({abedo:e,holes:c})}}),h=new i.pw(e,{inertiaOrbit:500});e.add(new i.Ip(e,{depth:i.Eg.less,blend:i.aM.alpha,children:[new i.o5(e,{color:new i.o(.5,.5,.5,1),depth:1}),new i.b6(e,e.textures2D.create({image:t})),d]})),d.paint(),e.canvas.addEventListener("dblclick",(()=>{h.reset(300)}))}))}class L{constructor(e){this.options=e,this.lightColor=new i.o(1,1,1,1),this.lightDirection=new i.hN(.1,.2,1),this.varyings={varNormal:"vec3",varUV:"vec2"},this.uniforms={texAbedo:"sampler2D",texHoles:"sampler2D",uniLightDir:"vec3"},this.fragmentShaderCode=["vec3 normal = normalize(varNormal);","float light = abs(dot(normal, uniLightDir));","light = pow(light, 9.0) * 0.9;","light += 0.2;","vec3 color = texture(texAbedo, varUV).rgb;","float spec = max(0.0, reflect(uniLightDir, normal).z);","spec = pow(spec, 20.0);","vec3 holes = texture(texHoles, varUV).rgb;","if (holes.r > 0.99) discard;","return vec4(color * light + spec + holes * 0.25, 1.0 - holes.r);"],this.vertexShaderCode=["varNormal = mat3(uniModelViewMatrix) * NORMAL;","varUV = TEXCOORD_0;"]}setUniforms(e){e.uniform3fv("uniLightDir",this.lightDirection),this.options.abedo.activate(e,"texAbedo",0),this.options.holes.activate(e,"texHoles",1)}}function O(e){const n={h1:"h1",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{children:"Punchin holes in a shield"}),"\n",(0,r.jsx)(D,{})]})}function _(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(O,{...e})}):O(e)}},9470:(e,n,t)=>{t.d(n,{A:()=>a});var r=t(1601),o=t.n(r),s=t(6314),i=t.n(s)()(o());i.push([e.id,".Hb9_tLmdLxxO8IoNjaKt {\n}\n",""]),i.locals={shield:"Hb9_tLmdLxxO8IoNjaKt"};const a=i},9697:(e,n,t)=>{t.d(n,{A:()=>a});var r=t(1601),o=t.n(r),s=t(6314),i=t.n(s)()(o());i.push([e.id,".fMWA3kBbdIkkXwhSN3E6 {\n    display: inline-block;\n    margin: 1em;\n}\n\n.fMWA3kBbdIkkXwhSN3E6 canvas {\n    box-shadow: 0 0.25em 0.5em #000;\n}\n",""]),i.locals={Scene:"fMWA3kBbdIkkXwhSN3E6"};const a=i},8453:(e,n,t)=>{t.d(n,{R:()=>s});var r=t(6540);const o=r.createContext({});function s(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}}}]);