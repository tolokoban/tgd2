"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[705],{4592:(e,n,t)=>{t.r(n),t.d(n,{default:()=>b});var o=t(4848),a=t(8453),r=t(6540),s=t(7781),i=t(9074),c=t(6391),d=t(7289);const l=t.p+"img/wood.e07ebec2ba296ac08985.webp";function h(e){e.camera.transfo.setPosition(0,-5,0).distance=30,new c.TgdControllerCameraOrbit(e);const n=()=>new c.TgdPainterNode({transfo:{position:[0,-1,0]},children:[new c.TgdPainterNode({transfo:{position:[0,-.5,-.5]},children:[new c.TgdPainterMesh(e,{geometry:new c.TgdGeometryBox,material:new c.TgdMaterialDiffuse({color:new c.TgdTexture2D(e).loadBitmap(l,{generateMipmap:!0})})})]})]});let t=n();const o=[t];for(let e=0;e<31;e++){const e=n();o.push(e),e.add(t),t=e}e.add(new c.TgdPainterClear(e,{color:[.2,.1,0,1],depth:1}),new c.TgdPainterState(e,{depth:c.webglPresetDepth.less,children:[t]}),new c.TgdPainterLogic((e,n)=>{for(const n of o){n.transfo.orientation.reset();const t=.95;n.transfo.setScale(t,t,t),n.transfo.orbitAroundX(Math.abs(Math.sin(e))*Math.PI*2/o.length),n.transfo.orbitAroundY(Math.sin(1.1287*e)*Math.PI*3*(1+Math.cos(.37243*e))/o.length)}t.transfo.orbitAroundY(.5*e)})),e.play()}function u(){return(0,o.jsx)(d.A,{onReady:h})}const g={"Detail #1":"    ctx.camera.transfo.setPosition(0, -5, 0).distance = 30\n    new TgdControllerCameraOrbit(ctx)\n    const createBox = () =>\n        new TgdPainterNode({\n            transfo: {\n                position: [0, -1, 0],\n            },\n            children: [\n                new TgdPainterNode({\n                    transfo: {\n                        position: [0, -0.5, -0.5],\n                    },\n                    children: [\n                        new TgdPainterMesh(ctx, {\n                            geometry: new TgdGeometryBox(),\n                            material: new TgdMaterialDiffuse({\n                                color: new TgdTexture2D(ctx).loadBitmap(\n                                    WoodURL,\n                                    { generateMipmap: true }\n                                ),\n                            }),\n                        }),\n                    ],\n                }),\n            ],\n        })\n    let root = createBox()\n    const boxes: TgdPainterNode[] = [root]\n    for (let i = 0; i < 31; i++) {\n        const box = createBox()\n        boxes.push(box)\n        box.add(root)\n        root = box\n    }\n    ctx.add(\n        new TgdPainterClear(ctx, { color: [0.2, 0.1, 0, 1], depth: 1 }),\n        new TgdPainterState(ctx, {\n            depth: webglPresetDepth.less,\n            children: [root],\n        }),\n        new TgdPainterLogic((time, delay) => {\n            for (const box of boxes) {\n                box.transfo.orientation.reset()\n                const s = 0.95\n                box.transfo.setScale(s, s, s)\n                box.transfo.orbitAroundX(\n                    (Math.abs(Math.sin(time)) * Math.PI * 2) / boxes.length\n                )\n                box.transfo.orbitAroundY(\n                    (Math.sin(time * 1.1287) *\n                        Math.PI *\n                        3 *\n                        (1 + Math.cos(time * 0.37243))) /\n                        boxes.length\n                )\n            }\n            root.transfo.orbitAroundY(time * 0.5)\n        })\n    )\n    ctx.play()"},x='import {\n    TgdContext,\n    TgdControllerCameraOrbit,\n    TgdGeometryBox,\n    TgdMaterialDiffuse,\n    TgdMaterialNormals,\n    TgdPainterClear,\n    TgdPainterLogic,\n    TgdPainterMesh,\n    TgdPainterNode,\n    TgdPainterState,\n    TgdTexture2D,\n    webglPresetDepth,\n} from "@tolokoban/tgd"\nimport View from "@/components/demo/Tgd"\nimport WoodURL from "./wood.webp"\n\nfunction init(ctx: TgdContext) {\n    ctx.camera.transfo.setPosition(0, -5, 0).distance = 30\n    new TgdControllerCameraOrbit(ctx)\n    const createBox = () =>\n        new TgdPainterNode({\n            transfo: {\n                position: [0, -1, 0],\n            },\n            children: [\n                new TgdPainterNode({\n                    transfo: {\n                        position: [0, -0.5, -0.5],\n                    },\n                    children: [\n                        new TgdPainterMesh(ctx, {\n                            geometry: new TgdGeometryBox(),\n                            material: new TgdMaterialDiffuse({\n                                color: new TgdTexture2D(ctx).loadBitmap(\n                                    WoodURL,\n                                    { generateMipmap: true }\n                                ),\n                            }),\n                        }),\n                    ],\n                }),\n            ],\n        })\n    let root = createBox()\n    const boxes: TgdPainterNode[] = [root]\n    for (let i = 0; i < 31; i++) {\n        const box = createBox()\n        boxes.push(box)\n        box.add(root)\n        root = box\n    }\n    ctx.add(\n        new TgdPainterClear(ctx, { color: [0.2, 0.1, 0, 1], depth: 1 }),\n        new TgdPainterState(ctx, {\n            depth: webglPresetDepth.less,\n            children: [root],\n        }),\n        new TgdPainterLogic((time, delay) => {\n            for (const box of boxes) {\n                box.transfo.orientation.reset()\n                const s = 0.95\n                box.transfo.setScale(s, s, s)\n                box.transfo.orbitAroundX(\n                    (Math.abs(Math.sin(time)) * Math.PI * 2) / boxes.length\n                )\n                box.transfo.orbitAroundY(\n                    (Math.sin(time * 1.1287) *\n                        Math.PI *\n                        3 *\n                        (1 + Math.cos(time * 0.37243))) /\n                        boxes.length\n                )\n            }\n            root.transfo.orbitAroundY(time * 0.5)\n        })\n    )\n    ctx.play()\n}\n\nexport default function Demo() {\n    return <View onReady={init} />\n}\n';function f(){const[e,n]=r.useState(!1);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"half-left",children:(0,o.jsx)(u,{})}),(0,o.jsxs)("div",{className:"half-right",children:[(0,o.jsx)("div",{children:(0,o.jsx)(s.yQN,{variant:"elevated",onClick:()=>n(!e),children:e?"Show code details":"Show full code"})}),(0,o.jsx)(i.A,{language:"tsx",value:e?x:g})]})]})}function m(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{children:(0,o.jsx)(n.a,{href:"docs/classes/TgdPainterNode.html",children:"TgdPainterNode"})}),"\n",(0,o.jsxs)(n.p,{children:["All objects implementing ",(0,o.jsx)(n.code,{children:"TgdInterfaceTransformable"})," have a ",(0,o.jsx)(n.code,{children:"transfo"})," attribute\nthat controls its position/orientation/scale in the world coordinate system. If\nyou need an object's transformation to be defined in another object coordinate\nsystem, you just have to wrap it in a ",(0,o.jsx)(n.code,{children:"TgdPainterNode"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["As long as a ",(0,o.jsx)(n.code,{children:"Transformable"})," is hold by the ",(0,o.jsx)(n.code,{children:"painter"})," attribute of a ",(0,o.jsx)(n.code,{children:"TgdPainterNode"}),",\nit will be controlled by the node.\nThat means, you should not use its ",(0,o.jsx)(n.code,{children:"transfo"})," attribute because it will be\noverwritten by the node."]}),"\n",(0,o.jsx)(n.h2,{children:"Example"}),"\n",(0,o.jsx)(f,{})]})}function b(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(m,{...e})}):m(e)}},7289:(e,n,t)=>{t.d(n,{A:()=>d});var o=t(4848),a=t(6540),r=t(6391),s=t(7781),i=t(3686);const c={Tgd:"hgIjhDQIuBCJEQ4ZgLXp",relative:"efOyHCihw9wfMB6AaAqw",overlay:"ywC8N0Uxbvm2Ug2DwPkE",loading:"PBWSRsbiwEqGpeL0hEfm",screen:"BErChOLWGtciKhh3IFud",canvas:"fT7FcYouYlPbElIAEXRP",gizmo:"uAPfWt_Dhe7RaRrnmIu0",actions:"Ia9jfUO3OevcIh2fV6R6",enabled:"dZYZScZBbWV2Pm3ftXcG",error:"J6dIEMXVMCzdFWF9UHio"};function d({className:e,options:n,onReady:t,gizmo:d=!1,width:l="640px",height:h="480px",noBorder:u=!1,assets:g,children:x}){const[f,m]=a.useState(null),[b,p]=a.useState(!0),[w,T]=a.useState(!1),j=a.useRef(null),P=a.useRef(null),y=a.useRef(null),v=a.useRef(null),[C,N]=a.useState(!0);let M="auto";l.endsWith("px")&&h.endsWith("px")&&(l.substring(l.length-2),h.substring(h.length-2));const B=e=>{if(!e)return;if(P.current)return;P.current=e;const o=new r.TgdContext(e,n),a=o.gl.getParameter(o.gl.DEPTH_BITS);console.log("Depht buffer bits:",a),j.current=o,N(!0),async function({glb:e,data:n,text:t,image:o}={}){console.log("ðŸš€ [Tgd] glb, data, text, image = ",e,n,t,o);const a={glb:{},data:{},text:{},image:{}},s=[];return o&&Object.keys(o).forEach(e=>{s.push(async()=>{const n=o[e];console.log("Loading image:",n);const t=await(0,r.tgdLoadImage)(n);t&&(a.image[e]=t)})}),e&&Object.keys(e).forEach(n=>{s.push(async()=>{const t=e[n];console.log("Loading GLB:",t);const o=await(0,r.tgdLoadGlb)(t);o&&(a.glb[n]=o)})}),n&&Object.keys(n).forEach(e=>{s.push(async()=>{const t=n[e],o=await(0,r.tgdLoadArrayBuffer)(t);o&&(a.data[e]=o)})}),t&&Object.keys(t).forEach(e=>{s.push(async()=>{const n=t[e],o=await(0,r.tgdLoadText)(n);o&&(a.text[e]=o)})}),await Promise.all(s.map(e=>e())),a}(g).then(e=>{try{t(o,e),o.paint()}catch(e){m(e instanceof Error?e.message:JSON.stringify(e))}N(!1)}).catch(e=>{console.error("Unable to initialize the scene!",e),N(!1)});const s=y.current;s&&s.attachContext(o)},S=e=>{const n=new r.TgdCanvasGizmo({canvas:e});y.current=n,n.eventTipClick.addListener(({to:e})=>{const n=j.current;n&&n.animSchedule({duration:.2,easingFunction:r.tgdEasingFunctionInOutCubic,action:(0,r.tgdActionCreateCameraInterpolation)(n.camera,{orientation:e})})});const t=j.current;t&&n.attachContext(t)};return a.useEffect(()=>{const e=P.current,n=j.current;if(!e||!n)return;const t=new ResizeObserver(()=>n.paint());return t.observe(e),e.requestFullscreen||(e.requestFullscreen=e.webkitRequestFullscreen),T(Boolean(e.requestFullscreen)),()=>t.unobserve(e)},[j.current,P.current]),u?(0,o.jsxs)("div",{ref:v,className:c.screen,style:{width:b?l:h,height:b?h:l},children:[(0,o.jsx)("canvas",{className:c.canvas,ref:B}),d&&(0,o.jsx)("canvas",{className:c.gizmo,ref:S}),f&&(0,o.jsx)("div",{className:c.error,children:f})]}):(0,o.jsxs)("div",{className:s.Sxu.classNames.join(e,c.Tgd),children:[(0,o.jsxs)("div",{className:s.Sxu.classNames.join(c.actions,!C&&c.enabled),children:[(0,o.jsx)("div",{children:(0,o.jsx)(s.I64,{onClick:()=>p(!b)})}),(0,o.jsx)("div",{children:(0,o.jsx)(s.kRc,{onClick:()=>{const e=j.current;e&&e.takeSnapshot().then(e=>{const n=document.createElement("a");document.body.appendChild(n),n.style.display="none",n.href=e.src,n.download="snapshot.png",n.click(),window.setTimeout(()=>document.body.removeChild(n),3e4)})}})}),w&&(0,o.jsx)("div",{children:(0,o.jsx)(s.L9n,{onClick:()=>{const e=v.current;e&&e.requestFullscreen()}})})]}),(0,o.jsxs)("div",{className:c.relative,children:[(0,o.jsxs)("div",{ref:v,className:c.screen,style:{width:b?l:h,height:b?h:l},children:[(0,o.jsx)("canvas",{className:c.canvas,ref:B}),d&&(0,o.jsx)("canvas",{className:c.gizmo,ref:S}),f&&(0,o.jsx)("div",{className:c.error,children:f})]}),(0,o.jsx)("div",{className:s.Sxu.classNames.join(c.overlay,C&&c.loading),children:(0,o.jsx)(i.A,{})}),x]})]})}},8453:(e,n,t)=>{t.d(n,{R:()=>r});var o=t(6540);const a=o.createContext({});function r(e){const n=o.useContext(a);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}}}]);