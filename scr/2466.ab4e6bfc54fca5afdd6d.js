"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[2466],{2466:(s,e,a)=>{a.r(e),a.d(e,{default:()=>c});var n=a(4848),l=a(8453);function t(s){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",span:"span",...(0,l.R)(),...s.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h1,{children:"Parsing GLB files"}),"\n",(0,n.jsxs)(e.p,{children:["It is common to edit 3D objects in specialized softwares like\n",(0,n.jsx)(e.a,{href:"https://blender.org",children:"Blender"}),". And to get the most of it, the better is to\nexport your creating in a GLB file. This is the binary version of a\n",(0,n.jsx)(e.a,{href:"https://registry.khronos.org/glTF/specs/2.0/glTF-2.0.htm",children:"GL Transfer Format"}),"."]}),"\n",(0,n.jsx)(e.h2,{children:"Basic usage"}),"\n",(0,n.jsx)(e.p,{children:"Here is how you can load such file in TGD:"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:"hljs language-ts",children:[(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," asset = ",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"await"})," ",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"tgdLoadGlb"}),"(url)\n"]})}),"\n",(0,n.jsx)(e.p,{children:"Or you can use an ArrayBuffer like this:"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:"hljs language-ts",children:[(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," resp = ",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"await"})," ",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"fetch"}),"(url)\n",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," data = ",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"await"})," resp.",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"arrayBuffer"}),"()\n",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," asset = ",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"new"})," ",(0,n.jsx)(e.span,{className:"hljs-title class_",children:"TgdDataGlb"}),"(data)\n"]})}),"\n",(0,n.jsxs)(e.p,{children:["For a quick render of a node, you can use\n",(0,n.jsx)(e.a,{href:"/docs/classes/TgdPainterMeshGltf.html",children:"TgdPainterMeshGltf"}),"."]}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:"hljs language-ts",children:[(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," asset = ",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"await"})," ",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"tgdLoadGlb"}),"(url)\n",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," painter = ",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"new"})," ",(0,n.jsx)(e.span,{className:"hljs-title class_",children:"TgdPainterMeshGltf"}),"(context, {\n    asset,\n})\n"]})}),"\n",(0,n.jsx)(e.p,{children:"This painter will display the primitive #0 of the mesh #0 of the GLB file."}),"\n",(0,n.jsx)(e.p,{children:"Now, if you have a more complex mesh with parents/children relationships and\nmaybe several primitives per mesh, then you can use this function:"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:"hljs language-ts",children:[(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," data = ",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"await"})," ",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"tgdLoadGlb"}),"(url)\n",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," node = ",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"tgdMakeMeshGlbPainter"}),"({ context, data })\n"]})}),"\n",(0,n.jsx)(e.h2,{children:"Advanced usage"}),"\n",(0,n.jsx)(e.h3,{children:"Creating a Dataset"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:"hljs language-ts",children:[(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," asset = ",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"await"})," ",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"tgdLoadGlb"}),"(url)\n",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," dataset = ",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"new"})," ",(0,n.jsx)(e.span,{className:"hljs-title class_",children:"TgdDataset"}),"({\n    ",(0,n.jsx)(e.span,{className:"hljs-attr",children:"POSITION"}),": ",(0,n.jsx)(e.span,{className:"hljs-string",children:'"vec4"'}),",\n    ",(0,n.jsx)(e.span,{className:"hljs-attr",children:"NORMAL"}),": ",(0,n.jsx)(e.span,{className:"hljs-string",children:'"vec3"'}),",\n    ",(0,n.jsx)(e.span,{className:"hljs-attr",children:"TEXCOORD_0"}),": ",(0,n.jsx)(e.span,{className:"hljs-string",children:'"vec2"'}),",\n})\nasset.",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"setAttrib"}),"(dataset, ",(0,n.jsx)(e.span,{className:"hljs-string",children:'"POSITION"'}),")\nasset.",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"setAttrib"}),"(dataset, ",(0,n.jsx)(e.span,{className:"hljs-string",children:'"NORMAL"'}),")\nasset.",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"setAttrib"}),"(dataset, ",(0,n.jsx)(e.span,{className:"hljs-string",children:'"TEXCOORD_0"'}),")\n",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," elements = asset.",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"getMeshPrimitiveIndices"}),"()\n",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," vao = ",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"new"})," ",(0,n.jsx)(e.span,{className:"hljs-title class_",children:"TgdVertexArray"}),"(context.",(0,n.jsx)(e.span,{className:"hljs-property",children:"gl"}),", prg, [dataset], elements)\n"]})}),"\n",(0,n.jsx)(e.h3,{children:"Extracting a texture"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:"hljs language-ts",children:[(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," asset = ",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"await"})," ",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"tgbLoadGlb"}),"(url)\n",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," primitive = asset.",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"getMeshPrimitive"}),"(meshIndex, primitiveIndex)\n",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," material = asset.",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"getMaterial"}),"(primitive.",(0,n.jsx)(e.span,{className:"hljs-property",children:"material"}),")\n",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," pbr = material.",(0,n.jsx)(e.span,{className:"hljs-property",children:"pbrMetallicRoughness"}),"\n",(0,n.jsx)(e.span,{className:"hljs-keyword",children:"const"})," texture = asset.",(0,n.jsx)(e.span,{className:"hljs-title function_",children:"createTexture2D"}),"(context, pbr.",(0,n.jsx)(e.span,{className:"hljs-property",children:"baseColorTexture"}),"?.",(0,n.jsx)(e.span,{className:"hljs-property",children:"index"}),")\n"]})}),"\n",(0,n.jsx)(e.p,{children:"Just check if you the variables are all defined (we don't do this in the example\nto not clutter the code)."})]})}function c(s={}){const{wrapper:e}={...(0,l.R)(),...s.components};return e?(0,n.jsx)(e,{...s,children:(0,n.jsx)(t,{...s})}):t(s)}},8453:(s,e,a)=>{a.d(e,{R:()=>t});var n=a(6540);const l=n.createContext({});function t(s){const e=n.useContext(l);return n.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}}}]);