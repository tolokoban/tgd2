"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[3114],{3114:(n,e,t)=>{t.r(e),t.d(e,{default:()=>x});var o=t(4848),a=t(8453),r=t(6540),i=t(5968),s=t(2212),c=t(4461),l=t(6989),u=t(7276);function d(n){const e=new c.HTX(n).loadBitmap((0,c.V_9)(u)),t=new c.Eim({uniforms:{uniTime:"float",uniAspectRatio:"float",uniAspectRatioInverse:"float"},setUniforms({program:e,time:t}){e.uniform1f("uniTime",t),e.uniform1f("uniAspectRatio",n.aspectRatio),e.uniform1f("uniAspectRatioInverse",n.aspectRatioInverse)},extraFunctions:{...(0,c.bKO)(),...(0,c.PS_)()},fragmentShaderCode:["vec2 polar = uv2polar(varUV);","float strength = sin(uniTime);","polar.y += strength * polar.x;","vec2 uv = polar2uv(polar);","FragColor = texture(uniTexture, uv);"]});n.add(new c.D$w(n,{texture:e,filters:[t]})),n.play()}function h(){return(0,o.jsx)(l.A,{onReady:d,width:"512px",height:"512px"})}const p={"Detail #1":'    const texture = new TgdTexture2D(context).loadBitmap(\n        tgdLoadImage(BackgroundURL)\n    )\n    const filter = new TgdFilter({\n        uniforms: {\n            uniTime: "float",\n            uniAspectRatio: "float",\n            uniAspectRatioInverse: "float",\n        },\n        setUniforms({ program, time }) {\n            program.uniform1f("uniTime", time)\n            program.uniform1f("uniAspectRatio", context.aspectRatio)\n            program.uniform1f(\n                "uniAspectRatioInverse",\n                context.aspectRatioInverse\n            )\n        },\n        extraFunctions: {\n            ...tgdCodeFunction_uv2polar(),\n            ...tgdCodeFunction_polar2uv(),\n        },\n        fragmentShaderCode: [\n            "vec2 polar = uv2polar(varUV);",\n            "float strength = sin(uniTime);",\n            "polar.y += strength * polar.x;",\n            "vec2 uv = polar2uv(polar);",\n            "FragColor = texture(uniTexture, uv);",\n        ],\n    })\n    context.add(\n        new TgdPainterFilter(context, {\n            texture,\n            filters: [filter],\n        })\n    )\n    context.play()'},f='import {\n    tgdCodeFunction_polar2uv,\n    tgdCodeFunction_uv2polar,\n    TgdContext,\n    TgdFilter,\n    tgdLoadImage,\n    TgdPainterFilter,\n    TgdTexture2D,\n} from "@tolokoban/tgd"\nimport View from "@/components/demo/Tgd"\n\nimport BackgroundURL from "../../../marylin.webp"\n\nfunction init(context: TgdContext) {\n    const texture = new TgdTexture2D(context).loadBitmap(\n        tgdLoadImage(BackgroundURL)\n    )\n    const filter = new TgdFilter({\n        uniforms: {\n            uniTime: "float",\n            uniAspectRatio: "float",\n            uniAspectRatioInverse: "float",\n        },\n        setUniforms({ program, time }) {\n            program.uniform1f("uniTime", time)\n            program.uniform1f("uniAspectRatio", context.aspectRatio)\n            program.uniform1f(\n                "uniAspectRatioInverse",\n                context.aspectRatioInverse\n            )\n        },\n        extraFunctions: {\n            ...tgdCodeFunction_uv2polar(),\n            ...tgdCodeFunction_polar2uv(),\n        },\n        fragmentShaderCode: [\n            "vec2 polar = uv2polar(varUV);",\n            "float strength = sin(uniTime);",\n            "polar.y += strength * polar.x;",\n            "vec2 uv = polar2uv(polar);",\n            "FragColor = texture(uniTexture, uv);",\n        ],\n    })\n    context.add(\n        new TgdPainterFilter(context, {\n            texture,\n            filters: [filter],\n        })\n    )\n    context.play()\n}\n\nexport default function Demo() {\n    return <View onReady={init} width="512px" height="512px" />\n}\n';function g(){const[n,e]=r.useState(!1);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"half-left",children:(0,o.jsx)(h,{})}),(0,o.jsxs)("div",{className:"half-right",children:[(0,o.jsx)("div",{children:(0,o.jsx)(i.yQN,{variant:"elevated",onClick:()=>e(!n),children:n?"Show code details":"Show full code"})}),(0,o.jsx)(s.A,{language:"tsx",value:n?f:p})]})]})}function m(n){const e={a:"a",h1:"h1",h2:"h2",p:"p",...(0,a.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h1,{children:(0,o.jsx)(e.a,{href:"docs/classes/TgdPainterFilter.html",children:"TgdPainterFilter"})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.a,{href:"#..",children:"Back to the list of available filters"})}),"\n",(0,o.jsxs)(e.h2,{children:["Custom filter with ",(0,o.jsx)(e.a,{href:"docs/classes/TgdFilter.html",children:"TgdFilter"})]}),"\n",(0,o.jsx)(e.p,{children:"We want some kind of line art for Marylin. Everything dark enough will become\npart of a line, the rest will be discarded."}),"\n",(0,o.jsx)(g,{})]})}function x(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(m,{...n})}):m(n)}},3469:(n,e,t)=>{t.d(e,{A:()=>s});var o=t(1601),a=t.n(o),r=t(6314),i=t.n(r)()(a());i.push([n.id,".hgIjhDQIuBCJEQ4ZgLXp {\n    display: inline-block;\n    margin: 1em;\n}\n\n.hgIjhDQIuBCJEQ4ZgLXp canvas {\n    box-shadow: 0 0.25em 0.5em #fff1;\n    max-width: 100vw;\n    max-height: 100vh;\n}\n\n.efOyHCihw9wfMB6AaAqw {\n    position: relative;\n}\n\n.ywC8N0Uxbvm2Ug2DwPkE {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    background-color: var(--theme-color-primary-1);\n    opacity: 0;\n    transition: opacity 0.3s;\n}\n\n.ywC8N0Uxbvm2Ug2DwPkE.PBWSRsbiwEqGpeL0hEfm {\n    opacity: 1;\n}\n\n.BErChOLWGtciKhh3IFud {\n    position: relative;    \n}\n\n.BErChOLWGtciKhh3IFud > canvas.fT7FcYouYlPbElIAEXRP {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n}\n\n.BErChOLWGtciKhh3IFud > canvas.uAPfWt_Dhe7RaRrnmIu0 {\n    position: absolute;\n    right: 0;\n    top: 0;\n    width: 128px;\n    height: 128px;\n    box-shadow: none;\n    border: none;\n}",""]),i.locals={Tgd:"hgIjhDQIuBCJEQ4ZgLXp",relative:"efOyHCihw9wfMB6AaAqw",overlay:"ywC8N0Uxbvm2Ug2DwPkE",loading:"PBWSRsbiwEqGpeL0hEfm",screen:"BErChOLWGtciKhh3IFud",canvas:"fT7FcYouYlPbElIAEXRP",gizmo:"uAPfWt_Dhe7RaRrnmIu0"};const s=i},6989:(n,e,t)=>{t.d(e,{A:()=>R});var o=t(4848),a=t(6540),r=t(4461),i=t(5968),s=t(5670),c=t(5072),l=t.n(c),u=t(7825),d=t.n(u),h=t(7659),p=t.n(h),f=t(5056),g=t.n(f),m=t(540),x=t.n(m),v=t(1113),w=t.n(v),b=t(3469),y={};y.styleTagTransform=w(),y.setAttributes=g(),y.insert=p().bind(null,"head"),y.domAPI=d(),y.insertStyleElement=x(),l()(b.A,y);const j=b.A&&b.A.locals?b.A.locals:void 0;function R({className:n,options:e,onReady:t,gizmo:c=!1,width:l="640px",height:u="480px",noBorder:d=!1,assets:h,children:p}){const[f,g]=a.useState(!0),[m,x]=a.useState(!1),v=a.useRef(null),w=a.useRef(null),b=a.useRef(null),y=a.useRef(null),[R,T]=a.useState(!0);let C="auto";l.endsWith("px")&&u.endsWith("px")&&(l.substring(l.length-2),u.substring(u.length-2));const F=n=>{if(!n)return;if(w.current)return;w.current=n;const o=new r.tfp(n,e);v.current=o,T(!0),async function({glb:n,data:e,text:t,image:o}={}){console.log("ðŸš€ [Tgd] glb, data, text, image = ",n,e,t,o);const a={glb:{},data:{},text:{},image:{}},i=[];return o&&Object.keys(o).forEach((n=>{i.push((async()=>{const e=o[n];console.log("Loading image:",e);const t=await(0,r.V_9)(e);t&&(a.image[n]=t)}))})),n&&Object.keys(n).forEach((e=>{i.push((async()=>{const t=n[e];console.log("Loading GLB:",t);const o=await(0,r.TCe)(t);o&&(a.glb[e]=o)}))})),e&&Object.keys(e).forEach((n=>{i.push((async()=>{const t=e[n],o=await(0,r.vSU)(t);o&&(a.data[n]=o)}))})),t&&Object.keys(t).forEach((n=>{i.push((async()=>{const e=t[n],o=await(0,r.jWq)(e);o&&(a.text[n]=o)}))})),await Promise.all(i.map((n=>n()))),a}(h).then((n=>{console.log("Ready!"),t(o,n),o.paint(),T(!1)})).catch((n=>{console.error("Unable to initialize the scene!",n),T(!1)}));const a=b.current;a&&a.attachContext(o)},A=n=>{const e=new r.GbF({canvas:n});b.current=e,e.eventTipClick.addListener((({to:n})=>{const e=v.current;console.log("ðŸš€ [tgd] to, context =",n,e),e&&e.animSchedule({duration:.2,easingFunction:r.Wcc,action:(0,r.vRM)(e.camera,{orientation:n})})}));const t=v.current;t&&e.attachContext(t)};return a.useEffect((()=>{const n=w.current,e=v.current;if(!n||!e)return;const t=new ResizeObserver((()=>e.paint()));return t.observe(n),n.requestFullscreen||(n.requestFullscreen=n.webkitRequestFullscreen),x(Boolean(n.requestFullscreen)),()=>t.unobserve(n)}),[v.current,w.current]),d?(0,o.jsxs)("div",{ref:y,className:j.screen,style:{width:f?l:u,height:f?u:l},children:[(0,o.jsx)("canvas",{className:j.canvas,ref:F}),c&&(0,o.jsx)("canvas",{className:j.gizmo,ref:A})]}):(0,o.jsxs)("div",{className:i.Sxu.classNames.join(n,j.Tgd),children:[(0,o.jsxs)(i.sWC,{display:"flex",justifyContent:"space-between",children:[(0,o.jsx)(i.yQN,{variant:"elevated",onClick:()=>g(!f),enabled:!R,children:f?"Switch to Portrait":"Switch to Landscape"}),m&&(0,o.jsx)(i.yQN,{variant:"elevated",onClick:()=>{const n=y.current;n&&n.requestFullscreen()},enabled:!R,children:"Fullscreen"})]}),(0,o.jsxs)("div",{className:j.relative,children:[(0,o.jsxs)("div",{ref:y,className:j.screen,style:{width:f?l:u,height:f?u:l},children:[(0,o.jsx)("canvas",{className:j.canvas,ref:F}),c&&(0,o.jsx)("canvas",{className:j.gizmo,ref:A})]}),(0,o.jsx)("div",{className:i.Sxu.classNames.join(j.overlay,R&&j.loading),children:(0,o.jsx)(s.A,{})}),p]})]})}},7276:(n,e,t)=>{n.exports=t.p+"img/marylin.66072c9feb1d7f2eb990.webp"},8453:(n,e,t)=>{t.d(e,{R:()=>r});var o=t(6540);const a=o.createContext({});function r(n){const e=o.useContext(a);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}}}]);