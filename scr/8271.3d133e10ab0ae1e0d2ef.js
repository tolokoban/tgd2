"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[8271],{6750:(A,e,t)=>{t.r(e),t.d(e,{default:()=>x});var n=t(4848),a=t(8453),s=t(6540),r=t(7402),i=t(9074),o=t(8192),M=t(7289);const l=t.p+"bin/chinese-chandelier.d27dbc106783f8d8ac4d.glb",c="data:model/gltf-binary;base64,Z2xURgIAAADEEgAA4AIAAEpTT057ImFzc2V0Ijp7ImdlbmVyYXRvciI6Iktocm9ub3MgZ2xURiBCbGVuZGVyIEkvTyB2NC4zLjQ3IiwidmVyc2lvbiI6IjIuMCJ9LCJzY2VuZSI6MCwic2NlbmVzIjpbeyJuYW1lIjoiU2NlbmUiLCJub2RlcyI6WzBdfV0sIm5vZGVzIjpbeyJtZXNoIjowLCJuYW1lIjoiR3JpZCJ9XSwibWVzaGVzIjpbeyJuYW1lIjoiR3JpZCIsInByaW1pdGl2ZXMiOlt7ImF0dHJpYnV0ZXMiOnsiUE9TSVRJT04iOjAsIlRFWENPT1JEXzAiOjF9LCJpbmRpY2VzIjoyfV19XSwiYWNjZXNzb3JzIjpbeyJidWZmZXJWaWV3IjowLCJjb21wb25lbnRUeXBlIjo1MTI2LCJjb3VudCI6MTQyLCJtYXgiOlsxLDAsMV0sIm1pbiI6Wy0xLDAsLTFdLCJ0eXBlIjoiVkVDMyJ9LHsiYnVmZmVyVmlldyI6MSwiY29tcG9uZW50VHlwZSI6NTEyNiwiY291bnQiOjE0MiwidHlwZSI6IlZFQzIifSx7ImJ1ZmZlclZpZXciOjIsImNvbXBvbmVudFR5cGUiOjUxMjMsImNvdW50Ijo2MDAsInR5cGUiOiJTQ0FMQVIifV0sImJ1ZmZlclZpZXdzIjpbeyJidWZmZXIiOjAsImJ5dGVMZW5ndGgiOjE3MDQsImJ5dGVPZmZzZXQiOjAsInRhcmdldCI6MzQ5NjJ9LHsiYnVmZmVyIjowLCJieXRlTGVuZ3RoIjoxMTM2LCJieXRlT2Zmc2V0IjoxNzA0LCJ0YXJnZXQiOjM0OTYyfSx7ImJ1ZmZlciI6MCwiYnl0ZUxlbmd0aCI6MTIwMCwiYnl0ZU9mZnNldCI6Mjg0MCwidGFyZ2V0IjozNDk2M31dLCJidWZmZXJzIjpbeyJieXRlTGVuZ3RoIjo0MDQwfV19ICAgyA8AAEJJTgAAAIC/AAAAAAAAgD/NzEy/AAAAAAAAgD+amRm/AAAAAAAAgD/MzMy+AAAAAAAAgD/MzEy+AAAAAAAAgD8AAAAAAAAAAAAAgD/QzEw+AAAAAAAAgD/MzMw+AAAAAAAAgD+amRk/AAAAAAAAgD/OzEw/AAAAAAAAgD8AAIA/AAAAAAAAgD8AAIC/AAAAAM3MTD/NzEy/AAAAAM3MTD+amRm/AAAAAM3MTD+amRm/AAAAAM3MTD/MzMy+AAAAAM3MTD/MzEy+AAAAAM3MTD8AAAAAAAAAAM3MTD/QzEw+AAAAAM3MTD/MzMw+AAAAAM3MTD+amRk/AAAAAM3MTD/OzEw/AAAAAM3MTD8AAIA/AAAAAM3MTD8AAIC/AAAAAJqZGT8AAIC/AAAAAJqZGT/NzEy/AAAAAJqZGT/NzEy/AAAAAJqZGT+amRm/AAAAAJqZGT+amRm/AAAAAJqZGT+amRm/AAAAAJqZGT/MzMy+AAAAAJqZGT/MzMy+AAAAAJqZGT/MzEy+AAAAAJqZGT/MzEy+AAAAAJqZGT8AAAAAAAAAAJqZGT8AAAAAAAAAAJqZGT/QzEw+AAAAAJqZGT/QzEw+AAAAAJqZGT/MzMw+AAAAAJqZGT/MzMw+AAAAAJqZGT+amRk/AAAAAJqZGT+amRk/AAAAAJqZGT/OzEw/AAAAAJqZGT/OzEw/AAAAAJqZGT8AAIA/AAAAAJqZGT8AAIA/AAAAAJqZGT8AAIC/AAAAAMzMzD7NzEy/AAAAAMzMzD6amRm/AAAAAMzMzD6amRm/AAAAAMzMzD7MzMy+AAAAAMzMzD7MzEy+AAAAAMzMzD4AAAAAAAAAAMzMzD7QzEw+AAAAAMzMzD7MzMw+AAAAAMzMzD6amRk/AAAAAMzMzD7OzEw/AAAAAMzMzD4AAIA/AAAAAMzMzD4AAIC/AAAAAMzMTD7NzEy/AAAAAMzMTD6amRm/AAAAAMzMTD6amRm/AAAAAMzMTD7MzMy+AAAAAMzMTD7MzEy+AAAAAMzMTD4AAAAAAAAAAMzMTD7QzEw+AAAAAMzMTD7MzMw+AAAAAMzMTD6amRk/AAAAAMzMTD7OzEw/AAAAAMzMTD4AAIA/AAAAAMzMTD4AAIC/AAAAAAAAAIDNzEy/AAAAAAAAAICamRm/AAAAAAAAAICamRm/AAAAAAAAAIDMzMy+AAAAAAAAAIDMzEy+AAAAAAAAAIAAAAAAAAAAAAAAAIDQzEw+AAAAAAAAAIDMzMw+AAAAAAAAAICamRk/AAAAAAAAAIDOzEw/AAAAAAAAAIAAAIA/AAAAAAAAAIAAAIC/AAAAANDMTL7NzEy/AAAAANDMTL6amRm/AAAAANDMTL6amRm/AAAAANDMTL7MzMy+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AAAAtAAAAQAMAAAADAALAAEAAgANAAEADQAMAAIAAwAPAAIADwAOAAMABAAQAAMAEAAPAAQABQARAAQAEQAQAAUABgASAAUAEgARAAYABwATAAYAEwASAAcACAAUAAcAFAATAAgACQAVAAgAFQAUAAkACgAWAAkAFgAVAAsADAAaAAsAGgAYAAwADQAcAAwAHAAaAA0ADwAfAA0AHwAdAA8AEAAhAA8AIQAfABAAEQAjABAAIwAhABEAEgAlABEAJQAjABIAEwAnABIAJwAlABMAFAApABMAKQAnABQAFQArABQAKwApABUAFgAtABUALQArABcAGQAvABcALwAuABkAGwAwABkAMAAvABsAHgAyABsAMgAxAB4AIAAzAB4AMwAyACAAIgA0ACAANAAzACIAJAA1ACIANQA0ACQAJgA2ACQANgA1ACYAKAA3ACYANwA2ACgAKgA4ACgAOAA3ACoALAA5ACoAOQA4AC4ALwA7AC4AOwA6AC8AMAA8AC8APAA7ADAAMgA+ADAAPgA9ADIAMwA/ADIAPwA+ADMANABAADMAQAA/ADQANQBBADQAQQBAADUANgBCADUAQgBBADYANwBDADYAQwBCADcAOABEADcARABDADgAOQBFADgARQBEADoAOwBHADoARwBGADsAPABIADsASABHADwAPgBKADwASgBJAD4APwBLAD4ASwBKAD8AQABMAD8ATABLAEAAQQBNAEAATQBMAEEAQgBOAEEATgBNAEIAQwBPAEIATwBOAEMARABQAEMAUABPAEQARQBRAEQAUQBQAEYARwBTAEYAUwBSAEcASABUAEcAVABTAEgASgBWAEgAVgBVAEoASwBXAEoAVwBWAEsATABYAEsAWABXAEwATQBZAEwAWQBYAE0ATgBaAE0AWgBZAE4ATwBbAE4AWwBaAE8AUABcAE8AXABbAFAAUQBdAFAAXQBcAFIAUwBfAFIAXwBeAFMAVABgAFMAYABfAFQAVgBiAFQAYgBhAFYAVwBjAFYAYwBiAFcAWABkAFcAZABjAFgAWQBlAFgAZQBkAFkAWgBmAFkAZgBlAFoAWwBnAFoAZwBmAFsAXABoAFsAaABnAFwAXQBpAFwAaQBoAF4AXwBrAF4AawBqAF8AYABsAF8AbABrAGAAYgBuAGAAbgBtAGIAYwBvAGIAbwBuAGMAZABwAGMAcABvAGQAZQBxAGQAcQBwAGUAZgByAGUAcgBxAGYAZwBzAGYAcwByAGcAaAB0AGcAdABzAGgAaQB1AGgAdQB0AGoAawB3AGoAdwB2AGsAbAB4AGsAeAB3AGwAbgB6AGwAegB5AG4AbwB7AG4AewB6AG8AcAB8AG8AfAB7AHAAcQB9AHAAfQB8AHEAcgB+AHEAfgB9AHIAcwB/AHIAfwB+AHMAdACAAHMAgAB/AHQAdQCBAHQAgQCAAHYAdwCDAHYAgwCCAHcAeACEAHcAhACDAHgAegCGAHgAhgCFAHoAewCHAHoAhwCGAHsAfACIAHsAiACHAHwAfQCJAHwAiQCIAH0AfgCKAH0AigCJAH4AfwCLAH4AiwCKAH8AgACMAH8AjACLAIAAgQCNAIAAjQCMAA==";class m extends o.rBx{constructor(A){super(),this.context=A,this.varyings={varZ:"float",varNormal:"vec3"},this.texture=void 0,this.vertexShaderCode=["varNormal = mat3(uniModelViewMatrix) * mat3(uniTransfoMatrix) * NORMAL;","varZ = -.2 * (uniModelViewMatrix * uniTransfoMatrix * POSITION).z;"],this.fragmentShaderCode=["vec2 uv = gl_FragCoord.xy * uniInverseScreenSize;","vec4 color = texture(texDiffuse, uv);","float dist = color.a - varZ;","dist = clamp(dist * 10.0, 0.0, 0.9);","color *= 4.0;","float s = .01;","color += texture(texDiffuse, uv + vec2(dist * s, 0));","color += texture(texDiffuse, uv - vec2(dist * s, 0));","color += texture(texDiffuse, uv + vec2(0, dist * s));","color += texture(texDiffuse, uv - vec2(0, dist * s));","color *= .125;","vec3 result = mix(color.rgb, vec3(0, 0, .4), pow(dist, 0.5));","float specular = clamp(varNormal.z, 0.0, 1.0) * .3;","return vec4(result + vec3(specular), 1.0);"],this.uniforms.uniInverseScreenSize="vec2",this.uniforms.texDiffuse="sampler2D"}setUniforms(A,e){const{texture:t,context:n}=this;t&&t.activate(0,A,"texDiffuse"),A.uniform2f("uniInverseScreenSize",1/n.width,1/n.height)}}class z extends o.tbm{constructor(A){super(),this.context=A,this.material=new m(A),this.sea=new o.buV({children:[new o.g6h(A,{geometry:new o.ZWB({sizeX:1,sizeY:.5,sizeZ:1}),material:this.material})]})}set texture(A){this.material.texture=A}set y(A){this.sea.transfo.setPosition(0,A,0)}delete(){throw new Error("Method not implemented.")}paint(A,e){const{context:t,sea:n}=this;o.Ipk.do({gl:t.gl,depth:o.Eg5.less},(()=>{n.transfo.orbitAroundZ(.8521*e).orbitAroundX(.3764*e),n.paint(A,e)}))}}const w=new o.oao(.8,.6,.1,1);class g extends o.rBx{constructor(A={}){super(),this.light=new o.U5Z,this.ambient=new o.U5Z({color:new o.oao(.2,.1,0,0)}),this.specularExponent=20,this.specularIntensity=1,this.uniforms={uniLight:"vec3",uniLightDir:"vec3",uniAmbient:"vec3",uniSpecularExponent:"float",uniSpecularIntensity:"float",uniModelViewMatrix:"mat4"},this.lightColor=new o.hNi,this.ambientColor=new o.hNi;const e=A.color instanceof o.HTX?A.color:new o.oao(A.color??w);A.light&&(this.light=A.light),A.ambient&&(this.ambient=A.ambient),"number"==typeof A.specularExponent&&(this.specularExponent=A.specularExponent),"number"==typeof A.specularIntensity&&(this.specularIntensity=A.specularIntensity);const t=!(e instanceof o.oao);this.texture=t?e:null,this.fragmentShaderCode=["vec3 normal = normalize(varNormal);","float light = 1.0 - dot(normal, uniLightDir);",t?"vec4 color = texture(texDiffuse, varUV);":`vec4 color = vec4(${e.join(", ")});`,"vec3 normal2 = mat3(uniModelViewMatrix) * normal;","float spec = max(0.0, reflect(uniLightDir, normal2).z);","spec = pow(spec, uniSpecularExponent) * uniSpecularIntensity;","color = vec4(","  color.rgb * (","    uniAmbient + uniLight * light","  ) + vec3(spec),","  varZ",");","return color;"],this.vertexShaderCode=["varNormal = mat3(uniTransfoMatrix) * NORMAL;","varZ = -.2 * (uniModelViewMatrix * uniTransfoMatrix * vec4(position, 1)).z;"],this.varyings={varNormal:"vec3",varZ:"float"},t&&(this.vertexShaderCode.push("varUV = TEXCOORD_0;"),this.varyings.varUV="vec2",this.uniforms.texDiffuse="sampler2D")}setUniforms(A){A.uniform3fv("uniLightDir",this.light.direction),this.lightColor.from(this.light.color).scale(this.light.color.w),A.uniform3fv("uniLight",this.lightColor),this.ambientColor.from(this.ambient.color).scale(this.ambient.color.w),A.uniform3fv("uniAmbient",this.ambientColor),A.uniform1f("uniSpecularExponent",this.specularExponent),A.uniform1f("uniSpecularIntensity",this.specularIntensity);const{texture:e}=this;e&&e.activate(0,A,"texDiffuse")}}function d(A,e){A.camera=new o.xNY({transfo:{distance:2},far:100,near:.01,fovy:(0,o.HPH)(35),zoom:1}),new o.pwt(A,{speedPanning:0,inertiaOrbit:1e3,geo:{lat:(0,o.HPH)(50),minLat:(0,o.HPH)(-20),maxLat:(0,o.HPH)(80)}});const t=new o.o57(A,{color:new o.oao(0,0,0,1),depth:1,stencil:0}),n=new o.Ipk(A,{depth:o.Eg5.less,cull:o.TfJ.back,children:[new o.dRj(A,{asset:e.glb.world,material:({color:A})=>new g({color:A})})]}),a=new o.Ipk(A,{depth:o.Eg5.less,cull:o.TfJ.back,children:[new o.dRj(A,{asset:e.glb.world,material:({color:A})=>new o.$Hl({color:A})})]}),s=new z(A),r=new o.EWU([t,n]),i=new o.M8D(A,{textureColor0:new o.HTX(A),children:[r]});i.textureColor0&&(s.texture=i.textureColor0),A.add(i,t,a,s),A.logicAdd((A=>{s.y=.5*Math.sin(.4*A)})),A.play()}function u(){return(0,n.jsx)(M.A,{options:{antialias:!0,stencil:!0,depth:!0},onReady:d,assets:{glb:{world:l,see:c}}})}const h={"Detail #1":"    context.camera = new TgdCameraPerspective({\n        transfo: { distance: 2 },\n        far: 100,\n        near: 0.01,\n        fovy: tgdCalcDegToRad(35),\n        zoom: 1,\n    })\n    new TgdControllerCameraOrbit(context, {\n        speedPanning: 0,\n        inertiaOrbit: 1000,\n        geo: {\n            lat: tgdCalcDegToRad(50),\n            minLat: tgdCalcDegToRad(-20),\n            maxLat: tgdCalcDegToRad(80),\n        },\n    })\n    const clear = new TgdPainterClear(context, {\n        color: new TgdVec4(0, 0, 0, 1),\n        depth: 1,\n        stencil: 0,\n    })\n    const mesh = new TgdPainterState(context, {\n        depth: webglPresetDepth.less,\n        cull: webglPresetCull.back,\n        children: [\n            new TgdPainterMeshGltf(context, {\n                asset: assets.glb.world,\n                material: ({ color }) => new MaterialDiffuse({ color }),\n            }),\n        ],\n    })\n    const meshOpaque = new TgdPainterState(context, {\n        depth: webglPresetDepth.less,\n        cull: webglPresetCull.back,\n        children: [\n            new TgdPainterMeshGltf(context, {\n                asset: assets.glb.world,\n                material: ({ color }) => new TgdMaterialDiffuse({ color }),\n            }),\n        ],\n    })\n    const sea = new PainterSea(context)\n    const scene = new TgdPainterGroup([clear, mesh])\n    const framebuffer = new TgdPainterFramebufferWithAntiAliasing(context, {\n        textureColor0: new TgdTexture2D(context),\n        children: [scene],\n    })\n    if (framebuffer.textureColor0) sea.texture = framebuffer.textureColor0\n    context.add(framebuffer, clear, meshOpaque, sea)\n    context.logicAdd(time => {\n        sea.y = Math.sin(time * 0.4) * 0.5\n    })\n    context.play()"},D='import {\n    tgdCalcDegToRad,\n    TgdCameraPerspective,\n    TgdContext,\n    TgdControllerCameraOrbit,\n    TgdFilterVerbatim,\n    TgdGeometryPlane,\n    TgdMaterialDiffuse,\n    TgdMaterialSolid,\n    TgdPainterClear,\n    TgdPainterDebugStencil,\n    TgdPainterFilter,\n    TgdPainterFramebuffer,\n    TgdPainterFramebufferWithAntiAliasing,\n    TgdPainterGroup,\n    TgdPainterLogic,\n    TgdPainterMesh,\n    TgdPainterMeshGltf,\n    TgdPainterState,\n    TgdTexture2D,\n    TgdVec4,\n    webglPresetCull,\n    webglPresetDepth,\n    webglPresetStencil,\n} from "@tolokoban/tgd"\nimport View, { Assets } from "@/components/demo/Tgd"\n\n// import WorldURL from "./world.glb"\nimport WorldURL from "@/assets/mesh/chinese-chandelier.glb"\nimport GridURL from "@/assets/mesh/grid-10x10.glb"\nimport { SeaMaterial } from "./sea-material"\nimport { PainterSea } from "./sea"\nimport { PositionMaterial } from "./position-material"\nimport { MaterialDiffuse } from "./diffuse"\n\nfunction init(context: TgdContext, assets: Assets) {\n    context.camera = new TgdCameraPerspective({\n        transfo: { distance: 2 },\n        far: 100,\n        near: 0.01,\n        fovy: tgdCalcDegToRad(35),\n        zoom: 1,\n    })\n    new TgdControllerCameraOrbit(context, {\n        speedPanning: 0,\n        inertiaOrbit: 1000,\n        geo: {\n            lat: tgdCalcDegToRad(50),\n            minLat: tgdCalcDegToRad(-20),\n            maxLat: tgdCalcDegToRad(80),\n        },\n    })\n    const clear = new TgdPainterClear(context, {\n        color: new TgdVec4(0, 0, 0, 1),\n        depth: 1,\n        stencil: 0,\n    })\n    const mesh = new TgdPainterState(context, {\n        depth: webglPresetDepth.less,\n        cull: webglPresetCull.back,\n        children: [\n            new TgdPainterMeshGltf(context, {\n                asset: assets.glb.world,\n                material: ({ color }) => new MaterialDiffuse({ color }),\n            }),\n        ],\n    })\n    const meshOpaque = new TgdPainterState(context, {\n        depth: webglPresetDepth.less,\n        cull: webglPresetCull.back,\n        children: [\n            new TgdPainterMeshGltf(context, {\n                asset: assets.glb.world,\n                material: ({ color }) => new TgdMaterialDiffuse({ color }),\n            }),\n        ],\n    })\n    const sea = new PainterSea(context)\n    const scene = new TgdPainterGroup([clear, mesh])\n    const framebuffer = new TgdPainterFramebufferWithAntiAliasing(context, {\n        textureColor0: new TgdTexture2D(context),\n        children: [scene],\n    })\n    if (framebuffer.textureColor0) sea.texture = framebuffer.textureColor0\n    context.add(framebuffer, clear, meshOpaque, sea)\n    context.logicAdd(time => {\n        sea.y = Math.sin(time * 0.4) * 0.5\n    })\n    context.play()\n}\n\nexport default function Demo() {\n    return (\n        <View\n            options={{ antialias: true, stencil: true, depth: true }}\n            onReady={init}\n            assets={{\n                glb: {\n                    world: WorldURL,\n                    see: GridURL,\n                },\n            }}\n        />\n    )\n}\n';function T(){const[A,e]=s.useState(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"half-left",children:(0,n.jsx)(u,{})}),(0,n.jsxs)("div",{className:"half-right",children:[(0,n.jsx)("div",{children:(0,n.jsx)(r.yQN,{variant:"elevated",onClick:()=>e(!A),children:A?"Show code details":"Show full code"})}),(0,n.jsx)(i.A,{language:"tsx",value:A?D:h})]})]})}function f(A){const e={a:"a",h1:"h1",p:"p",...(0,a.R)(),...A.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h1,{children:[(0,n.jsx)(e.a,{href:"docs/classes/TgdPainterFramebuffer.html",children:"TgdPainterFramebuffer"})," - Example 3"]}),"\n",(0,n.jsx)(e.p,{children:"Let's use the framebuffer to simulate water. We want the objects deeply flooded\nto be almost invisible. That's why we need to store the height of every rendered\npixels."}),"\n",(0,n.jsx)(e.p,{children:"In this demo, we store the distance from the camera on the alpha channel. That\nmeans, that w have only 1 byte for the resolution. You can see some weird lines\nin the texture under the water."}),"\n",(0,n.jsx)(T,{})]})}function x(A={}){const{wrapper:e}={...(0,a.R)(),...A.components};return e?(0,n.jsx)(e,{...A,children:(0,n.jsx)(f,{...A})}):f(A)}},7289:(A,e,t)=>{t.d(e,{A:()=>M});var n=t(4848),a=t(6540),s=t(8192),r=t(7402),i=t(3686);const o={Tgd:"hgIjhDQIuBCJEQ4ZgLXp",relative:"efOyHCihw9wfMB6AaAqw",overlay:"ywC8N0Uxbvm2Ug2DwPkE",loading:"PBWSRsbiwEqGpeL0hEfm",screen:"BErChOLWGtciKhh3IFud",canvas:"fT7FcYouYlPbElIAEXRP",gizmo:"uAPfWt_Dhe7RaRrnmIu0"};function M({className:A,options:e,onReady:t,gizmo:M=!1,width:l="640px",height:c="480px",noBorder:m=!1,assets:z,children:w}){const[g,d]=a.useState(!0),[u,h]=a.useState(!1),D=a.useRef(null),T=a.useRef(null),f=a.useRef(null),x=a.useRef(null),[Z,p]=a.useState(!0);let I="auto";l.endsWith("px")&&c.endsWith("px")&&(l.substring(l.length-2),c.substring(c.length-2));const C=A=>{if(!A)return;if(T.current)return;T.current=A;const n=new s.tfp(A,e);D.current=n,p(!0),async function({glb:A,data:e,text:t,image:n}={}){console.log("ðŸš€ [Tgd] glb, data, text, image = ",A,e,t,n);const a={glb:{},data:{},text:{},image:{}},r=[];return n&&Object.keys(n).forEach((A=>{r.push((async()=>{const e=n[A];console.log("Loading image:",e);const t=await(0,s.V_9)(e);t&&(a.image[A]=t)}))})),A&&Object.keys(A).forEach((e=>{r.push((async()=>{const t=A[e];console.log("Loading GLB:",t);const n=await(0,s.TCe)(t);n&&(a.glb[e]=n)}))})),e&&Object.keys(e).forEach((A=>{r.push((async()=>{const t=e[A],n=await(0,s.vSU)(t);n&&(a.data[A]=n)}))})),t&&Object.keys(t).forEach((A=>{r.push((async()=>{const e=t[A],n=await(0,s.jWq)(e);n&&(a.text[A]=n)}))})),await Promise.all(r.map((A=>A()))),a}(z).then((A=>{console.log("Ready!"),t(n,A),n.paint(),p(!1)})).catch((A=>{console.error("Unable to initialize the scene!",A),p(!1)}));const a=f.current;a&&a.attachContext(n)},P=A=>{const e=new s.GbF({canvas:A});f.current=e,e.eventTipClick.addListener((({to:A})=>{const e=D.current;console.log("ðŸš€ [tgd] to, context =",A,e),e&&e.animSchedule({duration:.2,easingFunction:s.Wcc,action:(0,s.vRM)(e.camera,{orientation:A})})}));const t=D.current;t&&e.attachContext(t)};return a.useEffect((()=>{const A=T.current,e=D.current;if(!A||!e)return;const t=new ResizeObserver((()=>e.paint()));return t.observe(A),A.requestFullscreen||(A.requestFullscreen=A.webkitRequestFullscreen),h(Boolean(A.requestFullscreen)),()=>t.unobserve(A)}),[D.current,T.current]),m?(0,n.jsxs)("div",{ref:x,className:o.screen,style:{width:g?l:c,height:g?c:l},children:[(0,n.jsx)("canvas",{className:o.canvas,ref:C}),M&&(0,n.jsx)("canvas",{className:o.gizmo,ref:P})]}):(0,n.jsxs)("div",{className:r.Sxu.classNames.join(A,o.Tgd),children:[(0,n.jsxs)(r.sWC,{display:"flex",justifyContent:"space-between",children:[(0,n.jsx)(r.yQN,{variant:"elevated",onClick:()=>d(!g),enabled:!Z,children:g?"Switch to Portrait":"Switch to Landscape"}),u&&(0,n.jsx)(r.yQN,{variant:"elevated",onClick:()=>{const A=x.current;A&&A.requestFullscreen()},enabled:!Z,children:"Fullscreen"})]}),(0,n.jsxs)("div",{className:o.relative,children:[(0,n.jsxs)("div",{ref:x,className:o.screen,style:{width:g?l:c,height:g?c:l},children:[(0,n.jsx)("canvas",{className:o.canvas,ref:C}),M&&(0,n.jsx)("canvas",{className:o.gizmo,ref:P})]}),(0,n.jsx)("div",{className:r.Sxu.classNames.join(o.overlay,Z&&o.loading),children:(0,n.jsx)(i.A,{})}),w]})]})}},8453:(A,e,t)=>{t.d(e,{R:()=>s});var n=t(6540);const a=n.createContext({});function s(A){const e=n.useContext(a);return n.useMemo((function(){return"function"==typeof A?A(e):{...e,...A}}),[e,A])}}}]);