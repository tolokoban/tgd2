"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[9253],{4859:(e,n,A)=>{e.exports=A.p+"img/dino.a892a1760dcaac9618a1.webp"},6936:(e,n,A)=>{A.r(n),A.d(n,{default:()=>b});var t=A(4848),r=A(8453),a=A(6540),o=A(7402),s=A(9074),i=A(9199),c=A(7289);class l extends i.rBx{constructor(){super(),this.vertexShaderCode=["varUV = TEXCOORD_0;"],this.texture=void 0,this.fragmentShaderCode=["vec4 color1 = texture(texDiffuse, varUV * 1.0);","float k = 0.7071067811865476;","float ang = uniTime * .777;","vec4 color2 = vec4(",["0.5 + k * sin(ang - 2.0943951023931953),","0.5 + k * sin(ang),","0.5 + k * sin(ang + 2.0943951023931953),","1.0"],");","vec2 p = 2.0 * (varUV - vec2(.5));","vec2 polar = vec2(",["length(p),","atan(p.y, p.x)"],");","float alpha = 0.1 + 0.3 * (cos(uniTime * 1.451) * sin(uniTime) + 1.0);","polar.y -= uniTime * 1.421 * (1.0 + pow(polar.x, .5));","polar.x += 0.25 * sin(0.75 * uniTime + polar.y * 3.0) * cos(uniTime * 1.751);","float beta = 1.0 - smoothstep(0.0, 0.1 + 0.1 * abs(sin(uniTime * 1.1474) * cos(uniTime) * 1.452), abs(fract(polar.x * 0.90) - 0.5));","return mix(color1, color2, max(alpha, beta));"],this.varyings.varUV="vec2",this.uniforms.texDiffuse="sampler2D",this.uniforms.uniTime="float"}setUniforms(e,n){const{texture:A}=this;A&&A.activate(0,e,"texDiffuse"),e.uniform1f("uniTime",.001*n)}}const d="data:model/gltf-binary;base64,Z2xURgIAAADABgAAXAMAAEpTT057ImFzc2V0Ijp7ImdlbmVyYXRvciI6Iktocm9ub3MgZ2xURiBCbGVuZGVyIEkvTyB2NC4zLjQ3IiwidmVyc2lvbiI6IjIuMCJ9LCJzY2VuZSI6MCwic2NlbmVzIjpbeyJuYW1lIjoiU2NlbmUiLCJub2RlcyI6WzBdfV0sIm5vZGVzIjpbeyJtZXNoIjowLCJuYW1lIjoiQ3ViZSJ9XSwibWVzaGVzIjpbeyJuYW1lIjoiQ3ViZSIsInByaW1pdGl2ZXMiOlt7ImF0dHJpYnV0ZXMiOnsiUE9TSVRJT04iOjAsIk5PUk1BTCI6MSwiVEVYQ09PUkRfMCI6Mn0sImluZGljZXMiOjN9XX1dLCJhY2Nlc3NvcnMiOlt7ImJ1ZmZlclZpZXciOjAsImNvbXBvbmVudFR5cGUiOjUxMjYsImNvdW50IjoyNCwibWF4IjpbMSwxLDFdLCJtaW4iOlstMSwtMSwtMV0sInR5cGUiOiJWRUMzIn0seyJidWZmZXJWaWV3IjoxLCJjb21wb25lbnRUeXBlIjo1MTI2LCJjb3VudCI6MjQsInR5cGUiOiJWRUMzIn0seyJidWZmZXJWaWV3IjoyLCJjb21wb25lbnRUeXBlIjo1MTI2LCJjb3VudCI6MjQsInR5cGUiOiJWRUMyIn0seyJidWZmZXJWaWV3IjozLCJjb21wb25lbnRUeXBlIjo1MTIzLCJjb3VudCI6MzYsInR5cGUiOiJTQ0FMQVIifV0sImJ1ZmZlclZpZXdzIjpbeyJidWZmZXIiOjAsImJ5dGVMZW5ndGgiOjI4OCwiYnl0ZU9mZnNldCI6MCwidGFyZ2V0IjozNDk2Mn0seyJidWZmZXIiOjAsImJ5dGVMZW5ndGgiOjI4OCwiYnl0ZU9mZnNldCI6Mjg4LCJ0YXJnZXQiOjM0OTYyfSx7ImJ1ZmZlciI6MCwiYnl0ZUxlbmd0aCI6MTkyLCJieXRlT2Zmc2V0Ijo1NzYsInRhcmdldCI6MzQ5NjJ9LHsiYnVmZmVyIjowLCJieXRlTGVuZ3RoIjo3MiwiYnl0ZU9mZnNldCI6NzY4LCJ0YXJnZXQiOjM0OTYzfV0sImJ1ZmZlcnMiOlt7ImJ5dGVMZW5ndGgiOjg0MH1dfUgDAABCSU4AAACAPwAAgD8AAIA/AACAPwAAgD8AAIA/AACAPwAAgD8AAIA/AACAPwAAgD8AAIC/AACAPwAAgD8AAIC/AACAPwAAgD8AAIC/AACAPwAAgL8AAIA/AACAPwAAgL8AAIA/AACAPwAAgL8AAIA/AACAPwAAgL8AAIC/AACAPwAAgL8AAIC/AACAPwAAgL8AAIC/AACAvwAAgD8AAIA/AACAvwAAgD8AAIA/AACAvwAAgD8AAIA/AACAvwAAgD8AAIC/AACAvwAAgD8AAIC/AACAvwAAgD8AAIC/AACAvwAAgL8AAIA/AACAvwAAgL8AAIA/AACAvwAAgL8AAIA/AACAvwAAgL8AAIC/AACAvwAAgL8AAIC/AACAvwAAgL8AAIC/AAAAAAAAAAAAAIA/AAAAAAAAgD8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgD8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgL8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgL8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgD8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgD8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgL8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgL8AAAAAAACAvwAAAAAAAAAAuth/P7nYfz+22H8/uth/P7XYfz+52H8/uNh/P7nYfz+22H8/ACQdOgASHTq42H8/ACAdOrjYfz+42H8/uth/P7jYfz8AKB06uth/PwAcHToAHB06udh/PwAYHToAHB06uth/PwAoHToAFh06uth/P7bYfz+52H8/ACAdOrbYfz8AIh06ACQdOrrYfz8AKB06ACYdOgAcHTq62H8/ACgdOgAgHTq52H8/ACgdOgAQHToAIB06ABwdOgAgHToAKB06AAAMABIAAAASAAYACgAHABMACgATABYAFwAUAA4AFwAOABEADwADAAkADwAJABUABQACAAgABQAIAAsAEAANAAEAEAABAAQA";var u=A(4859);function f(e,n){e.camera=new i.xNY({transfo:{distance:0},far:100,near:.01,fovy:.25*Math.PI,zoom:.333}),new i.pwt(e,{speedPanning:0,inertiaOrbit:1e3});const A=new i.K7(e,{textureColor0:new i.HTX(e)}),t=new i.K7(e,{textureColor0:new i.HTX(e)}),r=new l;r.texture=new i.HTX(e).loadBitmap(n.image.background);const a=new i.Ipk(e,{depth:i.Eg5.less,children:[new i.o57(e,{color:new i.oao,depth:1}),new i.dRj(e,{asset:n.glb.mesh,material:()=>r})]});A.add(a);const o=new i.D$w(e,{filters:[new i.ChJ({hueShiftInDegrees:90})],texture:A.textureColor0});t.add(o);const s=new i.D$w(e,{texture:A.textureColor0,filters:[new i.HBr({zoom:1.1})],flipY:!0});A.onExit=()=>{o.texture=A.textureColor0},t.onExit=()=>{r.texture=t.textureColor0,s.texture=t.textureColor0},e.add(A,t,s,new i.ZJl(((n,A)=>{const{camera:t}=e;t.transfo.orbitAroundY(A)}))),e.play()}function m(){return(0,t.jsx)(c.A,{onReady:f,assets:{glb:{mesh:d},image:{background:u}}})}const g={"Detail #1":"    context.camera = new TgdCameraPerspective({\n        transfo: { distance: 0 },\n        far: 100,\n        near: 0.01,\n        fovy: Math.PI * 0.25,\n        zoom: 0.333,\n    })\n    new TgdControllerCameraOrbit(context, {\n        speedPanning: 0,\n        inertiaOrbit: 1000,\n    })\n    const framebufferRender = new TgdPainterFramebuffer(context, {\n        textureColor0: new TgdTexture2D(context),\n    })\n    const framebufferCopy = new TgdPainterFramebuffer(context, {\n        textureColor0: new TgdTexture2D(context),\n    })\n    const material = new Material()\n    material.texture = new TgdTexture2D(context).loadBitmap(\n        assets.image.background\n    )\n    const painter = new TgdPainterState(context, {\n        depth: webglPresetDepth.less,\n        // cull: webglPresetCull.front,\n        children: [\n            new TgdPainterClear(context, {\n                color: new TgdVec4(),\n                depth: 1,\n            }),\n            new TgdPainterMeshGltf(context, {\n                asset: assets.glb.mesh,\n                material: () => material,\n            }),\n        ],\n    })\n    framebufferRender.add(painter)\n    const copy = new TgdPainterFilter(context, {\n        filters: [\n            new TgdFilterHueRotation({\n                hueShiftInDegrees: 90,\n            }),\n        ],\n        texture: framebufferRender.textureColor0,\n    })\n    framebufferCopy.add(copy)\n    const screen = new TgdPainterFilter(context, {\n        texture: framebufferRender.textureColor0,\n        filters: [new TgdFilterZoom({ zoom: 1.1 })],\n        flipY: true,\n    })\n    framebufferRender.onExit = () => {\n        copy.texture = framebufferRender.textureColor0\n    }\n    framebufferCopy.onExit = () => {\n        material.texture = framebufferCopy.textureColor0\n        screen.texture = framebufferCopy.textureColor0\n    }\n    context.add(\n        framebufferRender,\n        framebufferCopy,\n        screen,\n        new TgdPainterLogic((time, delay) => {\n            const { camera } = context\n            camera.transfo.orbitAroundY(delay)\n        })\n    )\n    context.play()"},C='import {\n    TgdCameraPerspective,\n    TgdContext,\n    TgdControllerCameraOrbit,\n    TgdFilterHueRotation,\n    TgdFilterZoom,\n    TgdPainterClear,\n    TgdPainterFilter,\n    TgdPainterFramebuffer,\n    TgdPainterLogic,\n    TgdPainterMeshGltf,\n    TgdPainterState,\n    TgdTexture2D,\n    TgdVec4,\n    webglPresetDepth,\n} from "@tolokoban/tgd"\nimport View, { Assets } from "@/components/demo/Tgd"\nimport { Material } from "./material"\n\nimport CubeURL from "@/assets/mesh/cube.glb"\nimport BackgroundURL from "@/assets/image/dino.webp"\n\nfunction init(context: TgdContext, assets: Assets) {\n    context.camera = new TgdCameraPerspective({\n        transfo: { distance: 0 },\n        far: 100,\n        near: 0.01,\n        fovy: Math.PI * 0.25,\n        zoom: 0.333,\n    })\n    new TgdControllerCameraOrbit(context, {\n        speedPanning: 0,\n        inertiaOrbit: 1000,\n    })\n    const framebufferRender = new TgdPainterFramebuffer(context, {\n        textureColor0: new TgdTexture2D(context),\n    })\n    const framebufferCopy = new TgdPainterFramebuffer(context, {\n        textureColor0: new TgdTexture2D(context),\n    })\n    const material = new Material()\n    material.texture = new TgdTexture2D(context).loadBitmap(\n        assets.image.background\n    )\n    const painter = new TgdPainterState(context, {\n        depth: webglPresetDepth.less,\n        // cull: webglPresetCull.front,\n        children: [\n            new TgdPainterClear(context, {\n                color: new TgdVec4(),\n                depth: 1,\n            }),\n            new TgdPainterMeshGltf(context, {\n                asset: assets.glb.mesh,\n                material: () => material,\n            }),\n        ],\n    })\n    framebufferRender.add(painter)\n    const copy = new TgdPainterFilter(context, {\n        filters: [\n            new TgdFilterHueRotation({\n                hueShiftInDegrees: 90,\n            }),\n        ],\n        texture: framebufferRender.textureColor0,\n    })\n    framebufferCopy.add(copy)\n    const screen = new TgdPainterFilter(context, {\n        texture: framebufferRender.textureColor0,\n        filters: [new TgdFilterZoom({ zoom: 1.1 })],\n        flipY: true,\n    })\n    framebufferRender.onExit = () => {\n        copy.texture = framebufferRender.textureColor0\n    }\n    framebufferCopy.onExit = () => {\n        material.texture = framebufferCopy.textureColor0\n        screen.texture = framebufferCopy.textureColor0\n    }\n    context.add(\n        framebufferRender,\n        framebufferCopy,\n        screen,\n        new TgdPainterLogic((time, delay) => {\n            const { camera } = context\n            camera.transfo.orbitAroundY(delay)\n        })\n    )\n    context.play()\n}\n\nexport default function Demo() {\n    return (\n        <View\n            onReady={init}\n            assets={{\n                glb: {\n                    mesh: CubeURL,\n                },\n                image: {\n                    background: BackgroundURL,\n                },\n            }}\n        />\n    )\n}\n';function x(){const[e,n]=a.useState(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"half-left",children:(0,t.jsx)(m,{})}),(0,t.jsxs)("div",{className:"half-right",children:[(0,t.jsx)("div",{children:(0,t.jsx)(o.yQN,{variant:"elevated",onClick:()=>n(!e),children:e?"Show code details":"Show full code"})}),(0,t.jsx)(s.A,{language:"tsx",value:e?C:g})]})]})}function w(e){const n={a:"a",h1:"h1",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.h1,{children:[(0,t.jsx)(n.a,{href:"docs/classes/TgdPainterFramebuffer.html",children:"TgdPainterFramebuffer"})," - Example 2"]}),"\n",(0,t.jsx)(x,{})]})}function b(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(w,{...e})}):w(e)}},7289:(e,n,A)=>{A.d(n,{A:()=>c});var t=A(4848),r=A(6540),a=A(9199),o=A(7402),s=A(3686);const i={Tgd:"hgIjhDQIuBCJEQ4ZgLXp",relative:"efOyHCihw9wfMB6AaAqw",overlay:"ywC8N0Uxbvm2Ug2DwPkE",loading:"PBWSRsbiwEqGpeL0hEfm",screen:"BErChOLWGtciKhh3IFud",canvas:"fT7FcYouYlPbElIAEXRP",gizmo:"uAPfWt_Dhe7RaRrnmIu0"};function c({className:e,options:n,onReady:A,gizmo:c=!1,width:l="640px",height:d="480px",noBorder:u=!1,assets:f,children:m}){const[g,C]=r.useState(!0),[x,w]=r.useState(!1),b=r.useRef(null),h=r.useRef(null),I=r.useRef(null),p=r.useRef(null),[T,j]=r.useState(!0);let v="auto";l.endsWith("px")&&d.endsWith("px")&&(l.substring(l.length-2),d.substring(d.length-2));const y=e=>{if(!e)return;if(h.current)return;h.current=e;const t=new a.tfp(e,n);b.current=t,j(!0),async function({glb:e,data:n,text:A,image:t}={}){console.log("🚀 [Tgd] glb, data, text, image = ",e,n,A,t);const r={glb:{},data:{},text:{},image:{}},o=[];return t&&Object.keys(t).forEach((e=>{o.push((async()=>{const n=t[e];console.log("Loading image:",n);const A=await(0,a.V_9)(n);A&&(r.image[e]=A)}))})),e&&Object.keys(e).forEach((n=>{o.push((async()=>{const A=e[n];console.log("Loading GLB:",A);const t=await(0,a.TCe)(A);t&&(r.glb[n]=t)}))})),n&&Object.keys(n).forEach((e=>{o.push((async()=>{const A=n[e],t=await(0,a.vSU)(A);t&&(r.data[e]=t)}))})),A&&Object.keys(A).forEach((e=>{o.push((async()=>{const n=A[e],t=await(0,a.jWq)(n);t&&(r.text[e]=t)}))})),await Promise.all(o.map((e=>e()))),r}(f).then((e=>{console.log("Ready!"),A(t,e),t.paint(),j(!1)})).catch((e=>{console.error("Unable to initialize the scene!",e),j(!1)}));const r=I.current;r&&r.attachContext(t)},P=e=>{const n=new a.GbF({canvas:e});I.current=n,n.eventTipClick.addListener((({to:e})=>{const n=b.current;console.log("🚀 [tgd] to, context =",e,n),n&&n.animSchedule({duration:.2,easingFunction:a.Wcc,action:(0,a.vRM)(n.camera,{orientation:e})})}));const A=b.current;A&&n.attachContext(A)};return r.useEffect((()=>{const e=h.current,n=b.current;if(!e||!n)return;const A=new ResizeObserver((()=>n.paint()));return A.observe(e),e.requestFullscreen||(e.requestFullscreen=e.webkitRequestFullscreen),w(Boolean(e.requestFullscreen)),()=>A.unobserve(e)}),[b.current,h.current]),u?(0,t.jsxs)("div",{ref:p,className:i.screen,style:{width:g?l:d,height:g?d:l},children:[(0,t.jsx)("canvas",{className:i.canvas,ref:y}),c&&(0,t.jsx)("canvas",{className:i.gizmo,ref:P})]}):(0,t.jsxs)("div",{className:o.Sxu.classNames.join(e,i.Tgd),children:[(0,t.jsxs)(o.sWC,{display:"flex",justifyContent:"space-between",children:[(0,t.jsx)(o.yQN,{variant:"elevated",onClick:()=>C(!g),enabled:!T,children:g?"Switch to Portrait":"Switch to Landscape"}),x&&(0,t.jsx)(o.yQN,{variant:"elevated",onClick:()=>{const e=p.current;e&&e.requestFullscreen()},enabled:!T,children:"Fullscreen"})]}),(0,t.jsxs)("div",{className:i.relative,children:[(0,t.jsxs)("div",{ref:p,className:i.screen,style:{width:g?l:d,height:g?d:l},children:[(0,t.jsx)("canvas",{className:i.canvas,ref:y}),c&&(0,t.jsx)("canvas",{className:i.gizmo,ref:P})]}),(0,t.jsx)("div",{className:o.Sxu.classNames.join(i.overlay,T&&i.loading),children:(0,t.jsx)(s.A,{})}),m]})]})}},8453:(e,n,A)=>{A.d(n,{R:()=>a});var t=A(6540);const r=t.createContext({});function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}}}]);