"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[805],{1278:(e,n,t)=>{e.exports=t.p+"bin/suzanne.d3b099acbd7623177bf6.glb"},3624:(e,n,t)=>{t.r(n),t.d(n,{default:()=>b});var a=t(4848),s=t(8453),r=t(6540),c=t(7781),l=t(9074),i=t(2138),o=t(7289),d=t(4859),u=t(1278);function g(e,n){const t=new i.TgdCameraPerspective({transfo:{distance:5},far:100,near:.01,fovy:Math.PI/4,zoom:1});e.camera=t,new i.TgdControllerCameraOrbit(e,{speedPanning:0,inertiaOrbit:1e3}),e.add(new i.TgdPainterClear(e,{depth:1,stencil:0}),new i.TgdPainterBackground(e,{texture:new i.TgdTexture2D(e).loadBitmap(d)}),new i.TgdPainterState(e,{depth:i.webglPresetDepth.less,cull:i.webglPresetCull.front,children:[new i.TgdPainterMeshGltf(e,{asset:n.glb.suzanne,material:()=>new i.TgdMaterialHull({color:[0,0,0,1],expansion:.05})})]}),new i.TgdPainterState(e,{depth:i.webglPresetDepth.less,cull:i.webglPresetCull.back,children:[new i.TgdPainterMeshGltf(e,{asset:n.glb.suzanne})]})),e.paint()}function h(){return(0,a.jsx)(o.A,{onReady:g,options:{depth:!0,antialias:!0},assets:{glb:{suzanne:u}}})}const x={"Detail #1":"    const camera = new TgdCameraPerspective({\n        transfo: { distance: 5 },\n        far: 100,\n        near: 0.01,\n        fovy: Math.PI / 4,\n        zoom: 1,\n    })\n    ctx.camera = camera\n    new TgdControllerCameraOrbit(ctx, {\n        speedPanning: 0,\n        inertiaOrbit: 1000,\n    })\n    ctx.add(\n        new TgdPainterClear(ctx, {\n            depth: 1,\n            stencil: 0,\n        }),\n        new TgdPainterBackground(ctx, {\n            texture: new TgdTexture2D(ctx).loadBitmap(BackgroundURL),\n        }),\n        new TgdPainterState(ctx, {\n            depth: webglPresetDepth.less,\n            cull: webglPresetCull.front,\n            children: [\n                new TgdPainterMeshGltf(ctx, {\n                    asset: assets.glb.suzanne,\n                    material: () =>\n                        new TgdMaterialHull({\n                            color: [0, 0, 0, 1],\n                            expansion: 0.05,\n                        }),\n                }),\n            ],\n        }),\n        new TgdPainterState(ctx, {\n            depth: webglPresetDepth.less,\n            cull: webglPresetCull.back,\n            children: [\n                new TgdPainterMeshGltf(ctx, {\n                    asset: assets.glb.suzanne,\n                }),\n            ],\n        })\n    )\n    ctx.paint()"},m='import {\n    TgdCameraPerspective,\n    TgdContext,\n    TgdControllerCameraOrbit,\n    TgdMaterialHull,\n    TgdPainterBackground,\n    TgdPainterClear,\n    TgdPainterMeshGltf,\n    TgdPainterState,\n    TgdTexture2D,\n    webglPresetCull,\n    webglPresetDepth,\n} from "@tolokoban/tgd"\nimport View, { Assets } from "@/components/demo/Tgd"\n\nimport BackgroundURL from "@/assets/image/dino.webp"\nimport SuzanneURL from "@/assets/mesh/suzanne.glb"\n\nfunction init(ctx: TgdContext, assets: Assets) {\n    const camera = new TgdCameraPerspective({\n        transfo: { distance: 5 },\n        far: 100,\n        near: 0.01,\n        fovy: Math.PI / 4,\n        zoom: 1,\n    })\n    ctx.camera = camera\n    new TgdControllerCameraOrbit(ctx, {\n        speedPanning: 0,\n        inertiaOrbit: 1000,\n    })\n    ctx.add(\n        new TgdPainterClear(ctx, {\n            depth: 1,\n            stencil: 0,\n        }),\n        new TgdPainterBackground(ctx, {\n            texture: new TgdTexture2D(ctx).loadBitmap(BackgroundURL),\n        }),\n        new TgdPainterState(ctx, {\n            depth: webglPresetDepth.less,\n            cull: webglPresetCull.front,\n            children: [\n                new TgdPainterMeshGltf(ctx, {\n                    asset: assets.glb.suzanne,\n                    material: () =>\n                        new TgdMaterialHull({\n                            color: [0, 0, 0, 1],\n                            expansion: 0.05,\n                        }),\n                }),\n            ],\n        }),\n        new TgdPainterState(ctx, {\n            depth: webglPresetDepth.less,\n            cull: webglPresetCull.back,\n            children: [\n                new TgdPainterMeshGltf(ctx, {\n                    asset: assets.glb.suzanne,\n                }),\n            ],\n        })\n    )\n    ctx.paint()\n}\n\nexport default function Demo() {\n    return (\n        <View\n            onReady={init}\n            options={{\n                depth: true,\n                antialias: true,\n            }}\n            assets={{\n                glb: {\n                    suzanne: SuzanneURL,\n                },\n            }}\n        />\n    )\n}\n';function f(){const[e,n]=r.useState(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"half-left",children:(0,a.jsx)(h,{})}),(0,a.jsxs)("div",{className:"half-right",children:[(0,a.jsx)("div",{children:(0,a.jsx)(c.yQN,{variant:"elevated",onClick:()=>n(!e),children:e?"Show code details":"Show full code"})}),(0,a.jsx)(l.A,{language:"tsx",value:e?m:x})]})]})}function p(e){const n={a:"a",h1:"h1",hr:"hr",li:"li",ol:"ol",p:"p",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{children:"Cull"}),"\n",(0,a.jsx)(n.p,{children:"We can paint FRONT, BACK or BOTH faces. MOst of the time you will only want to\ndisplay FRONT faces because BACK faces should be invisible. But in this demo, we\nuse the back faces to create an effect of outilining of a mesh."}),"\n",(0,a.jsx)(n.p,{children:"This render has three passes:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Paint the background"}),"\n",(0,a.jsx)(n.li,{children:"Paint FRONT faces of the mesh"}),"\n",(0,a.jsx)(n.li,{children:"Paint BACK faces of an expanded (a little bit only) mesh"}),"\n"]}),"\n",(0,a.jsx)(f,{}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"#/articles/state",children:"Back"})})]})}function b(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},4859:(e,n,t)=>{e.exports=t.p+"img/dino.a892a1760dcaac9618a1.webp"},7289:(e,n,t)=>{t.d(n,{A:()=>o});var a=t(4848),s=t(6540),r=t(2138),c=t(7781),l=t(3686);const i={Tgd:"hgIjhDQIuBCJEQ4ZgLXp",relative:"efOyHCihw9wfMB6AaAqw",overlay:"ywC8N0Uxbvm2Ug2DwPkE",loading:"PBWSRsbiwEqGpeL0hEfm",screen:"BErChOLWGtciKhh3IFud",canvas:"fT7FcYouYlPbElIAEXRP",gizmo:"uAPfWt_Dhe7RaRrnmIu0",actions:"Ia9jfUO3OevcIh2fV6R6",enabled:"dZYZScZBbWV2Pm3ftXcG",error:"J6dIEMXVMCzdFWF9UHio"};function o({className:e,options:n,onReady:t,gizmo:o=!1,width:d="640px",height:u="480px",noBorder:g=!1,assets:h,children:x}){const[m,f]=s.useState(null),[p,b]=s.useState(!0),[w,T]=s.useState(!1),P=s.useRef(null),C=s.useRef(null),j=s.useRef(null),v=s.useRef(null),[k,y]=s.useState(!0);let B="auto";d.endsWith("px")&&u.endsWith("px")&&(d.substring(d.length-2),u.substring(u.length-2));const R=e=>{if(!e)return;if(C.current)return;C.current=e;const a=new r.TgdContext(e,n),s=a.gl.getParameter(a.gl.DEPTH_BITS);console.log("Depht buffer bits:",s),P.current=a,y(!0),async function({glb:e,data:n,text:t,image:a}={}){console.log("ðŸš€ [Tgd] glb, data, text, image = ",e,n,t,a);const s={glb:{},data:{},text:{},image:{}},c=[];return a&&Object.keys(a).forEach(e=>{c.push(async()=>{const n=a[e];console.log("Loading image:",n);const t=await(0,r.tgdLoadImage)(n);t&&(s.image[e]=t)})}),e&&Object.keys(e).forEach(n=>{c.push(async()=>{const t=e[n];console.log("Loading GLB:",t);const a=await(0,r.tgdLoadGlb)(t);a&&(s.glb[n]=a)})}),n&&Object.keys(n).forEach(e=>{c.push(async()=>{const t=n[e],a=await(0,r.tgdLoadArrayBuffer)(t);a&&(s.data[e]=a)})}),t&&Object.keys(t).forEach(e=>{c.push(async()=>{const n=t[e],a=await(0,r.tgdLoadText)(n);a&&(s.text[e]=a)})}),await Promise.all(c.map(e=>e())),s}(h).then(e=>{try{t(a,e),a.paint()}catch(e){f(e instanceof Error?e.message:JSON.stringify(e))}y(!1)}).catch(e=>{console.error("Unable to initialize the scene!",e),y(!1)});const c=j.current;c&&c.attachContext(a)},S=e=>{const n=new r.TgdCanvasGizmo({canvas:e});j.current=n,n.eventTipClick.addListener(({to:e})=>{const n=P.current;n&&n.animSchedule({duration:.2,easingFunction:r.tgdEasingFunctionInOutCubic,action:(0,r.tgdActionCreateCameraInterpolation)(n.camera,{orientation:e})})});const t=P.current;t&&n.attachContext(t)};return s.useEffect(()=>{const e=C.current,n=P.current;if(!e||!n)return;const t=new ResizeObserver(()=>n.paint());return t.observe(e),e.requestFullscreen||(e.requestFullscreen=e.webkitRequestFullscreen),T(Boolean(e.requestFullscreen)),()=>t.unobserve(e)},[P.current,C.current]),g?(0,a.jsxs)("div",{ref:v,className:i.screen,style:{width:p?d:u,height:p?u:d},children:[(0,a.jsx)("canvas",{className:i.canvas,ref:R}),o&&(0,a.jsx)("canvas",{className:i.gizmo,ref:S}),m&&(0,a.jsx)("div",{className:i.error,children:m})]}):(0,a.jsxs)("div",{className:c.Sxu.classNames.join(e,i.Tgd),children:[(0,a.jsxs)("div",{className:c.Sxu.classNames.join(i.actions,!k&&i.enabled),children:[(0,a.jsx)("div",{children:(0,a.jsx)(c.I64,{onClick:()=>b(!p)})}),(0,a.jsx)("div",{children:(0,a.jsx)(c.kRc,{onClick:()=>{const e=P.current;e&&e.takeSnapshot().then(e=>{const n=document.createElement("a");document.body.appendChild(n),n.style.display="none",n.href=e.src,n.download="snapshot.png",n.click(),window.setTimeout(()=>document.body.removeChild(n),3e4)})}})}),w&&(0,a.jsx)("div",{children:(0,a.jsx)(c.L9n,{onClick:()=>{const e=v.current;e&&e.requestFullscreen()}})})]}),(0,a.jsxs)("div",{className:i.relative,children:[(0,a.jsxs)("div",{ref:v,className:i.screen,style:{width:p?d:u,height:p?u:d},children:[(0,a.jsx)("canvas",{className:i.canvas,ref:R}),o&&(0,a.jsx)("canvas",{className:i.gizmo,ref:S}),m&&(0,a.jsx)("div",{className:i.error,children:m})]}),(0,a.jsx)("div",{className:c.Sxu.classNames.join(i.overlay,k&&i.loading),children:(0,a.jsx)(l.A,{})}),x]})]})}},8453:(e,n,t)=>{t.d(n,{R:()=>r});var a=t(6540);const s=a.createContext({});function r(e){const n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}}}]);