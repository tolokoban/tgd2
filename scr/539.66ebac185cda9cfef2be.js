"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[539],{8116:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Le});var a=t(4848),s=t(6540),i=t(3608);const r={gltfTree:"XPMLtzXBRVSrxv_Xe50A"};var o=t(2197);function c(e){return(0,o.Xj)(e,{camera:"number"})}const l={node:"NDcVYWtiNdLrATykGHx3"},d={expander:"V3aob0pLE9HcHxN5iVyj",handle:"PbWyyuXizmAAIbcs5urg"},u=i.Sxu.classNames;function m(e){const[n,t]=s.useState(!1),r={...(0,i.$qi)(e),...e.style},o=e.icon;return(0,a.jsxs)("details",{className:u.join(e.className,d.expander),style:r,onToggle:a=>{a.preventDefault(),a.stopPropagation(),t(!n),e.onClick?.()},onClick:e.children?void 0:n=>{n.preventDefault(),n.stopPropagation(),e.onClick?.()},name:e.name,children:[(0,a.jsxs)("summary",{children:[(0,a.jsx)("div",{className:d.handle,children:e.children?n?(0,a.jsx)(i.vpi,{size:"1em"}):(0,a.jsx)(i.DF0,{size:"1em"}):(0,a.jsx)(i.Sg,{size:"1em"})}),o&&(0,a.jsx)(o,{color:"primary-7"}),(0,a.jsx)("span",{children:e.title})]}),(0,a.jsx)("div",{children:e.children})]})}const x=i.Sxu.classNames;function h(e){const n={...(0,i.$qi)(e)},t=e.data.json.nodes?.[e.index];if(!t)return null;const s=t.name??`#${e.index}`,r=function(e){return c(e)?i.PEB:(n=e,(0,o.Xj)(n,{mesh:"number"})?i.Td5:function(e){return(0,o.Xj)(e,{extensions:{KHR_lights_punctual:{light:"number"}}})}(e)?i.H3I:Array.isArray(e.children)?i.MRx:i.dlJ);var n}(t);return(0,a.jsx)(m,{className:x.join(e.className,l.node),name:e.name,style:n,title:s,onClick:()=>{e.onAction?.({type:"node",index:e.index})},icon:r,children:Array.isArray(t.children)&&t.children.map(n=>(0,a.jsx)(h,{data:e.data,index:n,onAction:e.onAction},`#${n}`))})}function j(e){const{nodes:n}=e.data.json;return n?(0,a.jsx)(m,{title:"Nodes",icon:i.MRx,children:n.map((n,t)=>(0,a.jsx)(h,{data:e.data,index:t,onAction:e.onAction},`#${t}`))}):(0,a.jsx)("p",{children:"No nodes."})}i.Sxu.classNames;const f={images:"o4_1rbAB9XmGcjjHG22H"},g=i.Sxu.classNames;function p({className:e,data:n,onAction:t}){return(0,a.jsx)(m,{className:g.join(e,f.images),icon:i.dwH,title:"Images",children:(n.json.images??[]).map((e,n)=>(0,a.jsx)(m,{title:e.name??`#${n}`,onClick:()=>t?.({type:"image",index:n}),children:(0,a.jsxs)("ul",{children:[e.name&&(0,a.jsxs)("li",{children:["Name: ",(0,a.jsx)("b",{children:e.name})]}),e.mimeType&&(0,a.jsxs)("li",{children:["Mime type: ",(0,a.jsx)("b",{children:e.mimeType})]}),e.bufferView&&(0,a.jsxs)("li",{children:["Buffer view: ",(0,a.jsx)("b",{children:e.bufferView})]}),e.uri&&(0,a.jsxs)("li",{children:["URI: ",(0,a.jsx)("b",{children:e.uri})]})]})},n))})}const N={lights:"G3CJ6oAzpvDypk53NREK"},b=i.Sxu.classNames;function y({className:e,data:n,onAction:t}){return(0,a.jsx)(m,{className:b.join(e,N.images),title:"Lights",icon:i.H3I})}function v({data:e,scene:n,title:t,index:s,onAction:r}){return(0,a.jsx)(m,{title:t,icon:i.GtP,onClick:()=>{r?.({index:s,type:"scene"})},children:(n.nodes??[]).map((n,t)=>(0,a.jsx)(h,{data:e,index:t,onAction:r},`node#${t}`))})}function w(e){const{scenes:n}=e.data.json;return n?(0,a.jsx)(m,{title:"Scenes",icon:i.GtP,children:n.map((n,t)=>(0,a.jsx)(v,{data:e.data,scene:n,title:n.name??`Scene #${t}`,index:t,onAction:e.onAction},`Scene#${t}`))}):(0,a.jsx)("p",{children:"No scenes."})}i.Sxu.classNames,i.Sxu.classNames;const A=i.Sxu.classNames;function S(e){const n={...(0,i.$qi)(e)};return(0,a.jsxs)("div",{className:A.join(e.className,r.gltfTree),style:n,children:[(0,a.jsx)(i.yQN,{variant:"text",color:"secondary-5",fullwidth:!0,onClick:(t={type:"verbatim"},()=>e.onAction(t)),children:"Show verbatim content"}),(0,a.jsx)(w,{data:e.data,onAction:e.onAction}),(0,a.jsx)(j,{data:e.data,onAction:e.onAction}),(0,a.jsx)(p,{data:e.data,onAction:e.onAction}),(0,a.jsx)(y,{data:e.data,onAction:e.onAction}),(0,a.jsx)("hr",{}),(0,a.jsx)("a",{href:"https://registry.khronos.org/glTF/specs/2.0/glTF-2.0.html",children:"GLTF 2.0 Specification"})]});var t}var T=t(5667);const C=t.p+"bin/mouse-brain.0f07f8c444858c37e7f8.glb",k={action:"TivnAbABYZdpWW9GZs6n"},M={verbatin:"EOCnuXPaVAQQjOaVzDWk"},$={json:"xo2OgnX2_m3zlxXV2j9k"},I=i.Sxu.classNames;function V(e){const n={...(0,i.$qi)(e)},{value:t}=e;return(0,a.jsxs)("div",{className:I.join(e.className,$.json),style:n,children:[(0,a.jsx)("pre",{children:JSON.stringify(t,O,2)}),(0,a.jsx)(i.yQN,{variant:"outlined",onClick:()=>console.log(t),children:"Write to console"})]})}function O(e,n){return n instanceof Uint8Array?`<<< Uint8Array( ${n.length} ) >>>`:n instanceof Int8Array?`<<< Int8Array( ${n.length} ) >>>`:n instanceof Uint8ClampedArray?`<<< Uint8ClampedArray( ${n.length} ) >>>`:n instanceof Uint16Array?`<<< Uint16Array( ${n.length} ) >>>`:n instanceof Int16Array?`<<< Int16Array( ${n.length} ) >>>`:n instanceof Uint32Array?`<<< Uint32Array( ${n.length} ) >>>`:n instanceof Int32Array?`<<< Int32Array( ${n.length} ) >>>`:n instanceof Float16Array?`<<< Float16Array( ${n.length} ) >>>`:n instanceof Float32Array?`<<< Float32Array( ${n.length} ) >>>`:n}const G=i.Sxu.classNames;function L(e){return(0,a.jsx)(i.sWC,{className:G.join(e.className,M.verbatin),overflow:"auto",fullsize:!0,color:"neutral-1",padding:"S",children:(0,a.jsx)(V,{value:e.data})})}var W=t(9074);const P={actionNodeTransfo:"YXMiTxYNCxTJZifDB0En"},D=i.Sxu.classNames;function U(e){const n={...(0,i.$qi)(e)},t=["const transfo = new TgdTransfo({"];var s;return z(e.node.translation)&&t.push(`  position: [${e.node.translation.join(", ")}],`),s=e.node.rotation,(0,o.Xj)(s,["array","number",{min:4,max:4}])&&t.push(`  orientation: [${e.node.rotation.join(", ")}],`),z(e.node.scale)&&t.push(`  position: [${e.node.scale.join(", ")}],`),t.push("})"),(0,a.jsx)("div",{className:D.join(e.className,P.actionNodeTransfo),style:n,children:(0,a.jsx)(W.A,{language:"ts",value:t.join("\n")})})}function z(e){return(0,o.Xj)(e,["array","number",{min:3,max:3}])}const E={Error:"H0UnrqUJgmcVuhNY9Flo"},B=i.Sxu.classNames;function R({className:e,children:n}){return(0,a.jsx)("div",{className:B.join(e,E.Error),children:n})}const F={actionNodeCamera:"H9dDNSbXjsX6jN3Bf3xh"},X=i.Sxu.classNames;function H(e){const n={...(0,i.$qi)(e)},t=e.data.json.cameras?.[e.node.camera??-1];if(!t)return(0,a.jsx)(R,{children:"No camera found!"});const s=function(e,n){const t=[];return(0,T.isTgdFormatGltfCameraPerspective)(n)&&(t.push("const camera = new TgdCameraPerspective({",`  fovy: ${n.perspective.yfov},  // around ${Math.round((0,T.tgdCalcRadToDeg)(n.perspective.yfov))}Â°`,`  near: ${(0,o.GB)(n.perspective.znear,.001)}`,`  far: ${n.perspective.zfar??"Infinity"}`,"  transfo: {","    distrance: 0,"),e.translation&&t.push(`    position: [${e.translation.join(", ")}],`),e.rotation&&t.push(`    orientation: [${e.rotation.join(", ")}],`),e.scale&&t.push(`    scale: [${e.scale.join(", ")}],`),t.push("  }","})")),t.join("\n")}(e.node,t);return(0,a.jsx)("div",{className:X.join(e.className,F.actionNodeCamera),style:n,children:(0,a.jsx)(W.A,{language:"ts",value:s})})}const _={actionNode:"FHDDVaFyhGXfoGBta3yQ"},q={actionNodeRender:"WlQP8S7OoKQ5p9KJGWab"};var Z=t(7289);function J({data:e,node:n}){const t=function(e,n){return s.useCallback(t=>{const a=K(e,n);t.camera.transfo.position=a.center,t.camera.transfo.distance=2*a.radius,t.camera.far=4*a.radius,t.camera.near=1e-4*t.camera.far,new T.TgdControllerCameraOrbit(t,{inertiaOrbit:1e3,speedZoom:.25*a.radius});const s=new T.TgdPainterClear(t,{color:[.2,.2,.2,1],depth:1}),{painter:i}=(0,T.tgdMakeMeshGlbPainter)({data:e,node:n,context:t});i.debug("nodePainter");const r=new T.TgdPainterState(t,{depth:T.webglPresetDepth.lessOrEqual,children:[i]});t.add(s,r),t.paint()},[e,n])}(e,n);return(0,a.jsx)("div",{className:q.actionNodeRender,children:(0,a.jsx)(Z.A,{onReady:t,width:"100%",height:"100%",gizmo:!0,noBorder:!0},JSON.stringify(n))})}function K(e,n){const t=[];(0,o.Et)(n.mesh)&&t.push(Y(function(e,n){const t=e.getMesh(n);if(!t)return[{center:new T.TgdVec3,radius:1}];const a=[];for(const n of t.primitives){const t=e.getAccessorByAttributeName(n,"POSITION");if(Q(t.min)&&Q(t.max)){const[e,n,s]=t.min,[i,r,o]=t.max;a.push({center:T.TgdVec3.newFromMix(t.min,t.max),radius:Math.max(Math.abs(i-e),Math.abs(r-n),Math.abs(o-s))})}}return a}(e,n.mesh)));for(const a of n.children??[]){const n=e.getNode(a);t.push(K(e,n))}return function(e,n){const[t,a,s]=e.center,i=new T.TgdVec4(t,a,s,1),r={};n.translation&&(r.position=n.translation),n.rotation&&(r.orientation=n.rotation),n.scale&&(r.scale=n.scale);const o=new T.TgdTransfo(r);i.applyMatrix(o.matrix);const[c,l,d]=o.scale,u=Math.max(c,l,d);return{center:new T.TgdVec3(i.x,i.y,i.z),radius:e.radius*u}}(Y(t),n)}function Q(e){return(0,o.Xj)(e,["array","number",{min:3,max:3}])}function Y(e){if(0===e.length)return{center:new T.TgdVec3,radius:1};let n=0,t=0,a=0;for(const{center:s}of e){const[e,i,r]=s;n+=e,t+=i,a+=r}const s=e.length;n/=s,t/=s,a/=s;const i=new T.TgdVec3(n,t,a);let r=0;for(const{center:n,radius:t}of e)r=Math.max(r,t+T.TgdVec3.distance(i,new T.TgdVec3(n)));return{center:i,radius:r}}i.Sxu.classNames;const ee={value:"n8pRiWUyv_1Af5HOwG4n"},ne=i.Sxu.classNames;function te(e){const n={...(0,i.$qi)(e)},{value:t,label:s,lookup:r=!1}=e;return(0,o.Et)(t)&&r?(0,a.jsxs)("div",{className:ne.join(e.className,ee.value),style:n,children:[s&&(0,a.jsxs)("label",{children:[s,":"]}),(0,a.jsxs)("div",{children:["gl.",(0,a.jsx)("b",{children:(0,T.webglLookup)(t)})]})]}):(0,a.jsxs)("div",{className:ne.join(e.className,ee.value),style:n,children:[s&&(0,a.jsxs)("label",{children:[s,":"]}),(0,a.jsx)(ae,{value:t})]})}function ae({value:e}){return void 0===e?(0,a.jsx)("em",{children:"undefined"}):null===e?(0,a.jsx)("em",{children:"null"}):(0,a.jsx)("b",{children:JSON.stringify(e)})}const se={accessor:"NNZXZp9wvxpD6763MYUF"},ie={data:"ae9NgxUT0l3kQ0p7fMhd",grid:"hL8SKLHUfwy3P4rI8vII",row:"bZX5lLCGfnCnr1Nzua0X"},re=i.Sxu.classNames;function oe({className:e,buffer:n,type:t,componentType:s,onClose:r}){const o=function(e,n){switch(n){case WebGL2RenderingContext.FLOAT:return new Float32Array(e);case WebGL2RenderingContext.HALF_FLOAT:return new Float16Array(e);case WebGL2RenderingContext.HIGH_FLOAT:return new Float64Array(e);case WebGL2RenderingContext.UNSIGNED_BYTE:return new Uint8Array(e);case WebGL2RenderingContext.UNSIGNED_SHORT:return new Uint16Array(e);case WebGL2RenderingContext.UNSIGNED_INT:return new Uint32Array(e);default:throw new Error(`Don't know how to interpret ${(0,T.webglLookup)(n)}!`)}}(n,s),c=ce(function(e){switch(e.toLowerCase()){case"float":case"scalar":default:return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4}}(t)),l=ce(Math.ceil(o.length/c.length));return(0,a.jsxs)(i.UkC,{className:re.join(e,ie.data),template:"*1",children:[(0,a.jsxs)(i.sWC,{color:"primary-5",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"M",padding:"S",children:[(0,a.jsxs)("div",{children:["Attributes: ",(0,a.jsx)("b",{children:l.length})]}),(0,a.jsx)("div",{children:t}),(0,a.jsxs)("div",{children:["gl.",(0,T.webglLookup)(s)]}),(0,a.jsx)(i.gzW,{onClick:r})]}),(0,a.jsx)(i.sWC,{overflow:"auto",color:"neutral-1",padding:"S",children:(0,a.jsx)("div",{className:ie.grid,style:{"--custom-columns":c.length},children:l.slice(0,100).map(e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:ie.row,children:e},`${e}`),c.map(n=>(0,a.jsx)("div",{children:o[n+e*c.length]},`${e}/${n}`))]}))})})]})}function ce(e){const n=new Array(e);for(let t=0;t<e;t++)n[t]=t;return n}const le=i.Sxu.classNames;function de(e){const n=s.useRef(null),[t,r]=s.useState(!1);s.useEffect(()=>{const e=n.current;e&&(t?e.showModal():e.close())},[t]);const c={...(0,i.$qi)(e)},{data:l,index:d}=e,u=l.getAccessor(d);return(0,a.jsxs)(m,{className:le.join(e.className,se.accessor),style:c,title:`Accessor #${d}`,children:[(0,a.jsx)(te,{label:"name",value:u.name}),(0,a.jsx)(te,{label:"type",value:u.type}),(0,a.jsx)(te,{label:"componentType",value:u.componentType,lookup:!0}),(0,a.jsx)(te,{label:"count",value:u.count}),(0,a.jsx)(te,{label:"bufferView",value:u.bufferView}),(0,a.jsx)(te,{label:"byteOffset",value:u.byteOffset}),(0,a.jsx)(te,{label:"normalized",value:u.normalized}),(0,a.jsx)(te,{label:"min",value:u.min}),(0,a.jsx)(te,{label:"max",value:u.max}),(0,o.Et)(u.bufferView)&&(0,a.jsx)(i.yQN,{variant:"outlined",onClick:()=>r(!0),children:"Show data"}),(0,a.jsx)("dialog",{ref:n,children:t&&(0,a.jsx)(i.sWC,{children:(0,a.jsx)(oe,{buffer:l.getBufferViewData(u).buffer,type:u.type,componentType:u.componentType,onClose:()=>r(!1)})})})]})}const ue={actionNodeMesh:"p9Kbtkuegy0iOh66GNDX"},me=i.Sxu.classNames;function xe({className:e,data:n,meshIndexOrName:t}){const s=n.getMesh(t);if(!s)return(0,a.jsxs)(R,{children:["No mesh found with index #",t,"!"]});const{primitives:i}=s;return(0,a.jsx)("div",{className:me.join(e,ue.actionNodeMesh),children:(0,a.jsx)("ul",{children:i.map((e,t)=>(0,a.jsxs)("li",{children:[(0,a.jsxs)("b",{children:["Primitive ",t]}),(0,a.jsx)(m,{title:"Attributes",children:Object.keys(e.attributes).map(t=>{const s=e.attributes[t];return(0,a.jsx)(m,{title:t,children:(0,o.Et)(s)?(0,a.jsx)(de,{data:n,index:s}):(0,a.jsx)(V,{value:s})},t)})}),(0,a.jsxs)(m,{title:"Indices",children:[e.indices&&((0,o.Et)(e.indices)?(0,a.jsx)(de,{data:n,index:e.indices}):(0,a.jsx)(V,{value:e.indices})),!e.indices&&(0,a.jsx)("div",{children:"No indices..."})]}),(e.material??-1)>-1&&(0,a.jsx)(m,{title:(0,a.jsxs)("div",{children:["Material"," ",(0,a.jsx)("b",{children:n.getMaterial(e.material??-1)?.name??"Material"})]}),children:(0,o.Et)(e.material)&&(0,a.jsx)(V,{value:n.getMaterial(e.material)})}),(0,a.jsx)(m,{title:"Verbatim",children:(0,a.jsx)(V,{value:s})})]},t))})})}const he=i.Sxu.classNames;function je(e){const n={...(0,i.$qi)(e)},t=e.data.json.nodes?.[e.index];return t?(0,a.jsxs)(i.UkC,{orientation:"column",template:"-1",className:he.join(e.className,_.actionNode),fullsize:!0,children:[(0,a.jsx)(i.sWC,{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"M",color:"primary-5",padding:"S",children:(0,a.jsxs)("div",{children:["Node #",e.index,":"," ",(0,a.jsx)("b",{children:t.name??(0,a.jsx)("em",{children:"anonymous"})})]})}),(0,a.jsx)(i.sWC,{style:n,children:(0,a.jsxs)(i.WET,{fullsize:!0,children:[(0,a.jsx)(i.Zdo,{label:"3D View",children:!c(t)&&(0,a.jsx)(J,{data:e.data,node:t})},"render"),(0,a.jsx)(i.Zdo,{label:"Camera",children:c(t)&&(0,a.jsx)(H,{data:e.data,node:t})},"camera"),(0,a.jsx)(i.Zdo,{label:"Transformation",children:(0,a.jsx)(U,{node:t})},"transfo"),(0,a.jsx)(i.Zdo,{label:"Mesh",children:(0,o.Et)(t.mesh)&&(0,a.jsx)(xe,{data:e.data,meshIndexOrName:t.mesh})},"mesh"),(0,a.jsx)(i.Zdo,{label:"Verbatim",children:(0,a.jsx)("pre",{children:JSON.stringify(t,null,"  ")})},"verbatim")]})})]}):null}const fe={fileSize:"MKULJkv5mj0S_xY8htf8",bytes:"F7WZfPxY1S7i0Hjtucc7",Kb:"D9DRrGtnrbf1nOgNQWyG",Mb:"h0ieIogaTKV3gw0BUni6"},ge=i.Sxu.classNames;function pe(e){const n={...(0,i.$qi)(e)},[t,s]=(r=e.value)<1024?[r,"bytes"]:r<1048576?[r/1024,"Kb"]:[r/1048576,"Mb"];var r;return(0,a.jsxs)("div",{className:ge.join(e.className,fe.fileSize,fe[s]),style:n,children:[Math.round(t)," ",s]})}const Ne=t.p+"img/checkboard-light.a7a1229bc8b42ce5b9d3.jpg",be=t.p+"img/checkboard-dark.9d3dacc5286db0915472.jpg",ye={actionImage:"C9I4sL1N2ssiuRkPggbA",dimensions:"v6mssTjMLNc8Ogj4uBSq",link:"lHntNRydftoMSCTh5gwv",mimeType:"Z3MostVbq5he_JIIndWa"},ve=i.Sxu.classNames;function we({data:e,index:n}){const[t,r]=s.useState("light"),[o,c]=s.useState(null),[l,d]=s.useState(null),[u,m]=s.useState(void 0),x=function(e,n){return s.useMemo(()=>{if(!n)return 0;const t=e.getBufferView(n.bufferView??-1);return t?t.byteLength:0},[e,n])}(e,u),[h,j]=s.useState(null),f=s.useCallback((t,a)=>{j(null);const s=new T.TgdPainterClear(t,{color:[0,0,0,0]});t.add(s),t.paint(),m(e.getImage(n));const i=e.getImageAsHTMLElement(n);if(!i)return;c(i),d([i.width,i.height]);const r=new T.TgdTexture2D(t).loadBitmap(i),o=new T.TgdPainterBackground(t,{mode:"contain",texture:r});t.add(o),t.paint()},[e,n]);return(0,a.jsxs)("div",{className:ve.join(ye.actionImage),style:{backgroundImage:`url(${"dark"===t?be:Ne})`},children:[h?(0,a.jsx)(R,{children:h}):(0,a.jsx)(Z.A,{options:{alpha:!0},onReady:f,noBorder:!0,width:"100%",height:"100%"},JSON.stringify(e.getImage(n))),(0,a.jsxs)("header",{children:[(0,a.jsx)("div",{className:ye.dimensions,children:l?.join(" Ã— ")}),x>0&&(0,a.jsx)(pe,{value:x}),u&&(0,a.jsx)("div",{className:ye.mimeType,children:u.mimeType}),(0,a.jsxs)(i.si8,{value:t,onChange:r,children:[(0,a.jsx)("div",{children:"Light"},"light"),(0,a.jsx)("div",{children:"Dark"},"dark")]}),(0,a.jsx)("div",{className:ye.link,children:o&&(0,a.jsx)("a",{href:o.src,target:"_blank",children:"Open in new tab"})})]})]})}const Ae={actionScene:"IUOTuyuq_tmmW8h_lBpp"},Se=i.Sxu.classNames;function Te({data:e,index:n}){const t=e.json.scenes?.[n],i=function(e,n){return s.useCallback(t=>{if(!n)return void console.error("No Scene!");console.log("ðŸš€ [ActionScene] context =",t);const a=new T.TgdPainterNode({children:(n.nodes??[]).filter(n=>{const t=e.getNode(n);return(0,o.Et)(t.mesh)||Array.isArray(t.children)&&t.children.length>0}).map(n=>(0,T.tgdMakeMeshGlbPainter)({data:e,node:n,context:t}).painter),name:n.name??"Scene"});a.debug();const s=Me((n.nodes??[]).map(n=>Ce(e,e.getNode(n))));t.camera.transfo.position=s.center,t.camera.transfo.distance=2*s.radius,t.camera.far=5*s.radius,t.camera.far=1e-5*t.camera.near,new T.TgdControllerCameraOrbit(t,{inertiaOrbit:1e3,speedZoom:.25*s.radius});const i=new T.TgdPainterClear(t,{color:[.2,.2,.2,1],depth:1}),r=new T.TgdPainterState(t,{depth:T.webglPresetDepth.lessOrEqual,children:[a]});t.add(i,r),t.paint()},[e,n])}(e,t);return t?(0,a.jsx)("div",{className:Se.join(Ae.actionScene),children:(0,a.jsx)(Z.A,{onReady:i,width:"100%",height:"100%",gizmo:!0,noBorder:!0},JSON.stringify(t))}):(0,a.jsx)("p",{children:"No scene..."})}function Ce(e,n){const t=[];(0,o.Et)(n.mesh)&&t.push(Me(function(e,n){const t=e.getMesh(n);if(!t)return[{center:new T.TgdVec3,radius:1}];const a=[];for(const n of t.primitives){const t=e.getAccessorByAttributeName(n,"POSITION");if(ke(t.min)&&ke(t.max)){const[e,n,s]=t.min,[i,r,o]=t.max;a.push({center:T.TgdVec3.newFromMix(t.min,t.max),radius:Math.max(Math.abs(i-e),Math.abs(r-n),Math.abs(o-s))})}}return a}(e,n.mesh)));for(const a of n.children??[]){const n=e.getNode(a);t.push(Ce(e,n))}return function(e,n){const[t,a,s]=e.center,i=new T.TgdVec4(t,a,s,1),r={};n.translation&&(r.position=n.translation),n.rotation&&(r.orientation=n.rotation),n.scale&&(r.scale=n.scale);const o=new T.TgdTransfo(r);i.applyMatrix(o.matrix);const[c,l,d]=o.scale,u=Math.max(c,l,d);return{center:new T.TgdVec3(i.x,i.y,i.z),radius:e.radius*u}}(Me(t),n)}function ke(e){return(0,o.Xj)(e,["array","number",{min:3,max:3}])}function Me(e){if(0===e.length)return{center:new T.TgdVec3,radius:1};let n=0,t=0,a=0;for(const{center:s}of e){const[e,i,r]=s;n+=e,t+=i,a+=r}const s=e.length;n/=s,t/=s,a/=s;const i=new T.TgdVec3(n,t,a);let r=0;for(const{center:n,radius:t}of e)r=Math.max(r,t+T.TgdVec3.distance(i,new T.TgdVec3(n)));return{center:i,radius:r}}const $e=i.Sxu.classNames;function Ie(e){const n={...(0,i.$qi)(e)};switch(e.action.type){case"scene":return(0,a.jsx)(Te,{data:e.data,index:e.action.index});case"verbatim":return(0,a.jsx)(L,{data:e.data});case"node":return(0,a.jsx)(je,{data:e.data,index:e.action.index});case"image":return(0,a.jsx)(we,{data:e.data,index:e.action.index});default:return(0,a.jsxs)("div",{className:$e.join(e.className,k.action),style:n,children:["Don't know what to do with this action:"," ",(0,a.jsx)("pre",{children:JSON.stringify(e.action,null,"  ")}),"."]})}}const Ve={viewgltf:"jgtK2RMH89K4DKGqzXgk"},Oe=i.Sxu.classNames;function Ge(e){const[n,t]=s.useState({type:"verbatim"}),[r,o]=function(){const[e,n]=s.useState(null),t=s.useCallback(e=>{(0,T.tgdLoadArrayBuffer)(e).then(e=>{e&&T.TgdDataGlb.parse(e).then(n)}).catch(console.error)},[n]);return s.useEffect(()=>{t(C)},[]),[e,t]}();return s.useState(null),(0,a.jsxs)(i.UkC,{className:Oe.join(e.className,Ve.viewgltf),template:"*1",orientation:"row",fullsize:!0,gap:"8px",children:[(0,a.jsxs)(i.UkC,{template:"*1",orientation:"column",children:[(0,a.jsxs)(i.sWC,{color:"primary-5",display:"flex",justifyContent:"space-between",alignItems:"center",padding:["S","M"],minWidth:"300px",gap:"M",children:[(0,a.jsx)("div",{children:"GLB Viewer"}),r&&(0,a.jsxs)("em",{children:[Math.floor(r.fileSize/1024)," Kb"]}),(0,a.jsx)(i.e3B,{accept:"glb",onLoad:function(e){const[n]=e;n&&o(n)},children:(0,a.jsx)(i.Thu,{})})]}),(0,a.jsxs)(i.sWC,{overflow:"auto",minHeight:"auto",color:"neutral-5",padding:"S",children:[!r&&(0,a.jsx)("div",{children:"Loading..."}),r&&(0,a.jsx)(S,{data:r,onAction:t})]})]}),r&&(0,a.jsx)(i.sWC,{position:"relative",overflow:"auto",fullsize:!0,children:(0,a.jsx)(Ie,{action:n,data:r})})]})}function Le(){return(0,a.jsx)(Ge,{})}}}]);