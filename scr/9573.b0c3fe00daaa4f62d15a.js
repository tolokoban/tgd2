"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[9573],{2197:(e,t,n)=>{function r(e){return!!e&&!Array.isArray(e)&&"object"==typeof e}function o(e){return"number"==typeof e}function a(e,t,n=null){try{return s(e,t),!0}catch(t){return n&&(console.error("[Invalid type]",n),console.error(e),console.debug(t)),!1}}function s(e,t,n="data"){if("function"==typeof t)return s(e,t(),n);if("unknown"===t)return;if("null"===t){if(null!==e)throw console.log("ðŸš€ [index] data = ",e,typeof e),Error(`Expected ${n} to be a null and not a ${l(e)}!`);return}if("string"==typeof t){if(typeof e!==t)throw Error(`Expected ${n} to be a ${t} and not a ${l(e)}!`);return}if(Array.isArray(t)){const[a]=t;switch(a){case"array":return void function(e,t,n){if(!Array.isArray(e))throw Error(`Expected ${t} to be an array and not a ${l(e)}!`);const[,r,a]=n;if(a){const n=e.length;if(o(a)){if(n!==a)throw Error(`Expected ${t}'s length to be ${a} and not ${n}!`)}else{const{min:e,max:r}=a;if(o(e)&&n<e)throw Error(`Expected ${t}'s MIN length to be ${e} and not ${n}!`);if(o(r)&&n>r)throw Error(`Expected ${t}'s MAX length to be ${r} and not ${n}!`)}}for(let n=0;n<e.length;n+=1)s(e[n],r,`${t}[${n}]`)}(e,n,t);case"map":return void function(e,t,n){if(!r(e))throw Error(`Expected ${t} to be an object and not a ${l(e)}!`);const[,o]=n;for(const n of Object.keys(e))"string"==typeof n&&s(e[n],o,`${t}[${n}]`)}(e,n,t);case"?":return void function(e,t,n){if(void 0===e)return;const[,r]=n;s(e,r,t)}(e,n,t);case"|":return void function(e,t,n){const[,...r]=n;if(0===r.length)throw Error(`No type has been defined for this alternative: ${JSON.stringify(n)}!`);const o=[];for(const n of r)try{return void s(e,n,t)}catch(e){e instanceof Error&&o.push(e)}throw new Error(`All alternatives failed!${o.map(e=>`\n${e.message}`)}`)}(e,n,t);case"tuple":return void c(e,n,t);case"tuple...":return void function(e,t,[,...n]){const r=n.length-1;c(e,t,["tuple",...n.slice(0,r)]);const o=n[r];for(let n=r;n<e.length;n++)s(e[n],o,`${t}[${n}]`)}(e,n,t);case"partial":return void function(e,t,[,n]){!function(e,t="data"){if(!r(e))throw Error(`${t} was expected to be an object but we got ${typeof e}!`)}(e,t);for(const r of Object.keys(n)){if("string"!=typeof r)continue;const o=e[r];void 0!==o&&s(o,n[r],`${t}.${r}`)}}(e,n,t);case"literal":return void function(e,t,n){const[,...r]=n;for(const t of r)if(e===t)return;throw Error(`Expected ${t} to be a literal (${r.map(e=>`"${e}"`).join(" | ")}) and not a ${l(e)}!`)}(e,n,t);case"custom":return void function(e,t,[,n]){if(!n(e))throw Error(`Expected ${n.name}(${t}) to return true!`)}(e,n,t);default:throw Error(`Don't know how to create a type guard for this kind of type: ${JSON.stringify(t)}`)}}if("object"!=typeof e)throw Error(`Expected ${n} to be an object and not a ${l(e)}!`);const a=e;for(const e of Object.keys(t))"string"==typeof e&&s(a[e],t[e],`${n}.${e}`)}function c(e,t,[,...n]){if(function(e,t="data"){if(!Array.isArray(e))throw Error(`${t} was expected to be an Array but we got ${typeof e}!`)}(e),n.length>e.length)throw Error(`Expected ${t}'s length to be at least ${n.length} and not ${e.length}!`);for(let r=0;r<n.length;r++){const o=n[r];s(e[r],o,`${t}[${r}]`)}}function i(e,t){return function(e,t,n){return a(e,t)?e:a(n,t)?n:n(e)}(e,"number",t)}function l(e){var t;return null===e?"null":"function"==typeof e?`function ${null!==(t=e.name)&&void 0!==t?t:""}()`:typeof e}n.d(t,{Et:()=>o,GB:()=>i,Xj:()=>a,j:()=>s})},7289:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(4848),o=n(6540),a=n(4447),s=n(3608),c=n(3686);const i={Tgd:"hgIjhDQIuBCJEQ4ZgLXp",relative:"efOyHCihw9wfMB6AaAqw",overlay:"ywC8N0Uxbvm2Ug2DwPkE",loading:"PBWSRsbiwEqGpeL0hEfm",screen:"BErChOLWGtciKhh3IFud",canvas:"fT7FcYouYlPbElIAEXRP",gizmo:"uAPfWt_Dhe7RaRrnmIu0",actions:"Ia9jfUO3OevcIh2fV6R6",enabled:"dZYZScZBbWV2Pm3ftXcG",error:"J6dIEMXVMCzdFWF9UHio"};function l({className:e,options:t,onReady:n,gizmo:l=!1,width:u="640px",height:d="480px",noBorder:f=!1,assets:h,controller:g,children:p}){const[b,m]=o.useState(null),[y,v]=o.useState(!0),[x,$]=o.useState(!1),w=o.useRef(null),E=o.useRef(null),j=o.useRef(null),C=o.useRef(null),k=o.useRef(null),[N,A]=o.useState(!0);let O="auto";u.endsWith("px")&&d.endsWith("px")&&(u.substring(u.length-2),d.substring(d.length-2));const S=e=>{if(!e)return;if(E.current)return;E.current=e;const r=new a.TgdContext(e,t),o=r.gl.getParameter(r.gl.DEPTH_BITS);console.log("Depht buffer bits:",o),w.current=r,A(!0),async function({glb:e,data:t,text:n,image:r}={}){console.log("ðŸš€ [Tgd] glb, data, text, image = ",e,t,n,r);const o={glb:{},data:{},text:{},image:{}},s=[];return r&&Object.keys(r).forEach(e=>{s.push(async()=>{const t=r[e];console.log("Loading image:",t);const n=await(0,a.tgdLoadImage)(t);n&&(o.image[e]=n)})}),e&&Object.keys(e).forEach(t=>{s.push(async()=>{const n=e[t];console.log("Loading GLB:",n);const r=await(0,a.tgdLoadGlb)(n);r&&(o.glb[t]=r)})}),t&&Object.keys(t).forEach(e=>{s.push(async()=>{const n=t[e],r=await(0,a.tgdLoadArrayBuffer)(n);r&&(o.data[e]=r)})}),n&&Object.keys(n).forEach(e=>{s.push(async()=>{const t=n[e],r=await(0,a.tgdLoadText)(t);r&&(o.text[e]=r)})}),await Promise.all(s.map(e=>e())),o}(h).then(e=>{try{if(g){const e=new a.TgdControllerCameraOrbit(r,{inertiaOrbit:1e3,inertiaZoom:500,inertiaPanning:500,...g});k.current=e,r.inputs.pointer.eventTapMultiple.addListener(t=>{console.log("ðŸš€ [tgd] evt.tapsCount =",t.tapsCount),t.preventTap(),2===t.tapsCount&&e.reset(.001*(g.inertiaOrbit??500))})}n(r,e),r.paint()}catch(e){m(e instanceof Error?e.message:JSON.stringify(e))}A(!1)}).catch(e=>{console.error("Unable to initialize the scene!",e),A(!1)});const s=j.current;s&&s.attachContext(r)},I=e=>{const t=new a.TgdCanvasGizmo({canvas:e});j.current=t,t.eventTipClick.addListener(({to:e})=>{const t=w.current;t&&t.animSchedule({duration:.2,easingFunction:a.tgdEasingFunctionInOutCubic,action:(0,a.tgdActionCreateCameraInterpolation)(t.camera,{orientation:e})})});const n=w.current;n&&t.attachContext(n)};return o.useEffect(()=>{const e=E.current,t=w.current;if(!e||!t)return;const n=new ResizeObserver(()=>t.paint());return n.observe(e),e.requestFullscreen||(e.requestFullscreen=e.webkitRequestFullscreen),$(Boolean(e.requestFullscreen)),()=>n.unobserve(e)},[w.current,E.current]),f?(0,r.jsxs)("div",{ref:C,className:i.screen,style:{width:y?u:d,height:y?d:u},children:[(0,r.jsx)("canvas",{className:i.canvas,ref:S}),l&&(0,r.jsx)("canvas",{className:i.gizmo,ref:I}),b&&(0,r.jsx)("div",{className:i.error,children:b})]}):(0,r.jsxs)("div",{className:s.Sxu.classNames.join(e,i.Tgd),children:[(0,r.jsxs)("div",{className:s.Sxu.classNames.join(i.actions,!N&&i.enabled),children:[(0,r.jsx)("div",{children:(0,r.jsx)(s.I64,{onClick:()=>v(!y)})}),(0,r.jsx)("div",{children:(0,r.jsx)(s.kRc,{onClick:()=>{const e=w.current;e&&e.takeSnapshot().then(e=>{const t=document.createElement("a");document.body.appendChild(t),t.style.display="none",t.href=e.src,t.download="snapshot.png",t.click(),window.setTimeout(()=>document.body.removeChild(t),3e4)})}})}),x&&(0,r.jsx)("div",{children:(0,r.jsx)(s.L9n,{onClick:()=>{const e=C.current;e&&e.requestFullscreen()}})}),g&&(0,r.jsx)("div",{children:(0,r.jsx)(s.zgT,{onClick:()=>{const e=k.current,t=w.current;t&&e&&(e.cameraInitialState=t.camera.getCurrentState(),e.resetZoom())}})})]}),(0,r.jsxs)("div",{className:i.relative,children:[(0,r.jsxs)("div",{ref:C,className:i.screen,style:{width:y?u:d,height:y?d:u},children:[(0,r.jsx)("canvas",{className:i.canvas,ref:S}),l&&(0,r.jsx)("canvas",{className:i.gizmo,ref:I}),b&&(0,r.jsx)("div",{className:i.error,children:b})]}),(0,r.jsx)("div",{className:s.Sxu.classNames.join(i.overlay,N&&i.loading),children:(0,r.jsx)(c.A,{})}),p]})]})}}}]);