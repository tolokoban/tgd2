"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[6023],{1839:e=>{e.exports="data:model/gltf-binary;base64,Z2xURgIAAADABgAAXAMAAEpTT057ImFzc2V0Ijp7ImdlbmVyYXRvciI6Iktocm9ub3MgZ2xURiBCbGVuZGVyIEkvTyB2NC4zLjQ3IiwidmVyc2lvbiI6IjIuMCJ9LCJzY2VuZSI6MCwic2NlbmVzIjpbeyJuYW1lIjoiU2NlbmUiLCJub2RlcyI6WzBdfV0sIm5vZGVzIjpbeyJtZXNoIjowLCJuYW1lIjoiQ3ViZSJ9XSwibWVzaGVzIjpbeyJuYW1lIjoiQ3ViZSIsInByaW1pdGl2ZXMiOlt7ImF0dHJpYnV0ZXMiOnsiUE9TSVRJT04iOjAsIk5PUk1BTCI6MSwiVEVYQ09PUkRfMCI6Mn0sImluZGljZXMiOjN9XX1dLCJhY2Nlc3NvcnMiOlt7ImJ1ZmZlclZpZXciOjAsImNvbXBvbmVudFR5cGUiOjUxMjYsImNvdW50IjoyNCwibWF4IjpbMSwxLDFdLCJtaW4iOlstMSwtMSwtMV0sInR5cGUiOiJWRUMzIn0seyJidWZmZXJWaWV3IjoxLCJjb21wb25lbnRUeXBlIjo1MTI2LCJjb3VudCI6MjQsInR5cGUiOiJWRUMzIn0seyJidWZmZXJWaWV3IjoyLCJjb21wb25lbnRUeXBlIjo1MTI2LCJjb3VudCI6MjQsInR5cGUiOiJWRUMyIn0seyJidWZmZXJWaWV3IjozLCJjb21wb25lbnRUeXBlIjo1MTIzLCJjb3VudCI6MzYsInR5cGUiOiJTQ0FMQVIifV0sImJ1ZmZlclZpZXdzIjpbeyJidWZmZXIiOjAsImJ5dGVMZW5ndGgiOjI4OCwiYnl0ZU9mZnNldCI6MCwidGFyZ2V0IjozNDk2Mn0seyJidWZmZXIiOjAsImJ5dGVMZW5ndGgiOjI4OCwiYnl0ZU9mZnNldCI6Mjg4LCJ0YXJnZXQiOjM0OTYyfSx7ImJ1ZmZlciI6MCwiYnl0ZUxlbmd0aCI6MTkyLCJieXRlT2Zmc2V0Ijo1NzYsInRhcmdldCI6MzQ5NjJ9LHsiYnVmZmVyIjowLCJieXRlTGVuZ3RoIjo3MiwiYnl0ZU9mZnNldCI6NzY4LCJ0YXJnZXQiOjM0OTYzfV0sImJ1ZmZlcnMiOlt7ImJ5dGVMZW5ndGgiOjg0MH1dfUgDAABCSU4AAACAPwAAgD8AAIA/AACAPwAAgD8AAIA/AACAPwAAgD8AAIA/AACAPwAAgD8AAIC/AACAPwAAgD8AAIC/AACAPwAAgD8AAIC/AACAPwAAgL8AAIA/AACAPwAAgL8AAIA/AACAPwAAgL8AAIA/AACAPwAAgL8AAIC/AACAPwAAgL8AAIC/AACAPwAAgL8AAIC/AACAvwAAgD8AAIA/AACAvwAAgD8AAIA/AACAvwAAgD8AAIA/AACAvwAAgD8AAIC/AACAvwAAgD8AAIC/AACAvwAAgD8AAIC/AACAvwAAgL8AAIA/AACAvwAAgL8AAIA/AACAvwAAgL8AAIA/AACAvwAAgL8AAIC/AACAvwAAgL8AAIC/AACAvwAAgL8AAIC/AAAAAAAAAAAAAIA/AAAAAAAAgD8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgD8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgL8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgL8AAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgD8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgD8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIA/AAAAAAAAgL8AAAAAAACAvwAAAAAAAAAAAAAAAAAAAAAAAIC/AAAAAAAAgL8AAAAAAACAvwAAAAAAAAAAuth/P7nYfz+22H8/uth/P7XYfz+52H8/uNh/P7nYfz+22H8/ACQdOgASHTq42H8/ACAdOrjYfz+42H8/uth/P7jYfz8AKB06uth/PwAcHToAHB06udh/PwAYHToAHB06uth/PwAoHToAFh06uth/P7bYfz+52H8/ACAdOrbYfz8AIh06ACQdOrrYfz8AKB06ACYdOgAcHTq62H8/ACgdOgAgHTq52H8/ACgdOgAQHToAIB06ABwdOgAgHToAKB06AAAMABIAAAASAAYACgAHABMACgATABYAFwAUAA4AFwAOABEADwADAAkADwAJABUABQACAAgABQAIAAsAEAANAAEAEAABAAQA"},2197:(e,n,t)=>{function s(e){return!!e&&!Array.isArray(e)&&"object"==typeof e}function a(e){return"number"==typeof e}function i(e,n,t=null){try{return r(e,n),!0}catch(n){return t&&(console.error("[Invalid type]",t),console.error(e),console.debug(n)),!1}}function r(e,n,t="data"){if("function"==typeof n)return r(e,n(),t);if("unknown"===n)return;if("null"===n){if(null!==e)throw console.log("ðŸš€ [index] data = ",e,typeof e),Error(`Expected ${t} to be a null and not a ${l(e)}!`);return}if("string"==typeof n){if(typeof e!==n)throw Error(`Expected ${t} to be a ${n} and not a ${l(e)}!`);return}if(Array.isArray(n)){const[i]=n;switch(i){case"array":return void function(e,n,t){if(!Array.isArray(e))throw Error(`Expected ${n} to be an array and not a ${l(e)}!`);const[,s,i]=t;if(i){const t=e.length;if(a(i)){if(t!==i)throw Error(`Expected ${n}'s length to be ${i} and not ${t}!`)}else{const{min:e,max:s}=i;if(a(e)&&t<e)throw Error(`Expected ${n}'s MIN length to be ${e} and not ${t}!`);if(a(s)&&t>s)throw Error(`Expected ${n}'s MAX length to be ${s} and not ${t}!`)}}for(let t=0;t<e.length;t+=1)r(e[t],s,`${n}[${t}]`)}(e,t,n);case"map":return void function(e,n,t){if(!s(e))throw Error(`Expected ${n} to be an object and not a ${l(e)}!`);const[,a]=t;for(const t of Object.keys(e))"string"==typeof t&&r(e[t],a,`${n}[${t}]`)}(e,t,n);case"?":return void function(e,n,t){if(void 0===e)return;const[,s]=t;r(e,s,n)}(e,t,n);case"|":return void function(e,n,t){const[,...s]=t;if(0===s.length)throw Error(`No type has been defined for this alternative: ${JSON.stringify(t)}!`);const a=[];for(const t of s)try{return void r(e,t,n)}catch(e){e instanceof Error&&a.push(e)}throw new Error(`All alternatives failed!${a.map((e=>`\n${e.message}`))}`)}(e,t,n);case"tuple":return void o(e,t,n);case"tuple...":return void function(e,n,[,...t]){const s=t.length-1;o(e,n,["tuple",...t.slice(0,s)]);const a=t[s];for(let t=s;t<e.length;t++)r(e[t],a,`${n}[${t}]`)}(e,t,n);case"partial":return void function(e,n,[,t]){!function(e,n="data"){if(!s(e))throw Error(`${n} was expected to be an object but we got ${typeof e}!`)}(e,n);for(const s of Object.keys(t)){if("string"!=typeof s)continue;const a=e[s];void 0!==a&&r(a,t[s],`${n}.${s}`)}}(e,t,n);case"literal":return void function(e,n,t){const[,...s]=t;for(const n of s)if(e===n)return;throw Error(`Expected ${n} to be a literal (${s.map((e=>`"${e}"`)).join(" | ")}) and not a ${l(e)}!`)}(e,t,n);case"custom":return void function(e,n,[,t]){if(!t(e))throw Error(`Expected ${t.name}(${n}) to return true!`)}(e,t,n);default:throw Error(`Don't know how to create a type guard for this kind of type: ${JSON.stringify(n)}`)}}if("object"!=typeof e)throw Error(`Expected ${t} to be an object and not a ${l(e)}!`);const i=e;for(const e of Object.keys(n))"string"==typeof e&&r(i[e],n[e],`${t}.${e}`)}function o(e,n,[,...t]){if(function(e,n="data"){if(!Array.isArray(e))throw Error(`${n} was expected to be an Array but we got ${typeof e}!`)}(e),t.length>e.length)throw Error(`Expected ${n}'s length to be at least ${t.length} and not ${e.length}!`);for(let s=0;s<t.length;s++){const a=t[s];r(e[s],a,`${n}[${s}]`)}}function c(e,n){return function(e,n,t){return i(e,n)?e:i(t,n)?t:t(e)}(e,"number",n)}function l(e){var n;return null===e?"null":"function"==typeof e?`function ${null!==(n=e.name)&&void 0!==n?n:""}()`:typeof e}t.d(n,{Et:()=>a,GB:()=>c,Xj:()=>i,j:()=>r})},7289:(e,n,t)=>{t.d(n,{A:()=>l});var s=t(4848),a=t(6540),i=t(6682),r=t(7402),o=t(3686);const c={Tgd:"hgIjhDQIuBCJEQ4ZgLXp",relative:"efOyHCihw9wfMB6AaAqw",overlay:"ywC8N0Uxbvm2Ug2DwPkE",loading:"PBWSRsbiwEqGpeL0hEfm",screen:"BErChOLWGtciKhh3IFud",canvas:"fT7FcYouYlPbElIAEXRP",gizmo:"uAPfWt_Dhe7RaRrnmIu0",actions:"Ia9jfUO3OevcIh2fV6R6",enabled:"dZYZScZBbWV2Pm3ftXcG"};function l({className:e,options:n,onReady:t,gizmo:l=!1,width:A="640px",height:d="480px",noBorder:u=!1,assets:h,children:m}){const[f,x]=a.useState(!0),[j,g]=a.useState(!1),p=a.useRef(null),y=a.useRef(null),b=a.useRef(null),w=a.useRef(null),[v,N]=a.useState(!0);let I="auto";A.endsWith("px")&&d.endsWith("px")&&(A.substring(A.length-2),d.substring(d.length-2));const C=e=>{if(!e)return;if(y.current)return;y.current=e;const s=new i.tfp(e,n),a=s.gl.getParameter(s.gl.DEPTH_BITS);console.log("Depht buffer bits:",a),p.current=s,N(!0),async function({glb:e,data:n,text:t,image:s}={}){console.log("ðŸš€ [Tgd] glb, data, text, image = ",e,n,t,s);const a={glb:{},data:{},text:{},image:{}},r=[];return s&&Object.keys(s).forEach((e=>{r.push((async()=>{const n=s[e];console.log("Loading image:",n);const t=await(0,i.V_9)(n);t&&(a.image[e]=t)}))})),e&&Object.keys(e).forEach((n=>{r.push((async()=>{const t=e[n];console.log("Loading GLB:",t);const s=await(0,i.TCe)(t);s&&(a.glb[n]=s)}))})),n&&Object.keys(n).forEach((e=>{r.push((async()=>{const t=n[e],s=await(0,i.vSU)(t);s&&(a.data[e]=s)}))})),t&&Object.keys(t).forEach((e=>{r.push((async()=>{const n=t[e],s=await(0,i.jWq)(n);s&&(a.text[e]=s)}))})),await Promise.all(r.map((e=>e()))),a}(h).then((e=>{console.log("Ready!"),t(s,e),s.paint(),N(!1)})).catch((e=>{console.error("Unable to initialize the scene!",e),N(!1)}));const r=b.current;r&&r.attachContext(s)},S=e=>{const n=new i.GbF({canvas:e});b.current=n,n.eventTipClick.addListener((({to:e})=>{const n=p.current;n&&n.animSchedule({duration:.2,easingFunction:i.Wcc,action:(0,i.vRM)(n.camera,{orientation:e})})}));const t=p.current;t&&n.attachContext(t)};return a.useEffect((()=>{const e=y.current,n=p.current;if(!e||!n)return;const t=new ResizeObserver((()=>n.paint()));return t.observe(e),e.requestFullscreen||(e.requestFullscreen=e.webkitRequestFullscreen),g(Boolean(e.requestFullscreen)),()=>t.unobserve(e)}),[p.current,y.current]),u?(0,s.jsxs)("div",{ref:w,className:c.screen,style:{width:f?A:d,height:f?d:A},children:[(0,s.jsx)("canvas",{className:c.canvas,ref:C}),l&&(0,s.jsx)("canvas",{className:c.gizmo,ref:S})]}):(0,s.jsxs)("div",{className:r.Sxu.classNames.join(e,c.Tgd),children:[(0,s.jsxs)("div",{className:r.Sxu.classNames.join(c.actions,!v&&c.enabled),children:[(0,s.jsx)("div",{children:(0,s.jsx)(r.I64,{onClick:()=>x(!f)})}),(0,s.jsx)("div",{children:(0,s.jsx)(r.kRc,{onClick:()=>{const e=p.current;e&&e.takeSnapshot().then((e=>{const n=document.createElement("a");document.body.appendChild(n),n.style.display="none",n.href=e.src,n.download="snapshot.png",n.click(),window.setTimeout((()=>document.body.removeChild(n)),3e4)}))}})}),j&&(0,s.jsx)("div",{children:(0,s.jsx)(r.L9n,{onClick:()=>{const e=w.current;e&&e.requestFullscreen()}})})]}),(0,s.jsxs)("div",{className:c.relative,children:[(0,s.jsxs)("div",{ref:w,className:c.screen,style:{width:f?A:d,height:f?d:A},children:[(0,s.jsx)("canvas",{className:c.canvas,ref:C}),l&&(0,s.jsx)("canvas",{className:c.gizmo,ref:S})]}),(0,s.jsx)("div",{className:r.Sxu.classNames.join(c.overlay,v&&c.loading),children:(0,s.jsx)(o.A,{})}),m]})]})}},9396:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Ze});var s=t(4848),a=t(6540),i=t(7402);const r={gltfTree:"XPMLtzXBRVSrxv_Xe50A"};var o=t(2197);function c(e){return(0,o.Xj)(e,{camera:"number"})}const l={node:"NDcVYWtiNdLrATykGHx3"},A={expander:"V3aob0pLE9HcHxN5iVyj",handle:"PbWyyuXizmAAIbcs5urg"},d=i.Sxu.classNames;function u(e){const[n,t]=a.useState(!1),r={...(0,i.$qi)(e),...e.style},o=e.icon;return(0,s.jsxs)("details",{className:d.join(e.className,A.expander),style:r,onToggle:s=>{s.preventDefault(),s.stopPropagation(),t(!n),e.onClick?.()},onClick:e.children?void 0:n=>{n.preventDefault(),n.stopPropagation(),e.onClick?.()},name:e.name,children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("div",{className:A.handle,children:e.children?n?(0,s.jsx)(i.vpi,{size:"1em"}):(0,s.jsx)(i.DF0,{size:"1em"}):(0,s.jsx)(i.Sg,{size:"1em"})}),o&&(0,s.jsx)(o,{color:"primary-7"}),(0,s.jsx)("span",{children:e.title})]}),(0,s.jsx)("div",{children:e.children})]})}const h=i.Sxu.classNames;function m(e){const n={...(0,i.$qi)(e)},t=e.data.json.nodes?.[e.index];if(!t)return null;const a=t.name??`#${e.index}`,r=function(e){return c(e)?i.PEB:(n=e,(0,o.Xj)(n,{mesh:"number"})?i.Td5:function(e){return(0,o.Xj)(e,{extensions:{KHR_lights_punctual:{light:"number"}}})}(e)?i.H3I:Array.isArray(e.children)?i.MRx:i.dlJ);var n}(t);return(0,s.jsx)(u,{className:h.join(e.className,l.node),name:e.name,style:n,title:a,onClick:()=>{e.onAction?.({type:"node",index:e.index})},icon:r,children:Array.isArray(t.children)&&t.children.map((n=>(0,s.jsx)(m,{data:e.data,index:n,onAction:e.onAction},`#${n}`)))})}function f(e){const{nodes:n}=e.data.json;return n?(0,s.jsx)(u,{title:"Nodes",icon:i.MRx,children:n.map(((n,t)=>(0,s.jsx)(m,{data:e.data,index:t,onAction:e.onAction},`#${t}`)))}):(0,s.jsx)("p",{children:"No nodes."})}i.Sxu.classNames;const x={images:"o4_1rbAB9XmGcjjHG22H"},j=i.Sxu.classNames;function g({className:e,data:n,onAction:t}){return(0,s.jsx)(u,{className:j.join(e,x.images),icon:i.dwH,title:"Images",children:(n.json.images??[]).map(((e,n)=>(0,s.jsx)(u,{title:e.name??`#${n}`,onClick:()=>t?.({type:"image",index:n}),children:(0,s.jsxs)("ul",{children:[e.name&&(0,s.jsxs)("li",{children:["Name: ",(0,s.jsx)("b",{children:e.name})]}),e.mimeType&&(0,s.jsxs)("li",{children:["Mime type: ",(0,s.jsx)("b",{children:e.mimeType})]}),e.bufferView&&(0,s.jsxs)("li",{children:["Buffer view: ",(0,s.jsx)("b",{children:e.bufferView})]}),e.uri&&(0,s.jsxs)("li",{children:["URI: ",(0,s.jsx)("b",{children:e.uri})]})]})},n)))})}const p={lights:"G3CJ6oAzpvDypk53NREK"},y=i.Sxu.classNames;function b({className:e,data:n,onAction:t}){return(0,s.jsx)(u,{className:y.join(e,p.images),title:"Lights",icon:i.H3I})}function w({data:e,scene:n,title:t,index:a,onAction:r}){return(0,s.jsx)(u,{title:t,icon:i.GtP,onClick:()=>{r?.({index:a,type:"scene"})},children:(n.nodes??[]).map(((n,t)=>(0,s.jsx)(m,{data:e,index:t,onAction:r},`node#${t}`)))})}function v(e){const{scenes:n}=e.data.json;return n?(0,s.jsx)(u,{title:"Scenes",icon:i.GtP,children:n.map(((n,t)=>(0,s.jsx)(w,{data:e.data,scene:n,title:n.name??`Scene #${t}`,index:t,onAction:e.onAction},`Scene#${t}`)))}):(0,s.jsx)("p",{children:"No scenes."})}i.Sxu.classNames,i.Sxu.classNames;const N=i.Sxu.classNames;function I(e){const n={...(0,i.$qi)(e)};return(0,s.jsxs)("div",{className:N.join(e.className,r.gltfTree),style:n,children:[(0,s.jsx)(i.yQN,{variant:"text",color:"secondary-5",fullwidth:!0,onClick:(t={type:"verbatim"},()=>e.onAction(t)),children:"Show verbatim content"}),(0,s.jsx)(v,{data:e.data,onAction:e.onAction}),(0,s.jsx)(f,{data:e.data,onAction:e.onAction}),(0,s.jsx)(g,{data:e.data,onAction:e.onAction}),(0,s.jsx)(b,{data:e.data,onAction:e.onAction}),(0,s.jsx)("hr",{}),(0,s.jsx)("a",{href:"https://registry.khronos.org/glTF/specs/2.0/glTF-2.0.html",children:"GLTF 2.0 Specification"})]});var t}var C=t(6682),S=t(1839);const M={action:"TivnAbABYZdpWW9GZs6n"},$={verbatin:"EOCnuXPaVAQQjOaVzDWk"},E={json:"xo2OgnX2_m3zlxXV2j9k"},O=i.Sxu.classNames;function T(e){const n={...(0,i.$qi)(e)},{value:t}=e;return(0,s.jsxs)("div",{className:O.join(e.className,E.json),style:n,children:[(0,s.jsx)("pre",{children:JSON.stringify(t,k,2)}),(0,s.jsx)(i.yQN,{variant:"outlined",onClick:()=>console.log(t),children:"Write to console"})]})}function k(e,n){return n instanceof Uint8Array?`<<< Uint8Array( ${n.length} ) >>>`:n instanceof Int8Array?`<<< Int8Array( ${n.length} ) >>>`:n instanceof Uint8ClampedArray?`<<< Uint8ClampedArray( ${n.length} ) >>>`:n instanceof Uint16Array?`<<< Uint16Array( ${n.length} ) >>>`:n instanceof Int16Array?`<<< Int16Array( ${n.length} ) >>>`:n instanceof Uint32Array?`<<< Uint32Array( ${n.length} ) >>>`:n instanceof Int32Array?`<<< Int32Array( ${n.length} ) >>>`:n instanceof Float16Array?`<<< Float16Array( ${n.length} ) >>>`:n instanceof Float32Array?`<<< Float32Array( ${n.length} ) >>>`:n}const L=i.Sxu.classNames;function Z(e){return(0,s.jsx)(i.sWC,{className:L.join(e.className,$.verbatin),overflow:"auto",fullsize:!0,color:"neutral-1",padding:"S",children:(0,s.jsx)(T,{value:e.data})})}var W=t(9074);const J={actionNodeTransfo:"YXMiTxYNCxTJZifDB0En"},V=i.Sxu.classNames;function U(e){const n={...(0,i.$qi)(e)},t=["const transfo = new TgdTransfo({"];var a;return B(e.node.translation)&&t.push(`  position: [${e.node.translation.join(", ")}],`),a=e.node.rotation,(0,o.Xj)(a,["array","number",{min:4,max:4}])&&t.push(`  orientation: [${e.node.rotation.join(", ")}],`),B(e.node.scale)&&t.push(`  position: [${e.node.scale.join(", ")}],`),t.push("})"),(0,s.jsx)("div",{className:V.join(e.className,J.actionNodeTransfo),style:n,children:(0,s.jsx)(W.A,{language:"ts",value:t.join("\n")})})}function B(e){return(0,o.Xj)(e,["array","number",{min:3,max:3}])}const z={Error:"H0UnrqUJgmcVuhNY9Flo"},R=i.Sxu.classNames;function X({className:e,children:n}){return(0,s.jsx)("div",{className:R.join(e,z.Error),children:n})}const G={actionNodeCamera:"H9dDNSbXjsX6jN3Bf3xh"},P=i.Sxu.classNames;function D(e){const n={...(0,i.$qi)(e)},t=e.data.json.cameras?.[e.node.camera??-1];if(!t)return(0,s.jsx)(X,{children:"No camera found!"});const a=function(e,n){const t=[];return(0,C.JAF)(n)&&(t.push("const camera = new TgdCameraPerspective({",`  fovy: ${n.perspective.yfov},  // around ${Math.round((0,C.ZvP)(n.perspective.yfov))}Â°`,`  near: ${(0,o.GB)(n.perspective.znear,.001)}`,`  far: ${n.perspective.zfar??"Infinity"}`,"  transfo: {","    distrance: 0,"),e.translation&&t.push(`    position: [${e.translation.join(", ")}],`),e.rotation&&t.push(`    orientation: [${e.rotation.join(", ")}],`),e.scale&&t.push(`    scale: [${e.scale.join(", ")}],`),t.push("  }","})")),t.join("\n")}(e.node,t);return(0,s.jsx)("div",{className:P.join(e.className,G.actionNodeCamera),style:n,children:(0,s.jsx)(W.A,{language:"ts",value:a})})}const H={actionNode:"FHDDVaFyhGXfoGBta3yQ"},F={actionNodeRender:"WlQP8S7OoKQ5p9KJGWab"};var Y=t(7289);function q({data:e,node:n}){const t=function(e,n){return a.useCallback((t=>{const s=Q(e,n);t.camera.transfo.position=s.center,t.camera.transfo.distance=2*s.radius,t.camera.far=5*s.radius,t.camera.near=1,new C.pwt(t,{inertiaOrbit:1e3,speedZoom:.25*s.radius});const a=new C.o57(t,{color:[.2,.2,.2,1],depth:1}),{painter:i}=(0,C.TB8)({data:e,node:n,context:t});i.debug("nodePainter");const r=new C.Ipk(t,{depth:C.Eg5.lessOrEqual,children:[i]});t.add(a,r),t.paint()}),[e,n])}(e,n);return(0,s.jsx)("div",{className:F.actionNodeRender,children:(0,s.jsx)(Y.A,{onReady:t,width:"100%",height:"100%",gizmo:!0,noBorder:!0},JSON.stringify(n))})}function Q(e,n){const t=[];(0,o.Et)(n.mesh)&&t.push(K(function(e,n){const t=e.getMesh(n);if(!t)return[{center:new C.hNi,radius:1}];const s=[];for(const n of t.primitives){const t=e.getAccessorByAttributeName(n,"POSITION");if(_(t.min)&&_(t.max)){const[e,n,a]=t.min,[i,r,o]=t.max;s.push({center:C.hNi.newFromMix(t.min,t.max),radius:Math.max(Math.abs(i-e),Math.abs(r-n),Math.abs(o-a))})}}return s}(e,n.mesh)));for(const s of n.children??[]){const n=e.getNode(s);t.push(Q(e,n))}return function(e,n){const[t,s,a]=e.center,i=new C.oao(t,s,a,1),r={};n.translation&&(r.position=n.translation),n.rotation&&(r.orientation=n.rotation),n.scale&&(r.scale=n.scale);const o=new C.tSS(r);i.applyMatrix(o.matrix);const[c,l,A]=o.scale,d=Math.max(c,l,A);return{center:new C.hNi(i.x,i.y,i.z),radius:e.radius*d}}(K(t),n)}function _(e){return(0,o.Xj)(e,["array","number",{min:3,max:3}])}function K(e){if(0===e.length)return{center:new C.hNi,radius:1};let n=0,t=0,s=0;for(const{center:a}of e){const[e,i,r]=a;n+=e,t+=i,s+=r}const a=e.length;n/=a,t/=a,s/=a;const i=new C.hNi(n,t,s);let r=0;for(const{center:n,radius:t}of e)r=Math.max(r,t+C.hNi.distance(i,new C.hNi(n)));return{center:i,radius:r}}i.Sxu.classNames;const ee={actionNodeMesh:"p9Kbtkuegy0iOh66GNDX"},ne={value:"n8pRiWUyv_1Af5HOwG4n"},te=i.Sxu.classNames;function se(e){const n={...(0,i.$qi)(e)},{value:t,label:a,lookup:r=!1}=e;return(0,o.Et)(t)&&r?(0,s.jsxs)("div",{className:te.join(e.className,ne.value),style:n,children:[a&&(0,s.jsxs)("label",{children:[a,":"]}),(0,s.jsxs)("div",{children:["gl.",(0,s.jsx)("b",{children:(0,C.eyF)(t)})]})]}):(0,s.jsxs)("div",{className:te.join(e.className,ne.value),style:n,children:[a&&(0,s.jsxs)("label",{children:[a,":"]}),(0,s.jsx)(ae,{value:t})]})}function ae({value:e}){return void 0===e?(0,s.jsx)("em",{children:"undefined"}):null===e?(0,s.jsx)("em",{children:"null"}):(0,s.jsx)("b",{children:JSON.stringify(e)})}const ie={accessor:"NNZXZp9wvxpD6763MYUF"},re={data:"ae9NgxUT0l3kQ0p7fMhd",grid:"hL8SKLHUfwy3P4rI8vII",row:"bZX5lLCGfnCnr1Nzua0X"},oe=i.Sxu.classNames;function ce({className:e,buffer:n,type:t,componentType:a,onClose:r}){const o=function(e,n){switch(n){case WebGL2RenderingContext.FLOAT:return new Float32Array(e);case WebGL2RenderingContext.HALF_FLOAT:return new Float16Array(e);case WebGL2RenderingContext.HIGH_FLOAT:return new Float64Array(e);case WebGL2RenderingContext.UNSIGNED_BYTE:return new Uint8Array(e);case WebGL2RenderingContext.UNSIGNED_SHORT:return new Uint16Array(e);case WebGL2RenderingContext.UNSIGNED_INT:return new Uint32Array(e);default:throw new Error(`Don't know how to interpret ${(0,C.eyF)(n)}!`)}}(n,a),c=le(function(e){switch(e.toLowerCase()){case"float":case"scalar":default:return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4}}(t)),l=le(Math.ceil(o.length/c.length));return(0,s.jsxs)(i.UkC,{className:oe.join(e,re.data),template:"*1",children:[(0,s.jsxs)(i.sWC,{color:"primary-5",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"M",padding:"S",children:[(0,s.jsxs)("div",{children:["Attributes: ",(0,s.jsx)("b",{children:l.length})]}),(0,s.jsx)("div",{children:t}),(0,s.jsxs)("div",{children:["gl.",(0,C.eyF)(a)]}),(0,s.jsx)(i.gzW,{onClick:r})]}),(0,s.jsx)(i.sWC,{overflow:"auto",color:"neutral-1",padding:"S",children:(0,s.jsx)("div",{className:re.grid,style:{"--custom-columns":c.length},children:l.slice(0,100).map((e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:re.row,children:e},`${e}`),c.map((n=>(0,s.jsx)("div",{children:o[n+e*c.length]},`${e}/${n}`)))]})))})})]})}function le(e){const n=new Array(e);for(let t=0;t<e;t++)n[t]=t;return n}const Ae=i.Sxu.classNames;function de(e){const n=a.useRef(null),[t,r]=a.useState(!1);a.useEffect((()=>{const e=n.current;e&&(t?e.showModal():e.close())}),[t]);const c={...(0,i.$qi)(e)},{data:l,index:A}=e,d=l.getAccessor(A);return(0,s.jsxs)(u,{className:Ae.join(e.className,ie.accessor),style:c,title:`Accessor #${A}`,children:[(0,s.jsx)(se,{label:"name",value:d.name}),(0,s.jsx)(se,{label:"type",value:d.type}),(0,s.jsx)(se,{label:"componentType",value:d.componentType,lookup:!0}),(0,s.jsx)(se,{label:"count",value:d.count}),(0,s.jsx)(se,{label:"bufferView",value:d.bufferView}),(0,s.jsx)(se,{label:"byteOffset",value:d.byteOffset}),(0,s.jsx)(se,{label:"normalized",value:d.normalized}),(0,s.jsx)(se,{label:"min",value:d.min}),(0,s.jsx)(se,{label:"max",value:d.max}),(0,o.Et)(d.bufferView)&&(0,s.jsx)(i.yQN,{variant:"outlined",onClick:()=>r(!0),children:"Show data"}),(0,s.jsx)("dialog",{ref:n,children:t&&(0,s.jsx)(i.sWC,{children:(0,s.jsx)(ce,{buffer:l.getBufferViewData(d),type:d.type,componentType:d.componentType,onClose:()=>r(!1)})})})]})}const ue=i.Sxu.classNames;function he({className:e,data:n,meshIndex:t}){const a=n.getMesh(t);return a?(0,s.jsx)("div",{className:ue.join(e,ee.actionNodeMesh),children:(0,s.jsx)("ul",{children:a.primitives.map(((e,t)=>(0,s.jsxs)("li",{children:[(0,s.jsxs)("b",{children:["Primitive ",t]}),(0,s.jsx)(u,{title:"Attributes",children:Object.keys(e.attributes).map((t=>{const a=e.attributes[t];return(0,s.jsx)(u,{title:t,children:(0,o.Et)(a)?(0,s.jsx)(de,{data:n,index:a}):(0,s.jsx)(T,{value:a})},t)}))}),(0,s.jsxs)(u,{title:"Indices",children:[e.indices&&((0,o.Et)(e.indices)?(0,s.jsx)(de,{data:n,index:e.indices}):(0,s.jsx)(T,{value:e.indices})),!e.indices&&(0,s.jsx)("div",{children:"No indices..."})]}),(e.material??-1)>-1&&(0,s.jsx)(u,{title:(0,s.jsxs)("div",{children:["Material"," ",(0,s.jsx)("b",{children:n.getMaterial(e.material??-1)?.name??"Material"})]}),children:(0,o.Et)(e.material)&&(0,s.jsx)(T,{value:n.getMaterial(e.material)})}),(0,s.jsx)(u,{title:"Verbatim",children:(0,s.jsx)(T,{value:a})})]},t)))})}):(0,s.jsxs)(X,{children:["No mesh found with index #",t,"!"]})}const me=i.Sxu.classNames;function fe(e){const n={...(0,i.$qi)(e)},t=e.data.json.nodes?.[e.index];return t?(0,s.jsxs)(i.UkC,{orientation:"column",template:"-1",className:me.join(e.className,H.actionNode),fullsize:!0,children:[(0,s.jsx)(i.sWC,{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"M",color:"primary-5",padding:"S",children:(0,s.jsxs)("div",{children:["Node #",e.index,":"," ",(0,s.jsx)("b",{children:t.name??(0,s.jsx)("em",{children:"anonymous"})})]})}),(0,s.jsx)(i.sWC,{style:n,children:(0,s.jsxs)(i.WET,{fullsize:!0,children:[(0,s.jsx)(i.Zdo,{label:"3D View",children:!c(t)&&(0,s.jsx)(q,{data:e.data,node:t})},"render"),(0,s.jsx)(i.Zdo,{label:"Camera",children:c(t)&&(0,s.jsx)(D,{data:e.data,node:t})},"camera"),(0,s.jsx)(i.Zdo,{label:"Transformation",children:(0,s.jsx)(U,{node:t})},"transfo"),(0,s.jsx)(i.Zdo,{label:"Mesh",children:(0,o.Et)(t.mesh)&&(0,s.jsx)(he,{data:e.data,meshIndex:t.mesh})},"mesh"),(0,s.jsx)(i.Zdo,{label:"Verbatim",children:(0,s.jsx)("pre",{children:JSON.stringify(t,null,"  ")})},"verbatim")]})})]}):null}const xe={fileSize:"MKULJkv5mj0S_xY8htf8",bytes:"F7WZfPxY1S7i0Hjtucc7",Kb:"D9DRrGtnrbf1nOgNQWyG",Mb:"h0ieIogaTKV3gw0BUni6"},je=i.Sxu.classNames;function ge(e){const n={...(0,i.$qi)(e)},[t,a]=(r=e.value)<1024?[r,"bytes"]:r<1048576?[r/1024,"Kb"]:[r/1048576,"Mb"];var r;return(0,s.jsxs)("div",{className:je.join(e.className,xe.fileSize,xe[a]),style:n,children:[Math.round(t)," ",a]})}const pe=t.p+"img/checkboard-light.a7a1229bc8b42ce5b9d3.jpg",ye=t.p+"img/checkboard-dark.9d3dacc5286db0915472.jpg",be={actionImage:"C9I4sL1N2ssiuRkPggbA",dimensions:"v6mssTjMLNc8Ogj4uBSq",link:"lHntNRydftoMSCTh5gwv",mimeType:"Z3MostVbq5he_JIIndWa"},we=i.Sxu.classNames;function ve({data:e,index:n}){const[t,r]=a.useState("light"),[o,c]=a.useState(null),[l,A]=a.useState(null),[d,u]=a.useState(void 0),h=function(e,n){return a.useMemo((()=>{if(!n)return 0;const t=e.getBufferView(n.bufferView??-1);return t?t.byteLength:0}),[e,n])}(e,d),[m,f]=a.useState(null),x=a.useCallback(((t,s)=>{f(null);const a=new C.o57(t,{color:[0,0,0,0]});t.add(a),t.paint(),u(e.getImage(n));const i=e.getImageAsHTMLElement(n);if(!i)return;c(i),A([i.width,i.height]);const r=new C.HTX(t).loadBitmap(i),o=new C.b6h(t,{mode:"contain",texture:r});t.add(o),t.paint()}),[e,n]);return(0,s.jsxs)("div",{className:we.join(be.actionImage),style:{backgroundImage:`url(${"dark"===t?ye:pe})`},children:[m?(0,s.jsx)(X,{children:m}):(0,s.jsx)(Y.A,{options:{alpha:!0},onReady:x,noBorder:!0,width:"100%",height:"100%"},JSON.stringify(e.getImage(n))),(0,s.jsxs)("header",{children:[(0,s.jsx)("div",{className:be.dimensions,children:l?.join(" Ã— ")}),h>0&&(0,s.jsx)(ge,{value:h}),d&&(0,s.jsx)("div",{className:be.mimeType,children:d.mimeType}),(0,s.jsxs)(i.si8,{value:t,onChange:r,children:[(0,s.jsx)("div",{children:"Light"},"light"),(0,s.jsx)("div",{children:"Dark"},"dark")]}),(0,s.jsx)("div",{className:be.link,children:o&&(0,s.jsx)("a",{href:o.src,target:"_blank",children:"Open in new tab"})})]})]})}const Ne={actionScene:"IUOTuyuq_tmmW8h_lBpp"},Ie=i.Sxu.classNames;function Ce({data:e,index:n}){const t=e.json.scenes?.[n],i=function(e,n){return a.useCallback((t=>{if(!n)return void console.error("No Scene!");console.log("ðŸš€ [ActionScene] context =",t);const s=new C.buV({children:(n.nodes??[]).filter((n=>{const t=e.getNode(n);return(0,o.Et)(t.mesh)||Array.isArray(t.children)&&t.children.length>0})).map((n=>(0,C.TB8)({data:e,node:n,context:t}).painter)),name:n.name??"Scene"});s.debug();const a=$e((n.nodes??[]).map((n=>Se(e,e.getNode(n)))));t.camera.transfo.position=a.center,t.camera.transfo.distance=2*a.radius,t.camera.far=10*a.radius,new C.pwt(t,{inertiaOrbit:1e3,speedZoom:.25*a.radius});const i=new C.o57(t,{color:[.2,.2,.2,1],depth:1}),r=new C.Ipk(t,{depth:C.Eg5.lessOrEqual,children:[s]});t.add(i,r),t.paint()}),[e,n])}(e,t);return t?(0,s.jsx)("div",{className:Ie.join(Ne.actionScene),children:(0,s.jsx)(Y.A,{onReady:i,width:"100%",height:"100%",gizmo:!0,noBorder:!0},JSON.stringify(t))}):(0,s.jsx)("p",{children:"No scene..."})}function Se(e,n){const t=[];(0,o.Et)(n.mesh)&&t.push($e(function(e,n){const t=e.getMesh(n);if(!t)return[{center:new C.hNi,radius:1}];const s=[];for(const n of t.primitives){const t=e.getAccessorByAttributeName(n,"POSITION");if(Me(t.min)&&Me(t.max)){const[e,n,a]=t.min,[i,r,o]=t.max;s.push({center:C.hNi.newFromMix(t.min,t.max),radius:Math.max(Math.abs(i-e),Math.abs(r-n),Math.abs(o-a))})}}return s}(e,n.mesh)));for(const s of n.children??[]){const n=e.getNode(s);t.push(Se(e,n))}return function(e,n){const[t,s,a]=e.center,i=new C.oao(t,s,a,1),r={};n.translation&&(r.position=n.translation),n.rotation&&(r.orientation=n.rotation),n.scale&&(r.scale=n.scale);const o=new C.tSS(r);i.applyMatrix(o.matrix);const[c,l,A]=o.scale,d=Math.max(c,l,A);return{center:new C.hNi(i.x,i.y,i.z),radius:e.radius*d}}($e(t),n)}function Me(e){return(0,o.Xj)(e,["array","number",{min:3,max:3}])}function $e(e){if(0===e.length)return{center:new C.hNi,radius:1};let n=0,t=0,s=0;for(const{center:a}of e){const[e,i,r]=a;n+=e,t+=i,s+=r}const a=e.length;n/=a,t/=a,s/=a;const i=new C.hNi(n,t,s);let r=0;for(const{center:n,radius:t}of e)r=Math.max(r,t+C.hNi.distance(i,new C.hNi(n)));return{center:i,radius:r}}const Ee=i.Sxu.classNames;function Oe(e){const n={...(0,i.$qi)(e)};switch(e.action.type){case"scene":return(0,s.jsx)(Ce,{data:e.data,index:e.action.index});case"verbatim":return(0,s.jsx)(Z,{data:e.data});case"node":return(0,s.jsx)(fe,{data:e.data,index:e.action.index});case"image":return(0,s.jsx)(ve,{data:e.data,index:e.action.index});default:return(0,s.jsxs)("div",{className:Ee.join(e.className,M.action),style:n,children:["Don't know what to do with this action:"," ",(0,s.jsx)("pre",{children:JSON.stringify(e.action,null,"  ")}),"."]})}}const Te={viewgltf:"jgtK2RMH89K4DKGqzXgk"},ke=i.Sxu.classNames;function Le(e){const[n,t]=a.useState({type:"verbatim"}),[r,o]=function(){const[e,n]=a.useState(null),t=a.useCallback((e=>{(0,C.vSU)(e).then((e=>{e&&C.nU$.parse(e).then(n)})).catch(console.error)}),[n]);return a.useEffect((()=>{t(S)}),[]),[e,t]}();return a.useState(null),(0,s.jsxs)(i.UkC,{className:ke.join(e.className,Te.viewgltf),template:"*1",orientation:"row",fullsize:!0,gap:"8px",children:[(0,s.jsxs)(i.UkC,{template:"*1",orientation:"column",children:[(0,s.jsxs)(i.sWC,{color:"primary-5",display:"flex",justifyContent:"space-between",alignItems:"center",padding:["S","M"],minWidth:"300px",gap:"M",children:[(0,s.jsx)("div",{children:"GLB Viewer"}),r&&(0,s.jsxs)("em",{children:[Math.floor(r.fileSize/1024)," Kb"]}),(0,s.jsx)(i.e3B,{accept:"glb",onLoad:function(e){const[n]=e;n&&o(n)},children:(0,s.jsx)(i.Thu,{})})]}),(0,s.jsxs)(i.sWC,{overflow:"auto",minHeight:"auto",color:"neutral-5",padding:"S",children:[!r&&(0,s.jsx)("div",{children:"Loading..."}),r&&(0,s.jsx)(I,{data:r,onAction:t})]})]}),r&&(0,s.jsx)(i.sWC,{position:"relative",overflow:"auto",fullsize:!0,children:(0,s.jsx)(Oe,{action:n,data:r})})]})}function Ze(){return(0,s.jsx)(Le,{})}}}]);