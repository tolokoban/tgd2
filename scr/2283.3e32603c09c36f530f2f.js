"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[2283],{342:(n,e,t)=>{t.r(e),t.d(e,{default:()=>f});var s=t(4848),a=t(8453),r=t(6540),i=t(3608),o=t(9074),l=t(4447),c=t(7289),u=t(1278);function d(n,e){const[t,s]=r.useState(n);return r.useEffect(()=>e?.(t),[t]),[t,s]}function h(){const n=r.useRef(null),e=n.current,[t,a]=d(20,e?.specularExponent),[o,h]=d(1,e?.specularIntensity),[p,g]=d(.5,e?.split);return(0,s.jsx)("div",{children:(0,s.jsxs)(c.A,{onReady:(e,t)=>{n.current=function(n,e){const t=[...(0,l.tgdCalcRandom3)(),1],s=new l.TgdMaterialDiffuse({color:t,ambient:new l.TgdLight({color:[.8,.8,.8,0]})}),a=new l.TgdPainterMeshGltf(n,{asset:e.glb.suzane,material:s}),r=new l.TgdMaterialDiffuse({color:t,lockLightsToCamera:!0,ambient:new l.TgdLight({color:[.8,.8,.8,0]})}),i=new l.TgdPainterMeshGltf(n,{asset:e.glb.suzane,material:r}),o=new l.TgdPainterScissor(n,{children:[a],x:0,y:0,width:.5,height:1}),c=new l.TgdPainterScissor(n,{children:[i],x:.5,y:0,width:.5,height:1});return n.add(new l.TgdPainterClear(n,{color:[.3,.3,.3,1],depth:1}),new l.TgdPainterState(n,{depth:l.webglPresetDepth.less,children:[o,c]})),n.paint(),{specularExponent(e){s.specularExponent=e,r.specularExponent=e,n.paint()},specularIntensity(e){s.specularIntensity=e,r.specularIntensity=e,n.paint()},split(e){const t=(0,l.tgdCalcClamp)(e,0,1);o.x=0,o.width=t,c.x=t,c.width=1-t,n.paint()}}}(e,t)},assets:{glb:{suzane:u}},gizmo:!0,controller:{inertiaOrbit:1e3},children:[(0,s.jsx)(i.BAW,{value:p,onChange:g,min:0,max:1,step:.01}),(0,s.jsxs)(i.sWC,{display:"flex",justifyContent:"space-around",alignItems:"center",children:[(0,s.jsx)(i.D3i,{label:"specularExponent",value:t,onChange:a}),(0,s.jsx)(i.D3i,{label:"specularIntensity",value:o,onChange:h})]}),(0,s.jsxs)(i.sWC,{display:"flex",justifyContent:"space-around",alignItems:"center",children:[(0,s.jsx)(i.yQN,{variant:"text",color:"primary-5",onClick:()=>{a(1),h(.5)},children:"Brushed Metal"}),(0,s.jsx)(i.yQN,{variant:"text",color:"primary-5",onClick:()=>{a(.25),h(.125)},children:"Soft Light"}),(0,s.jsx)(i.yQN,{variant:"text",color:"primary-5",onClick:()=>{a(50),h(2)},children:"Car Paint"}),(0,s.jsx)(i.yQN,{variant:"text",color:"primary-5",onClick:()=>{h(0)},children:"Plastic"})]})]})})}const p={"Initializing WebGL":"    const color: ArrayNumber4 = [...tgdCalcRandom3(), 1]\n    const material1 = new TgdMaterialDiffuse({\n        color,\n        ambient: new TgdLight({\n            color: [0.8, 0.8, 0.8, 0],\n        }),\n    })\n    const mesh1 = new TgdPainterMeshGltf(context, {\n        asset: assets.glb.suzane,\n        material: material1,\n    })\n    const material2 = new TgdMaterialDiffuse({\n        color,\n        lockLightsToCamera: true,\n        ambient: new TgdLight({\n            color: [0.8, 0.8, 0.8, 0],\n        }),\n    })\n    const mesh2 = new TgdPainterMeshGltf(context, {\n        asset: assets.glb.suzane,\n        material: material2,\n    })"},g='import {\n    ArrayNumber4,\n    TgdContext,\n    TgdControllerCameraOrbit,\n    TgdLight,\n    TgdMaterialDiffuse,\n    TgdPainterClear,\n    TgdPainterMeshGltf,\n    TgdPainterState,\n    TgdPainterScissor,\n    tgdCalcRandom3,\n    webglPresetDepth,\n    tgdCalcClamp,\n} from "@tolokoban/tgd"\nimport View, { Assets } from "@/components/demo/Tgd"\nimport SuzaneURL from "@/assets/mesh/suzanne.glb"\nimport React from "react"\nimport { useFloat } from "@/utils/hooks/float"\nimport {\n    ViewButton,\n    ViewInputNumber,\n    ViewPanel,\n    ViewSlider,\n} from "@tolokoban/ui"\n\nfunction init(context: TgdContext, assets: Assets) {\n    const color: ArrayNumber4 = [...tgdCalcRandom3(), 1]\n    const material1 = new TgdMaterialDiffuse({\n        color,\n        ambient: new TgdLight({\n            color: [0.8, 0.8, 0.8, 0],\n        }),\n    })\n    const mesh1 = new TgdPainterMeshGltf(context, {\n        asset: assets.glb.suzane,\n        material: material1,\n    })\n    const material2 = new TgdMaterialDiffuse({\n        color,\n        lockLightsToCamera: true,\n        ambient: new TgdLight({\n            color: [0.8, 0.8, 0.8, 0],\n        }),\n    })\n    const mesh2 = new TgdPainterMeshGltf(context, {\n        asset: assets.glb.suzane,\n        material: material2,\n    })\n    const scissor1 = new TgdPainterScissor(context, {\n        children: [mesh1],\n        x: 0,\n        y: 0,\n        width: 0.5,\n        height: 1,\n    })\n    const scissor2 = new TgdPainterScissor(context, {\n        children: [mesh2],\n        x: 0.5,\n        y: 0,\n        width: 0.5,\n        height: 1,\n    })\n    context.add(\n        new TgdPainterClear(context, {\n            color: [0.3, 0.3, 0.3, 1],\n            depth: 1,\n        }),\n        new TgdPainterState(context, {\n            depth: webglPresetDepth.less,\n            children: [scissor1, scissor2],\n        })\n    )\n    context.paint()\n    return {\n        specularExponent(value: number) {\n            material1.specularExponent = value\n            material2.specularExponent = value\n            context.paint()\n        },\n        specularIntensity(value: number) {\n            material1.specularIntensity = value\n            material2.specularIntensity = value\n            context.paint()\n        },\n        split(value: number) {\n            const a = tgdCalcClamp(value, 0, 1)\n            scissor1.x = 0\n            scissor1.width = a\n            scissor2.x = a\n            scissor2.width = 1 - a\n            context.paint()\n        },\n    }\n}\n\nexport default function Demo() {\n    const ref = React.useRef<ReturnType<typeof init> | null>(null)\n    const srv = ref.current\n    const [specularExponent, setSpecularExponent] = useFloat(\n        20,\n        srv?.specularExponent\n    )\n    const [specularIntensity, setSpecularIntensity] = useFloat(\n        1,\n        srv?.specularIntensity\n    )\n    const [split, setSplit] = useFloat(0.5, srv?.split)\n    return (\n        <div>\n            <View\n                onReady={(scene: TgdContext, assets: Assets) => {\n                    ref.current = init(scene, assets)\n                }}\n                assets={{\n                    glb: {\n                        suzane: SuzaneURL,\n                    },\n                }}\n                gizmo\n                controller={{\n                    inertiaOrbit: 1000,\n                }}\n            >\n                <ViewSlider\n                    value={split}\n                    onChange={setSplit}\n                    min={0}\n                    max={1}\n                    step={1e-2}\n                />\n                <ViewPanel\n                    display="flex"\n                    justifyContent="space-around"\n                    alignItems="center"\n                >\n                    <ViewInputNumber\n                        label="specularExponent"\n                        value={specularExponent}\n                        onChange={setSpecularExponent}\n                    />\n                    <ViewInputNumber\n                        label="specularIntensity"\n                        value={specularIntensity}\n                        onChange={setSpecularIntensity}\n                    />\n                </ViewPanel>\n                <ViewPanel\n                    display="flex"\n                    justifyContent="space-around"\n                    alignItems="center"\n                >\n                    <ViewButton\n                        variant="text"\n                        color="primary-5"\n                        onClick={() => {\n                            setSpecularExponent(1)\n                            setSpecularIntensity(0.5)\n                        }}\n                    >\n                        Brushed Metal\n                    </ViewButton>\n                    <ViewButton\n                        variant="text"\n                        color="primary-5"\n                        onClick={() => {\n                            setSpecularExponent(0.25)\n                            setSpecularIntensity(0.125)\n                        }}\n                    >\n                        Soft Light\n                    </ViewButton>\n                    <ViewButton\n                        variant="text"\n                        color="primary-5"\n                        onClick={() => {\n                            setSpecularExponent(50)\n                            setSpecularIntensity(2)\n                        }}\n                    >\n                        Car Paint\n                    </ViewButton>\n                    <ViewButton\n                        variant="text"\n                        color="primary-5"\n                        onClick={() => {\n                            setSpecularIntensity(0)\n                        }}\n                    >\n                        Plastic\n                    </ViewButton>\n                </ViewPanel>\n            </View>\n        </div>\n    )\n}\n';function m(){const[n,e]=r.useState(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"half-left",children:(0,s.jsx)(h,{})}),(0,s.jsxs)("div",{className:"half-right",children:[(0,s.jsx)("div",{children:(0,s.jsx)(i.yQN,{variant:"elevated",onClick:()=>e(!n),children:n?"Show code details":"Show full code"})}),(0,s.jsx)(o.A,{language:"tsx",value:n?g:p})]})]})}function x(n){const e={a:"a",h1:"h1",hr:"hr",p:"p",...(0,a.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.h1,{children:"Diffuse material"}),"\n",(0,s.jsx)(m,{}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.a,{href:"#/articles/material",children:"Back"})})]})}function f(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(x,{...n})}):x(n)}},1278:(n,e,t)=>{n.exports=t.p+"bin/suzanne.d3b099acbd7623177bf6.glb"},7289:(n,e,t)=>{t.d(e,{A:()=>c});var s=t(4848),a=t(6540),r=t(4447),i=t(3608),o=t(3686);const l={Tgd:"hgIjhDQIuBCJEQ4ZgLXp",relative:"efOyHCihw9wfMB6AaAqw",overlay:"ywC8N0Uxbvm2Ug2DwPkE",loading:"PBWSRsbiwEqGpeL0hEfm",screen:"BErChOLWGtciKhh3IFud",canvas:"fT7FcYouYlPbElIAEXRP",gizmo:"uAPfWt_Dhe7RaRrnmIu0",actions:"Ia9jfUO3OevcIh2fV6R6",enabled:"dZYZScZBbWV2Pm3ftXcG",error:"J6dIEMXVMCzdFWF9UHio"};function c({className:n,options:e,onReady:t,gizmo:c=!1,width:u="640px",height:d="480px",noBorder:h=!1,assets:p,controller:g,children:m}){const[x,f]=a.useState(null),[w,b]=a.useState(!0),[y,v]=a.useState(!1),C=a.useRef(null),j=a.useRef(null),T=a.useRef(null),S=a.useRef(null),I=a.useRef(null),[P,k]=a.useState(!0);let E="auto";u.endsWith("px")&&d.endsWith("px")&&(u.substring(u.length-2),d.substring(d.length-2));const N=n=>{if(!n)return;if(j.current)return;j.current=n;const s=new r.TgdContext(n,e),a=s.gl.getParameter(s.gl.DEPTH_BITS);console.log("Depht buffer bits:",a),C.current=s,k(!0),async function({glb:n,data:e,text:t,image:s}={}){console.log("ðŸš€ [Tgd] glb, data, text, image = ",n,e,t,s);const a={glb:{},data:{},text:{},image:{}},i=[];return s&&Object.keys(s).forEach(n=>{i.push(async()=>{const e=s[n];console.log("Loading image:",e);const t=await(0,r.tgdLoadImage)(e);t&&(a.image[n]=t)})}),n&&Object.keys(n).forEach(e=>{i.push(async()=>{const t=n[e];console.log("Loading GLB:",t);const s=await(0,r.tgdLoadGlb)(t);s&&(a.glb[e]=s)})}),e&&Object.keys(e).forEach(n=>{i.push(async()=>{const t=e[n],s=await(0,r.tgdLoadArrayBuffer)(t);s&&(a.data[n]=s)})}),t&&Object.keys(t).forEach(n=>{i.push(async()=>{const e=t[n],s=await(0,r.tgdLoadText)(e);s&&(a.text[n]=s)})}),await Promise.all(i.map(n=>n())),a}(p).then(n=>{try{if(g){const n=new r.TgdControllerCameraOrbit(s,{inertiaOrbit:1e3,inertiaZoom:500,inertiaPanning:500,...g});I.current=n,s.inputs.pointer.eventTapMultiple.addListener(e=>{console.log("ðŸš€ [tgd] evt.tapsCount =",e.tapsCount),e.preventTap(),2===e.tapsCount&&n.reset(.001*(g.inertiaOrbit??500))})}t(s,n),s.paint()}catch(n){f(n instanceof Error?n.message:JSON.stringify(n))}k(!1)}).catch(n=>{console.error("Unable to initialize the scene!",n),k(!1)});const i=T.current;i&&i.attachContext(s)},R=n=>{const e=new r.TgdCanvasGizmo({canvas:n});T.current=e,e.eventTipClick.addListener(({to:n})=>{const e=C.current;e&&e.animSchedule({duration:.2,easingFunction:r.tgdEasingFunctionInOutCubic,action:(0,r.tgdActionCreateCameraInterpolation)(e.camera,{orientation:n})})});const t=C.current;t&&e.attachContext(t)};return a.useEffect(()=>{const n=j.current,e=C.current;if(!n||!e)return;const t=new ResizeObserver(()=>e.paint());return t.observe(n),n.requestFullscreen||(n.requestFullscreen=n.webkitRequestFullscreen),v(Boolean(n.requestFullscreen)),()=>t.unobserve(n)},[C.current,j.current]),h?(0,s.jsxs)("div",{ref:S,className:l.screen,style:{width:w?u:d,height:w?d:u},children:[(0,s.jsx)("canvas",{className:l.canvas,ref:N}),c&&(0,s.jsx)("canvas",{className:l.gizmo,ref:R}),x&&(0,s.jsx)("div",{className:l.error,children:x})]}):(0,s.jsxs)("div",{className:i.Sxu.classNames.join(n,l.Tgd),children:[(0,s.jsxs)("div",{className:i.Sxu.classNames.join(l.actions,!P&&l.enabled),children:[(0,s.jsx)("div",{children:(0,s.jsx)(i.I64,{onClick:()=>b(!w)})}),(0,s.jsx)("div",{children:(0,s.jsx)(i.kRc,{onClick:()=>{const n=C.current;n&&n.takeSnapshot().then(n=>{const e=document.createElement("a");document.body.appendChild(e),e.style.display="none",e.href=n.src,e.download="snapshot.png",e.click(),window.setTimeout(()=>document.body.removeChild(e),3e4)})}})}),y&&(0,s.jsx)("div",{children:(0,s.jsx)(i.L9n,{onClick:()=>{const n=S.current;n&&n.requestFullscreen()}})}),g&&(0,s.jsx)("div",{children:(0,s.jsx)(i.zgT,{onClick:()=>{const n=I.current,e=C.current;e&&n&&(n.cameraInitialState=e.camera.getCurrentState(),n.resetZoom())}})})]}),(0,s.jsxs)("div",{className:l.relative,children:[(0,s.jsxs)("div",{ref:S,className:l.screen,style:{width:w?u:d,height:w?d:u},children:[(0,s.jsx)("canvas",{className:l.canvas,ref:N}),c&&(0,s.jsx)("canvas",{className:l.gizmo,ref:R}),x&&(0,s.jsx)("div",{className:l.error,children:x})]}),(0,s.jsx)("div",{className:i.Sxu.classNames.join(l.overlay,P&&l.loading),children:(0,s.jsx)(o.A,{})}),m]})]})}},8453:(n,e,t)=>{t.d(e,{R:()=>r});var s=t(6540);const a=s.createContext({});function r(n){const e=s.useContext(a);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}}}]);