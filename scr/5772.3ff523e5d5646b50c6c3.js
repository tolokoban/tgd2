"use strict";(self.webpackChunk_tolokoban_tgd=self.webpackChunk_tolokoban_tgd||[]).push([[5772],{4592:(n,e,t)=>{t.r(e),t.d(e,{default:()=>m});var o=t(4848),a=t(8453),s=t(6540),r=t(5968),i=t(2212),c=t(4461),l=t(6989);const d=t.p+"img/wood.e07ebec2ba296ac08985.webp";function h(n){n.camera.transfo.setPosition(0,-5,0).distance=30,new c.pwt(n);const e=()=>new c.buV({transfo:{position:[0,-1,0]},children:[new c.buV({transfo:{position:[0,-.5,-.5]},children:[new c.g6h(n,{geometry:new c.ZWB,material:new c.$Hl({color:new c.HTX(n).loadBitmap(d,{generateMipmap:!0})})})]})]});let t=e();const o=[t];for(let n=0;n<31;n++){const n=e();o.push(n),n.add(t),t=n}n.add(new c.o57(n,{color:[.2,.1,0,1],depth:1}),new c.Ipk(n,{depth:c.Eg5.less,children:[t]}),new c.ZJl(((n,e)=>{for(const e of o){e.transfo.orientation.reset();const t=.95;e.transfo.setScale(t,t,t),e.transfo.orbitAroundX(Math.abs(Math.sin(n))*Math.PI*2/o.length),e.transfo.orbitAroundY(Math.sin(1.1287*n)*Math.PI*3*(1+Math.cos(.37243*n))/o.length)}t.transfo.orbitAroundY(.5*n)}))),n.play()}function u(){return(0,o.jsx)(l.A,{onReady:h})}const x={"Detail #1":"    ctx.camera.transfo.setPosition(0, -5, 0).distance = 30\n    new TgdControllerCameraOrbit(ctx)\n    const createBox = () =>\n        new TgdPainterNode({\n            transfo: {\n                position: [0, -1, 0],\n            },\n            children: [\n                new TgdPainterNode({\n                    transfo: {\n                        position: [0, -0.5, -0.5],\n                    },\n                    children: [\n                        new TgdPainterMesh(ctx, {\n                            geometry: new TgdGeometryBox(),\n                            material: new TgdMaterialDiffuse({\n                                color: new TgdTexture2D(ctx).loadBitmap(\n                                    WoodURL,\n                                    { generateMipmap: true }\n                                ),\n                            }),\n                        }),\n                    ],\n                }),\n            ],\n        })\n    let root = createBox()\n    const boxes: TgdPainterNode[] = [root]\n    for (let i = 0; i < 31; i++) {\n        const box = createBox()\n        boxes.push(box)\n        box.add(root)\n        root = box\n    }\n    ctx.add(\n        new TgdPainterClear(ctx, { color: [0.2, 0.1, 0, 1], depth: 1 }),\n        new TgdPainterState(ctx, {\n            depth: webglPresetDepth.less,\n            children: [root],\n        }),\n        new TgdPainterLogic((time, delay) => {\n            for (const box of boxes) {\n                box.transfo.orientation.reset()\n                const s = 0.95\n                box.transfo.setScale(s, s, s)\n                box.transfo.orbitAroundX(\n                    (Math.abs(Math.sin(time)) * Math.PI * 2) / boxes.length\n                )\n                box.transfo.orbitAroundY(\n                    (Math.sin(time * 1.1287) *\n                        Math.PI *\n                        3 *\n                        (1 + Math.cos(time * 0.37243))) /\n                        boxes.length\n                )\n            }\n            root.transfo.orbitAroundY(time * 0.5)\n        })\n    )\n    ctx.play()"},g='import {\n    TgdContext,\n    TgdControllerCameraOrbit,\n    TgdGeometryBox,\n    TgdMaterialDiffuse,\n    TgdMaterialNormals,\n    TgdPainterClear,\n    TgdPainterLogic,\n    TgdPainterMesh,\n    TgdPainterNode,\n    TgdPainterState,\n    TgdTexture2D,\n    webglPresetDepth,\n} from "@tolokoban/tgd"\nimport View from "@/components/demo/Tgd"\nimport WoodURL from "./wood.webp"\n\nfunction init(ctx: TgdContext) {\n    ctx.camera.transfo.setPosition(0, -5, 0).distance = 30\n    new TgdControllerCameraOrbit(ctx)\n    const createBox = () =>\n        new TgdPainterNode({\n            transfo: {\n                position: [0, -1, 0],\n            },\n            children: [\n                new TgdPainterNode({\n                    transfo: {\n                        position: [0, -0.5, -0.5],\n                    },\n                    children: [\n                        new TgdPainterMesh(ctx, {\n                            geometry: new TgdGeometryBox(),\n                            material: new TgdMaterialDiffuse({\n                                color: new TgdTexture2D(ctx).loadBitmap(\n                                    WoodURL,\n                                    { generateMipmap: true }\n                                ),\n                            }),\n                        }),\n                    ],\n                }),\n            ],\n        })\n    let root = createBox()\n    const boxes: TgdPainterNode[] = [root]\n    for (let i = 0; i < 31; i++) {\n        const box = createBox()\n        boxes.push(box)\n        box.add(root)\n        root = box\n    }\n    ctx.add(\n        new TgdPainterClear(ctx, { color: [0.2, 0.1, 0, 1], depth: 1 }),\n        new TgdPainterState(ctx, {\n            depth: webglPresetDepth.less,\n            children: [root],\n        }),\n        new TgdPainterLogic((time, delay) => {\n            for (const box of boxes) {\n                box.transfo.orientation.reset()\n                const s = 0.95\n                box.transfo.setScale(s, s, s)\n                box.transfo.orbitAroundX(\n                    (Math.abs(Math.sin(time)) * Math.PI * 2) / boxes.length\n                )\n                box.transfo.orbitAroundY(\n                    (Math.sin(time * 1.1287) *\n                        Math.PI *\n                        3 *\n                        (1 + Math.cos(time * 0.37243))) /\n                        boxes.length\n                )\n            }\n            root.transfo.orbitAroundY(time * 0.5)\n        })\n    )\n    ctx.play()\n}\n\nexport default function Demo() {\n    return <View onReady={init} />\n}\n';function f(){const[n,e]=s.useState(!1);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"half-left",children:(0,o.jsx)(u,{})}),(0,o.jsxs)("div",{className:"half-right",children:[(0,o.jsx)("div",{children:(0,o.jsx)(r.yQN,{variant:"elevated",onClick:()=>e(!n),children:n?"Show code details":"Show full code"})}),(0,o.jsx)(i.A,{language:"tsx",value:n?g:x})]})]})}function b(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",p:"p",...(0,a.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h1,{children:(0,o.jsx)(e.a,{href:"docs/classes/TgdPainterNode.html",children:"TgdPainterNode"})}),"\n",(0,o.jsxs)(e.p,{children:["All objects implementing ",(0,o.jsx)(e.code,{children:"TgdInterfaceTransformable"})," have a ",(0,o.jsx)(e.code,{children:"transfo"})," attribute\nthat controls its position/orientation/scale in the world coordinate system. If\nyou need an object's transformation to be defined in another object coordinate\nsystem, you just have to wrap it in a ",(0,o.jsx)(e.code,{children:"TgdPainterNode"}),"."]}),"\n",(0,o.jsxs)(e.p,{children:["As long as a ",(0,o.jsx)(e.code,{children:"Transformable"})," is hold by the ",(0,o.jsx)(e.code,{children:"painter"})," attribute of a ",(0,o.jsx)(e.code,{children:"TgdPainterNode"}),",\nit will be controlled by the node.\nThat means, you should not use its ",(0,o.jsx)(e.code,{children:"transfo"})," attribute because it will be\noverwritten by the node."]}),"\n",(0,o.jsx)(e.h2,{children:"Example"}),"\n",(0,o.jsx)(f,{})]})}function m(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(b,{...n})}):b(n)}},3469:(n,e,t)=>{t.d(e,{A:()=>i});var o=t(1601),a=t.n(o),s=t(6314),r=t.n(s)()(a());r.push([n.id,".hgIjhDQIuBCJEQ4ZgLXp {\n    display: inline-block;\n    margin: 1em;\n}\n\n.hgIjhDQIuBCJEQ4ZgLXp canvas {\n    box-shadow: 0 0.25em 0.5em #fff1;\n    max-width: 100vw;\n    max-height: 100vh;\n}\n\n.efOyHCihw9wfMB6AaAqw {\n    position: relative;\n}\n\n.ywC8N0Uxbvm2Ug2DwPkE {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    background-color: var(--theme-color-primary-1);\n    opacity: 0;\n    transition: opacity 0.3s;\n}\n\n.ywC8N0Uxbvm2Ug2DwPkE.PBWSRsbiwEqGpeL0hEfm {\n    opacity: 1;\n}\n\n.BErChOLWGtciKhh3IFud {\n    position: relative;    \n}\n\n.BErChOLWGtciKhh3IFud > canvas.fT7FcYouYlPbElIAEXRP {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n}\n\n.BErChOLWGtciKhh3IFud > canvas.uAPfWt_Dhe7RaRrnmIu0 {\n    position: absolute;\n    right: 0;\n    top: 0;\n    width: 128px;\n    height: 128px;\n    box-shadow: none;\n    border: none;\n}",""]),r.locals={Tgd:"hgIjhDQIuBCJEQ4ZgLXp",relative:"efOyHCihw9wfMB6AaAqw",overlay:"ywC8N0Uxbvm2Ug2DwPkE",loading:"PBWSRsbiwEqGpeL0hEfm",screen:"BErChOLWGtciKhh3IFud",canvas:"fT7FcYouYlPbElIAEXRP",gizmo:"uAPfWt_Dhe7RaRrnmIu0"};const i=r},6989:(n,e,t)=>{t.d(e,{A:()=>j});var o=t(4848),a=t(6540),s=t(4461),r=t(5968),i=t(5670),c=t(5072),l=t.n(c),d=t(7825),h=t.n(d),u=t(7659),x=t.n(u),g=t(5056),f=t.n(g),b=t(540),m=t.n(b),p=t(1113),w=t.n(p),T=t(3469),y={};y.styleTagTransform=w(),y.setAttributes=f(),y.insert=x().bind(null,"head"),y.domAPI=h(),y.insertStyleElement=m(),l()(T.A,y);const v=T.A&&T.A.locals?T.A.locals:void 0;function j({className:n,options:e,onReady:t,gizmo:c=!1,width:l="640px",height:d="480px",noBorder:h=!1,assets:u,children:x}){const[g,f]=a.useState(!0),[b,m]=a.useState(!1),p=a.useRef(null),w=a.useRef(null),T=a.useRef(null),y=a.useRef(null),[j,P]=a.useState(!0);let C="auto";l.endsWith("px")&&d.endsWith("px")&&(l.substring(l.length-2),d.substring(d.length-2));const M=n=>{if(!n)return;if(w.current)return;w.current=n;const o=new s.tfp(n,e);p.current=o,P(!0),async function({glb:n,data:e,text:t,image:o}={}){console.log("ðŸš€ [Tgd] glb, data, text, image = ",n,e,t,o);const a={glb:{},data:{},text:{},image:{}},r=[];return o&&Object.keys(o).forEach((n=>{r.push((async()=>{const e=o[n];console.log("Loading image:",e);const t=await(0,s.V_9)(e);t&&(a.image[n]=t)}))})),n&&Object.keys(n).forEach((e=>{r.push((async()=>{const t=n[e];console.log("Loading GLB:",t);const o=await(0,s.TCe)(t);o&&(a.glb[e]=o)}))})),e&&Object.keys(e).forEach((n=>{r.push((async()=>{const t=e[n],o=await(0,s.vSU)(t);o&&(a.data[n]=o)}))})),t&&Object.keys(t).forEach((n=>{r.push((async()=>{const e=t[n],o=await(0,s.jWq)(e);o&&(a.text[n]=o)}))})),await Promise.all(r.map((n=>n()))),a}(u).then((n=>{console.log("Ready!"),t(o,n),o.paint(),P(!1)})).catch((n=>{console.error("Unable to initialize the scene!",n),P(!1)}));const a=T.current;a&&a.attachContext(o)},N=n=>{const e=new s.GbF({canvas:n});T.current=e,e.eventTipClick.addListener((({to:n})=>{const e=p.current;console.log("ðŸš€ [tgd] to, context =",n,e),e&&e.animSchedule({duration:.2,easingFunction:s.Wcc,action:(0,s.vRM)(e.camera,{orientation:n})})}));const t=p.current;t&&e.attachContext(t)};return a.useEffect((()=>{const n=w.current,e=p.current;if(!n||!e)return;const t=new ResizeObserver((()=>e.paint()));return t.observe(n),n.requestFullscreen||(n.requestFullscreen=n.webkitRequestFullscreen),m(Boolean(n.requestFullscreen)),()=>t.unobserve(n)}),[p.current,w.current]),h?(0,o.jsxs)("div",{ref:y,className:v.screen,style:{width:g?l:d,height:g?d:l},children:[(0,o.jsx)("canvas",{className:v.canvas,ref:M}),c&&(0,o.jsx)("canvas",{className:v.gizmo,ref:N})]}):(0,o.jsxs)("div",{className:r.Sxu.classNames.join(n,v.Tgd),children:[(0,o.jsxs)(r.sWC,{display:"flex",justifyContent:"space-between",children:[(0,o.jsx)(r.yQN,{variant:"elevated",onClick:()=>f(!g),enabled:!j,children:g?"Switch to Portrait":"Switch to Landscape"}),b&&(0,o.jsx)(r.yQN,{variant:"elevated",onClick:()=>{const n=y.current;n&&n.requestFullscreen()},enabled:!j,children:"Fullscreen"})]}),(0,o.jsxs)("div",{className:v.relative,children:[(0,o.jsxs)("div",{ref:y,className:v.screen,style:{width:g?l:d,height:g?d:l},children:[(0,o.jsx)("canvas",{className:v.canvas,ref:M}),c&&(0,o.jsx)("canvas",{className:v.gizmo,ref:N})]}),(0,o.jsx)("div",{className:r.Sxu.classNames.join(v.overlay,j&&v.loading),children:(0,o.jsx)(i.A,{})}),x]})]})}},8453:(n,e,t)=>{t.d(e,{R:()=>s});var o=t(6540);const a=o.createContext({});function s(n){const e=o.useContext(a);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}}}]);